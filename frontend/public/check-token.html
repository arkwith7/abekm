<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>í† í° í™•ì¸</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
        }

        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
        }

        .expired {
            color: red;
        }

        .valid {
            color: green;
        }
    </style>
</head>

<body>
    <h1>ğŸ” ì¸ì¦ í† í° í™•ì¸</h1>
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');

        function parseJwt(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(jsonPayload);
            } catch (e) {
                return null;
            }
        }

        const token = localStorage.getItem('ABEKM_token');

        if (!token) {
            output.innerHTML = '<p class="expired">âŒ í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>';
        } else {
            const payload = parseJwt(token);

            if (!payload) {
                output.innerHTML = '<p class="expired">âŒ ìœ íš¨í•˜ì§€ ì•Šì€ í† í° í˜•ì‹ì…ë‹ˆë‹¤.</p>';
            } else {
                const now = Math.floor(Date.now() / 1000);
                const exp = payload.exp;
                const isExpired = exp < now;

                const html = `
                    <h2 class="${isExpired ? 'expired' : 'valid'}">
                        ${isExpired ? 'âŒ í† í° ë§Œë£Œë¨' : 'âœ… í† í° ìœ íš¨'}
                    </h2>
                    <pre>${JSON.stringify(payload, null, 2)}</pre>
                    <p><strong>í† í° ê¸¸ì´:</strong> ${token.length} characters</p>
                    <p><strong>í˜„ì¬ ì‹œê°„:</strong> ${new Date().toLocaleString('ko-KR')}</p>
                    <p><strong>ë§Œë£Œ ì‹œê°„:</strong> ${new Date(exp * 1000).toLocaleString('ko-KR')}</p>
                    ${isExpired ? '<p class="expired"><strong>âš ï¸ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ì—¬ ë‹¤ì‹œ ë¡œê·¸ì¸í•˜ì„¸ìš”.</strong></p>' : ''}
                `;

                output.innerHTML = html;
            }
        }
    </script>
</body>

</html>