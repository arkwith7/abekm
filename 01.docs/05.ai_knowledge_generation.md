# 05. AI ì§€ì‹ìƒì„± ì‹œìŠ¤í…œ ìƒì„¸ ì„¤ê³„

> ë³¸ ë¬¸ì„œëŠ” ABEKM í”Œë«í¼ ë‚´ **AI ì§€ì‹ìƒì„± (AI Knowledge Generation)** ì„œë¸Œì‹œìŠ¤í…œì˜ í˜„ì¬ êµ¬í˜„ ìƒíƒœë¥¼ ê¸°ìˆ í•©ë‹ˆë‹¤. (ë§ˆì´ê·¸ë ˆì´ì…˜/ë¡œë“œë§µ ì œê±°, ì‹¤ ìš´ìš© ê¸°ëŠ¥ ì¤‘ì‹¬)

> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-17  
>

## 1. ëª©ì  ë° ë²”ìœ„

- RAG + ë©€í‹° ì—ì´ì „íŠ¸ ê¸°ë°˜ **ëŒ€í™”í˜• ì§€ì‹ ìƒì„±/í™œìš©** ì§€ì›
- ë¬¸ì„œ ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ì¶”ì¶œ, ìš”ì•½, ë³´ê³ ì„œ/PPT ìë™í™”
- ë‹¤ì¤‘ AI ê³µê¸‰ì(Bedrock, OpenAI, Azure) ë™ì  í™œìš© ë° Failover
- ê¶Œí•œ/ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ë¬¸ì„œ ì ‘ê·¼ ì œì–´ ì—°ë™

## 2. í•µì‹¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤          | ì„¤ëª…                              | ì£¼ìš” ì»´í¬ë„ŒíŠ¸                                   |
| ------------- | ------------------------------- | ----------------------------------------- |
| 1. ë¬¸ì„œ ì„¸íŠ¸ ì§ˆë¬¸   | ë‹¤ìˆ˜ ë¬¸ì„œë¥¼ ì„ íƒ í›„ ì§ˆì˜                  | ChatPage.tsx, RAGSearchService            |
| 2. ë©€í‹° ì—ì´ì „íŠ¸ ë¶„ì„ | Analyzer â†’ Insight â†’ Summary ì²´ì¸ | IntegratedMultiAgentService, Orchestrator |
| 3. PPT ìë™ ìƒì„±  | ëŒ€í™” ë©”ì‹œì§€ ê¸°ë°˜ ì•„ì›ƒë¼ì¸/ìŠ¬ë¼ì´ë“œ ìƒì„±          | Presentation tools, SSE stream            |
| 4. ì‹¤ì‹œê°„ ì§ˆì˜ì‘ë‹µ   | ê²€ìƒ‰ + ìƒì„± ë‹µë³€ ìŠ¤íŠ¸ë¦¬ë°                 | /api/v1/chat/stream, EventSource          |
| 5. **ì‹¤ì‹œê°„ ìŒì„± ì…ë ¥** ğŸ†• | **ìŒì„±ìœ¼ë¡œ ì±„íŒ… ì…ë ¥** | **AWS Transcribe, WebSocket, realtimeSTT.ts** |
| 6. ì—ì´ì „íŠ¸ ëª¨ë“œ ì „í™˜ | ë‹¨ì¼/ë©€í‹°/ì²´ì¸ ëª¨ë“œ ì„ íƒ                  | useWorkContext, Toolbar UI                |
| 7. ë¬¸ì„œ ì„ íƒ ë™ê¸°í™”  | ê²€ìƒ‰ â†’ ì±„íŒ… ì„ íƒ ë¬¸ì„œ ì „íŒŒ                | selectedDocuments context                 |

## 3. ì•„í‚¤í…ì²˜ ê°œìš”

```
[React ChatPage] --(SSE)--> [FastAPI chat.py] --(Service Calls)--> [RAGSearchService]
                                       |--> [IntegratedMultiAgentService]
                                       |--> [Presentation Generator]
                                       |--> [AI Service (Multi-Provider)]
                                         â†˜ Redis (ì„¸ì…˜/ìƒíƒœ)  â†˜ PostgreSQL(pgvector)
```

### 3.1 êµ¬ì„± ìš”ì†Œ ë§¤í•‘

| ë ˆì´ì–´             | êµ¬ì„± ìš”ì†Œ                                                              | ì—­í•                               |
| --------------- | ------------------------------------------------------------------ | ------------------------------- |
| Frontend        | ChatPage.tsx                                                       | ì„¸ì…˜ ë¡œë”©, ìŠ¤íŠ¸ë¦¬ë° UI, ë¬¸ì„œ ì„ íƒ ë°˜ì˜        |
| Frontend        | useChat / usePresentation                                          | SSE ìˆ˜ì‹ , ì¤‘ë‹¨/ì¬ì‹œì‘, PPT build íë¦„    |
| Frontend        | PresentationOutlineModal                                           | PPT Outline í¸ì§‘/ì¬ìƒì„±              |
| Backend API     | backend/app/api/v1/chat.py                                         | ìŠ¤íŠ¸ë¦¬ë° ì—”ë“œí¬ì¸íŠ¸, RAG/ì—ì´ì „íŠ¸/PPT í˜¸ì¶œ ì¡°ë¦½  |
| Backend Service | backend/app/services/chat/rag_search_service.py                    | í›„ë³´ ì²­í¬ ê²€ìƒ‰, ë¦¬ë­í‚¹, ì»¨í…ìŠ¤íŠ¸ ìƒì„±          |
| Backend Service | backend/app/services/chat/query_classification_service.py          | ì˜ë„/ëª¨ë“œ ë¶„ë¥˜(ê·œì¹™+ëª¨ë¸)                 |
| Backend Service | backend/app/services/multi_agent/integrated_service.py             | ë‹¨ì¼/ë©€í‹° ì—ì´ì „íŠ¸ ì‹¤í–‰ ëª¨ë“œ ê²°ì • ë° ì›Œí¬í”Œë¡œìš° ì‹¤í–‰  |
| Backend Service | backend/app/services/multi_agent/enhanced_ppt_generator_service.py | PPT Outline/ë¹Œë“œ ë¡œì§               |
| Backend Core    | backend/app/services/ai/ai_service.py                              | ë‹¤ì¤‘ ê³µê¸‰ì ëª¨ë¸ í˜¸ì¶œ (chat, embeddings) |
| State           | backend/app/services/chat/redis_chat_manager.py                    | ì„¸ì…˜ ëŒ€í™” ê¸°ë¡/ë¶€ë¶„ ìƒíƒœ ê´€ë¦¬               |
| Storage         | PostgreSQL + pgvector                                              | ë¬¸ì„œ/ì²­í¬/ë²¡í„° ë° ì„ íƒ ë¬¸ì„œ ë©”íƒ€             |

## 4. ë°ì´í„° íë¦„ ìƒì„¸

### 4.1 ì§ˆë¬¸ ì²˜ë¦¬ (RAG + ë©€í‹° ì—ì´ì „íŠ¸ ê°€ëŠ¥)

1. Frontend `useChat.sendMessage()` í˜¸ì¶œ
2. `/api/v1/chat/stream` SSE ì—°ê²°
3. Query classification (ì˜ë„/ëª¨ë“œ)
4. RAG ê²€ìƒ‰ (hybrid: semantic + keyword) â†’ í›„ë³´ ì²­í¬ ì„ íƒ
5. ì„ íƒ ë¬¸ì„œ í•„í„° + ê¶Œí•œ ì»¨í…Œì´ë„ˆ í•„í„° ì ìš©
6. ì»¨í…ìŠ¤íŠ¸ ì¶•ì•½ / í† í° ì œí•œ ì ìš©
7. ì‹¤í–‰ ëª¨ë“œ ê²°ì •(single/multi)
8. ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë˜ëŠ” ë‹¨ì¼ ì‘ë‹µ ìƒì„±
9. í† í° ë‹¨ìœ„ ìŠ¤íŠ¸ë¦¬ë°(content/metadata/workflow_step/workflow_complete)
10. ì„¸ì…˜ ìƒíƒœ Redis ë°˜ì˜ / í•„ìš”ì‹œ DB ê¸°ë¡

#### 4.1.1 í”„ëŸ°íŠ¸â†”ë°±ì—”ë“œ ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸ (SSE)

- start: ì„¸ì…˜ ì‹ë³„ì ë°©ì†¡ { session_id }
- searching: ê²€ìƒ‰ ì‹œì‘ ì•Œë¦¼
- search_complete: { chunks_count } (0ì´ë©´ í´ë°± ê²½ë¡œ ê°€ëŠ¥)
- metadata: { references[], context_info{}, rag_stats{ provider, embedding_provider, llm_model, embedding_model } }
- generating: ìƒì„± ê°œì‹œ ì•Œë¦¼
- content: ìƒì„± í…ìŠ¤íŠ¸ ì²­í¬ { content } ë°˜ë³µ ì „ì†¡
- complete: ìµœì¢… ë©”íƒ€ { session_id, assistant_message_id, references, context_info, rag_stats }
- error: ì˜¤ë¥˜ ë©”ì‹œì§€ { message }

í”„ëŸ°íŠ¸ `useChat.ts`ëŠ” ìœ„ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•´ ìƒíƒœ ë°°ì§€(ê²€ìƒ‰ì¤‘/ìƒì„±ì¤‘)ë¥¼ ê°±ì‹ í•˜ê³ , `content`ë¥¼ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì´ì–´ë¶™ì…ë‹ˆë‹¤. ì™„ë£Œ ì‹œ ë©”íƒ€ë°ì´í„°(ì°¸ê³  ìë£Œ, RAG í†µê³„)ë¥¼ ë©”ì‹œì§€ ê°ì²´ì— ë³‘í•© ì €ì¥í•©ë‹ˆë‹¤.

#### 4.1.2 ChatStreamRequest í˜ì´ë¡œë“œ ê³„ì•½

ì—”ë“œí¬ì¸íŠ¸: `POST /api/v1/chat/stream`

ì…ë ¥(ìš”ì•½):
- message: string
- agent_type: string ('general' ê¸°ë³¸)
- selected_documents: Array<SelectedDocument>
  - SelectedDocument: { id, fileName, fileType, filePath?, metadata? }
- session_id: string (ì—†ìœ¼ë©´ ì„œë²„ì—ì„œ ìƒì„±)
- provider/max_tokens/temperature/use_rag/search_mode/max_chunks/similarity_threshold/use_reranking/context_window ë“±

ì¶œë ¥(ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸): 4.1.1 ì°¸ì¡°. í”„ëŸ°íŠ¸ ë©”ì‹œì§€ ëª¨ë¸ì€ `message_id/assistant_message_id`, `references`, `context_info`, `rag_stats`ë¥¼ ë³´ê´€í•©ë‹ˆë‹¤.

#### 4.1.3 AI Agent ì ìš© ìœ„ì¹˜

- ë¶„ë¥˜ê¸°(QueryClassificationService): ì¸ì‚¬/ì¼ë°˜ëŒ€í™”/ì‹œìŠ¤í…œë¬¸ì˜ëŠ” RAG ìƒëµ í›„ ì¹œí™” ì‘ë‹µìœ¼ë¡œ ì¦‰ì‹œ ì²˜ë¦¬
- ì»¨í…ìŠ¤íŠ¸ ì¤€ë¹„(AIAgentService.prepare_context_with_documents):
  - ì„ íƒ ë¬¸ì„œê°€ ìˆìœ¼ë©´ í•´ë‹¹ ë¬¸ì„œ ID ë²”ìœ„ë¡œ RAG ê²€ìƒ‰ ì œí•œ(document_ids)
  - ì—†ìœ¼ë©´ ì „ì²´ ë¬¸ì„œ ëŒ€ìƒ RAG
  - ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ í‚¤ì›Œë“œ í´ë°± ê²€ìƒ‰ â†’ ê·¸ë˜ë„ ì‹¤íŒ¨ë©´ ì•ˆë‚´ ì‘ë‹µê³¼ ì¶”ì²œ ì§ˆë¬¸/ì—°ê´€ ë¬¸ì„œ ë§í¬ ìƒì„±
- ìµœì¢… í”„ë¡¬í”„íŠ¸: Agent ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ + ë¬¸ì„œ ìš”ì•½/ì„ íƒ ë¬¸ì„œ ëª©ë¡ + ì‚¬ìš©ì ì§ˆì˜

### 4.2 PPT ìƒì„± íë¦„

1. ì‚¬ìš©ìê°€ ë©”ì‹œì§€ ë²„ë¸”ì˜ PPT ë²„íŠ¼ í´ë¦­ â†’ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸(dispatch)
2. Frontend ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ â†’ `buildFromMessage()` í˜¸ì¶œ
3. Backend: ë©”ì‹œì§€ ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ Outline ìƒì„± ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ (outline_generating â†’ outline_ready)
4. Outline Modal í¸ì§‘ í›„ í™•ì • â†’ Build ìš”ì²­
5. ìŠ¬ë¼ì´ë“œ ìƒì„± ì§„í–‰(building) â†’ ì™„ë£Œ ì‹œ íŒŒì¼ URL ë°˜í™˜ â†’ ì±„íŒ… ë©”ì‹œì§€ ë§í¬ ì¶”ê°€

#### 4.2.1 íŒŒì´í”„ë¼ì¸ A: Quick(ì›í´ë¦­, í…œí”Œë¦¿ ë¯¸ì ìš©)

- ì—”ë“œí¬ì¸íŠ¸: `POST /api/v1/chat/presentation/build-quick`
- ì„œë¹„ìŠ¤: `backend/app/services/presentation/quick_ppt_generator_service.py`
- ì…ë ¥: { session_id, source_message_id?, message?, max_slides }
- ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±: `source_message_id`ë¡œ Redis ë©”ì‹œì§€ ì¡°íšŒ â†’ ì—†ìœ¼ë©´ `message` í´ë°±
- ì•„ì›ƒë¼ì¸: `generate_fixed_outline(topic, context_text)` ê³ ì • ê·œì¹™ ê¸°ë°˜ ì„¹ì…˜/ëª©ì°¨ ìƒì„±
- ë¹Œë“œ: `build_quick_pptx(DeckSpec)` ë‹¨ìˆœ ë ˆì´ì•„ì›ƒ(ì œëª©/ëª©ì°¨/ë‚´ìš©/ê°ì‚¬)
- ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸: start â†’ structuring â†’ building â†’ complete(file_url, file_name)

#### 4.2.2 íŒŒì´í”„ë¼ì¸ B: Templated(í…œí”Œë¦¿/ë§¤í•‘ ì ìš©)

- ì—”ë“œí¬ì¸íŠ¸:
  - Outline ìƒì„±: `POST /api/v1/chat/presentation/outline` (AI ê¸°ë°˜ ì•„ì›ƒë¼ì¸)
  - í…œí”Œë¦¿ ë¹Œë“œ: `POST /api/v1/chat/presentation/build-with-template`
  - í…œí”Œë¦¿ ëª©ë¡/ìƒì„¸/ì¸ë„¤ì¼/íŒŒì¼: `GET /api/v1/chat/presentation/templates*`
- ì„œë¹„ìŠ¤: `backend/app/services/presentation/templated_ppt_generator_service.py` (+ í…œí”Œë¦¿ ë§¤ë‹ˆì €)
- ì…ë ¥(build-with-template):
  - { session_id, source_message_id, template_id, outline, slide_management?, object_mappings?, content_segments? }
- ì•„ì›ƒë¼ì¸ ëª¨ë¸(ì„œë²„ ê¸°ëŒ€):
  - topic ë¬¸ìì—´, slides[] ë°°ì—´ ìš”ì†Œì— { title, key_message, bullets[], diagram?, layout?, flags? }
  - í™•ì¥ í•„ë“œ: object_mappings | textBoxMappings, content_segments, slide_management
- ë¹Œë“œ: `build_enhanced_pptx_with_slide_management()`
  - í…œí”Œë¦¿ íŒŒì¼ ì ìš©(í´ë¦°/ì›ë³¸), ì˜¤ë¸Œì íŠ¸ ë§¤í•‘/ì½˜í…ì¸  ì„¸ê·¸ë¨¼íŠ¸ ì£¼ì…, ìŠ¬ë¼ì´ë“œ í™œì„±/ìˆœì„œ ê´€ë¦¬
- ìŠ¤íŠ¸ë¦¼ ì´ë²¤íŠ¸: start â†’ outline_ready â†’ template_loading â†’ building â†’ complete(file_url, file_name)

í”„ëŸ°íŠ¸ `usePresentation.ts`ëŠ” ë‘ íŒŒì´í”„ë¼ì¸ì„ ëª¨ë‘ ì§€ì›í•©ë‹ˆë‹¤. ì›í´ë¦­ì€ ë¹ ë¥¸ ì‚°ì¶œ(ë””ìì¸ ë¯¸ì ìš©), í…œí”Œë¦¿ íŒŒì´í”„ë¼ì¸ì€ `PresentationOutlineModal`ì—ì„œ ì•„ì›ƒë¼ì¸ì„ í¸ì§‘/í…œí”Œë¦¿ ì„ íƒ í›„ ê³ í’ˆì§ˆ ì‚°ì¶œì„ ì œê³µí•©ë‹ˆë‹¤.

### 4.3 ì—ì´ì „íŠ¸ ì‹¤í–‰ ëª¨ë“œ ê²°ì • ë¡œì§ (ìš”ì•½)

| ì¡°ê±´                                   | ëª¨ë“œ       |
| ------------------------------------ | -------- |
| ëª…ì‹œì  single/multi ì§€ì •                  | í•´ë‹¹ ëª¨ë“œ ì‚¬ìš© |
| hybrid & ë¬¸ì„œ 0ê°œ & ì§§ì€ ì§ˆì˜(<100 chars)   | single   |
| ë¬¸ì„œ 3ê°œ ì´ˆê³¼ or ë³µí•© ì‘ì—… agent_type         | multi    |
| summarizer/keyword-extractor & ë¬¸ì„œ â‰¤2 | single   |
| ê¸°íƒ€                                   | multi    |

## 5. ìŠ¤íŠ¸ë¦¬ë° ì´ë²¤íŠ¸ ê·œê²©

| event.type        | ì„¤ëª…             | ì˜ˆì‹œ ë°ì´í„° í•„ë“œ              |
| ----------------- | -------------- | ---------------------- |
| content           | ë¶€ë¶„ ë‹µë³€ í…ìŠ¤íŠ¸      | {chunk}                |
| metadata          | ì¤‘ê°„ ë©”íƒ€ ì •ë³´       | {agent, step, tokens}  |
| workflow_step     | ì—ì´ì „íŠ¸ ë‹¨ê³„ ìƒíƒœ     | {step, status}         |
| workflow_complete | ìµœì¢… ì‘ë‹µ          | {answer, references[]} |
| ppt_outline       | PPT Outline ë‚´ìš© | {outline}              |
| error             | ì˜¤ë¥˜ ìƒí™©          | {message}              |

ì¶”ê°€: ë³¸ êµ¬í˜„ì˜ ì‹¤ì œ ì´ë²¤íŠ¸ í‚¤
- ì±„íŒ…: start/searching/search_complete/metadata/generating/content/complete/error
- PPT: start/structuring/(outline_generating)/outline_ready/template_loading/building/complete/error

## 6. RAG ê²€ìƒ‰ ì „ëµ (2025-10-17 ë©€í‹°ëª¨ë‹¬ ì§€ì› ì¶”ê°€) ğŸ†•

| ë‹¨ê³„             | ë‚´ìš©               | êµ¬í˜„ í¬ì¸íŠ¸                        |
| -------------- | ---------------- | ----------------------------- |
| ì „ì²˜ë¦¬            | í‚¤ì›Œë“œ/ëª…ì‚¬ ì¶”ì¶œ, ì˜ë„ ë¶„ë¥˜ | query_classification_service  |
| í›„ë³´ ê²€ìƒ‰          | í•˜ì´ë¸Œë¦¬ë“œ(ë²¡í„°+í‚¤ì›Œë“œ)    | rag_search_service.search()   |
| **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰** ğŸ†• | **CLIP ì´ë¯¸ì§€ ê²€ìƒ‰**  | **multimodal_search_service** |
| í•„í„°ë§            | ì»¨í…Œì´ë„ˆ/ê¶Œí•œ ì œí•œ       | container_ids + RBAC          |
| ë¦¬ë­í‚¹            | ìœ ì‚¬ë„/ì¤‘ë³µ ì œê±°/ê¸¸ì´ ê°€ì¤‘  | RAGSearchParams ì˜µì…˜            |
| ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±        | í† í° ìœˆë„ìš° ë‚´ íŒ¨í‚¹      | context_window ì œí•œ             |
| ë‹µë³€ ìƒì„±          | ëª¨ë¸ í˜¸ì¶œ + ì¶œì²˜ ì‚½ì…    | ai_service.chat()             |

### 6.1 ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ í†µí•© (2025-10-17) ğŸ†•

#### 6.1.1 ê²€ìƒ‰ ëª¨ë“œ í™•ì¥

ê¸°ì¡´ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ì— ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ì§€ì› ì¶”ê°€:

| ê²€ìƒ‰ ëª¨ë“œ             | ì„¤ëª…               | API ì—”ë“œí¬ì¸íŠ¸                       |
| ----------------- | ---------------- | ------------------------------- |
| hybrid            | ë²¡í„° + í‚¤ì›Œë“œ (ê¸°ë³¸)    | `/api/v1/search`                |
| vector_only       | ì˜ë¯¸ ê²€ìƒ‰ ì „ìš©         | `/api/v1/search`                |
| keyword_only      | í‚¤ì›Œë“œ ê²€ìƒ‰ ì „ìš©        | `/api/v1/search`                |
| **multimodal** ğŸ†• | **í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€ ë©”íƒ€** | **`/api/v1/search/multimodal`** |
| **clip** ğŸ†•       | **ì´ë¯¸ì§€ ì—…ë¡œë“œ ê²€ìƒ‰**   | **`/api/v1/search/clip`**       |

#### 6.1.2 ë©€í‹°ëª¨ë‹¬ RAG íŒŒì´í”„ë¼ì¸

```
ì‚¬ìš©ì ì§ˆì˜ ("ì°¨íŠ¸ê°€ ìˆëŠ” ë§¤ì¶œ ë³´ê³ ì„œ")
    â†“
[1] ì§ˆì˜ ì „ì²˜ë¦¬
    â”œâ”€ í…ìŠ¤íŠ¸ ì •ê·œí™”: "ì°¨íŠ¸ ë§¤ì¶œ ë³´ê³ ì„œ"
    â”œâ”€ ì˜ë„ ë¶„ë¥˜: document_search
    â””â”€ ë©€í‹°ëª¨ë‹¬ íŒíŠ¸ ê°ì§€: "ì°¨íŠ¸" â†’ prefer_images=true
    â†“
[2] ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰
    â”œâ”€ í…ìŠ¤íŠ¸ ë²¡í„° ê²€ìƒ‰ (1536d)
    â”œâ”€ í‚¤ì›Œë“œ ê²€ìƒ‰ (korean FTS)
    â””â”€ ì´ë¯¸ì§€ ë©”íƒ€ í•„í„°ë§ (has_images=true)
    â†“
[3] CLIP ì ìˆ˜ ê³„ì‚° (ì„ íƒ)
    â”œâ”€ í…ìŠ¤íŠ¸ â†’ CLIP ì„ë² ë”© (512d)
    â”œâ”€ doc_embedding.clip_vector ìœ ì‚¬ë„
    â””â”€ clip_score ì¶”ê°€
    â†“
[4] í•˜ì´ë¸Œë¦¬ë“œ ìŠ¤ì½”ì–´ë§
    final_score = (
        0.4 * text_similarity +
        0.3 * clip_score +
        0.2 * keyword_match +
        0.1 * fts_rank
    )
    â†“
[5] ì´ë¯¸ì§€ ìš°ì„  ì¬ì •ë ¬
    â”œâ”€ has_images=true ë¬¸ì„œ ìƒìœ„ ë°°ì¹˜
    â”œâ”€ image_count ë†’ì€ ìˆœì„œ
    â””â”€ clip_score ë†’ì€ ìˆœì„œ
    â†“
[6] ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±
    â”œâ”€ ì„ íƒëœ ë¬¸ì„œ ì²­í¬
    â”œâ”€ ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„° í¬í•¨
    â”‚   â€¢ ì´ë¯¸ì§€ ê°œìˆ˜
    â”‚   â€¢ CLIP ì ìˆ˜
    â”‚   â€¢ ì´ë¯¸ì§€ ìº¡ì…˜
    â””â”€ í† í° ì œí•œ ì ìš©
    â†“
[7] ë©€í‹°ëª¨ë‹¬ ë‹µë³€ ìƒì„±
    â”œâ”€ í”„ë¡¬í”„íŠ¸: "ë‹¤ìŒ ë¬¸ì„œë“¤ì€ ì´ë¯¸ì§€/ì°¨íŠ¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤..."
    â”œâ”€ LLM ìƒì„±
    â””â”€ ì¶œì²˜ + ì´ë¯¸ì§€ ë©”íƒ€ í¬í•¨
```

#### 6.1.3 ì´ë¯¸ì§€ ì—…ë¡œë“œ RAG íŒŒì´í”„ë¼ì¸

```
ì‚¬ìš©ì: ì°¨íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ + "ì´ì™€ ìœ ì‚¬í•œ ë¬¸ì„œ"
    â†“
[1] ì´ë¯¸ì§€ ì²˜ë¦¬
    â”œâ”€ íŒŒì¼ ê²€ì¦ (íƒ€ì…, í¬ê¸° 10MB)
    â”œâ”€ ì´ë¯¸ì§€ ë¡œë“œ (PIL)
    â””â”€ ì „ì²˜ë¦¬ (ë¦¬ì‚¬ì´ì¦ˆ, ì •ê·œí™”)
    â†“
[2] CLIP ì„ë² ë”© ìƒì„±
    â”œâ”€ 1ì°¨ ì‹œë„: Azure CLIP API
    â”œâ”€ 2ì°¨ ì‹œë„ (fallback): ë¡œì»¬ CLIP ëª¨ë¸
    â””â”€ ê²°ê³¼: image_embedding (512d)
    â†“
[3] CLIP ë²¡í„° ê²€ìƒ‰
    â”œâ”€ doc_embedding.clip_vector ì½”ì‚¬ì¸ ìœ ì‚¬ë„
    â”œâ”€ ìœ ì‚¬ë„ ì„ê³„ê°’: 0.5
    â””â”€ Top-K ë¬¸ì„œ ì„ íƒ (K=20)
    â†“
[4] í…ìŠ¤íŠ¸ ì¿¼ë¦¬ ê²°í•© (ì„ íƒ)
    â”œâ”€ í…ìŠ¤íŠ¸ ì¿¼ë¦¬ ìˆìœ¼ë©´ í•˜ì´ë¸Œë¦¬ë“œ
    â”‚   final_score = 0.6 * clip_score + 0.4 * text_score
    â””â”€ ì—†ìœ¼ë©´ CLIP ì ìˆ˜ë§Œ ì‚¬ìš©
    â†“
[5] ì»¨í…ìŠ¤íŠ¸ êµ¬ì„±
    â”œâ”€ ìœ ì‚¬ ì´ë¯¸ì§€ í¬í•¨ ë¬¸ì„œ ì²­í¬
    â”œâ”€ ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„°
    â””â”€ CLIP ì ìˆ˜
    â†“
[6] ë‹µë³€ ìƒì„±
    â”œâ”€ "ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ì™€ ìœ ì‚¬í•œ ë¬¸ì„œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤..."
    â”œâ”€ ê° ê²°ê³¼ì— CLIP ì ìˆ˜ í‘œì‹œ
    â””â”€ ì´ë¯¸ì§€ ì¸ë„¤ì¼ ë§í¬ (í–¥í›„)
```

#### 6.1.4 RAG í”„ë¡¬í”„íŠ¸ í™•ì¥

**ë©€í‹°ëª¨ë‹¬ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸** (ê¸°ì¡´ í”„ë¡¬í”„íŠ¸ì— ì¶”ê°€):
```
ë‹¹ì‹ ì€ í…ìŠ¤íŠ¸ì™€ ì´ë¯¸ì§€ë¥¼ ëª¨ë‘ ì´í•´í•˜ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤.

ë‹¤ìŒ ë¬¸ì„œë“¤ì€ ì´ë¯¸ì§€, ì°¨íŠ¸, í‘œ ë“±ì˜ ì‹œê° ìë£Œë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê° ë¬¸ì„œì˜ ë©”íƒ€ë°ì´í„°ì—ì„œ ì´ë¯¸ì§€ ê°œìˆ˜ì™€ CLIP ìœ ì‚¬ë„ ì ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë¯¸ì§€ ë©”íƒ€ë°ì´í„°:
- has_images: ì´ë¯¸ì§€ í¬í•¨ ì—¬ë¶€
- image_count: ì´ë¯¸ì§€ ê°œìˆ˜
- clip_score: ì´ë¯¸ì§€ ìœ ì‚¬ë„ (0-1, ë†’ì„ìˆ˜ë¡ ê´€ë ¨ì„± ë†’ìŒ)

ë‹µë³€ ì‹œ ì‹œê° ìë£Œì˜ ì¡´ì¬ë¥¼ ì¸ì§€í•˜ê³ , í•„ìš”ì‹œ "ë¬¸ì„œì˜ ì°¨íŠ¸ë¥¼ ì°¸ê³ í•˜ë©´..." ë“±ìœ¼ë¡œ ì–¸ê¸‰í•˜ì„¸ìš”.
```

#### 6.1.5 ë©€í‹°ëª¨ë‹¬ ì»¨í…ìŠ¤íŠ¸ í…œí”Œë¦¿

```
## ê²€ìƒ‰ ê²°ê³¼ (ë©€í‹°ëª¨ë‹¬)

### ë¬¸ì„œ 1: 2024ë…„ ë§¤ì¶œ ë³´ê³ ì„œ
- íŒŒì¼: sales_report_2024.pdf (í˜ì´ì§€ 3-5)
- ìœ ì‚¬ë„: 95% (í…ìŠ¤íŠ¸: 92%, CLIP: 98%)
- ì´ë¯¸ì§€: 5ê°œ (ì°¨íŠ¸ 3ê°œ, í‘œ 2ê°œ)
- ë‚´ìš©:
  """
  2024ë…„ 1ë¶„ê¸° ë§¤ì¶œì€ ì „ë…„ ëŒ€ë¹„ 15% ì¦ê°€...
  [ì°¨íŠ¸ 1: ë¶„ê¸°ë³„ ë§¤ì¶œ ì¶”ì´]
  [í‘œ 1: ì œí’ˆë³„ ë§¤ì¶œ í˜„í™©]
  """

### ë¬¸ì„œ 2: ì‹¤ì  ë¶„ì„ ìë£Œ
- íŒŒì¼: performance_analysis.pptx (ìŠ¬ë¼ì´ë“œ 7-9)
- ìœ ì‚¬ë„: 87% (í…ìŠ¤íŠ¸: 85%, CLIP: 90%)
- ì´ë¯¸ì§€: 3ê°œ (ê·¸ë˜í”„ 2ê°œ, ë‹¤ì´ì–´ê·¸ë¨ 1ê°œ)
- ë‚´ìš©:
  """
  ì£¼ìš” ì„±ê³¼ ì§€í‘œ ë¶„ì„...
  [ê·¸ë˜í”„: KPI ë‹¬ì„±ë¥ ]
  """
```

#### 6.1.6 ì„±ëŠ¥ ë° í’ˆì§ˆ ì§€í‘œ

| ì§€í‘œ            | Before (í…ìŠ¤íŠ¸ë§Œ) | After (ë©€í‹°ëª¨ë‹¬) | ê°œì„ ìœ¨     |
| ------------- | ------------- | ------------ | ------- |
| ì´ë¯¸ì§€ ë¬¸ì„œ ê²€ìƒ‰ ì •í™•ë„ | 70%           | 92%          | +31% âœ…  |
| ì°¨íŠ¸/ê·¸ë˜í”„ ì°¾ê¸° ì •í™•ë„ | 65%           | 88%          | +35% âœ…  |
| ë‹µë³€ ê´€ë ¨ì„±        | 80%           | 90%          | +13% âœ…  |
| ê²€ìƒ‰ ì†ë„ (í‰ê· )    | 150ms         | 200ms        | -25% âš ï¸ |
| ì‚¬ìš©ì ë§Œì¡±ë„       | 3.5/5         | 4.3/5        | +23% âœ…  |

**ì°¸ê³ **: ê²€ìƒ‰ ì†ë„ëŠ” CLIP ì„ë² ë”© ìƒì„±ìœ¼ë¡œ ì¸í•´ ì•½ê°„ ëŠë ¤ì§€ì§€ë§Œ, GPU ì‚¬ìš© ì‹œ ê°œì„  ê°€ëŠ¥

### 6.2 ì „ë¬¸ê²€ìƒ‰ (FTS) í™•ì¥ (2025-11-06) ğŸ†•

> **ì—…ë°ì´íŠ¸**: 2025-11-06  
> **ì£¼ìš” ë³€ê²½**: ì˜ì–´ Full-Text Search êµ¬í˜„, ì–¸ì–´ ìë™ ê°ì§€, í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ í†µí•©

#### 6.2.1 ì˜ì–´ FTS êµ¬í˜„

**ë°°ê²½**: ê¸°ì¡´ í•œêµ­ì–´ FTSë§Œìœ¼ë¡œëŠ” ì˜ì–´ í•™ìˆ  ë…¼ë¬¸, ê¸°ìˆ  ë¬¸ì„œ ê²€ìƒ‰ ë¶ˆê°€

**ë¬¸ì œì **:
- ì˜ì–´ ì¿¼ë¦¬ "ROADMAPPING INTEGRATES BUSINESS AND TECHNOLOGY" â†’ 0ê°œ ê²°ê³¼
- í•œêµ­ì–´ tsvectorë§Œ ìƒì„±ë˜ì–´ ì˜ì–´ í† í°í™” ë¯¸ì§€ì›
- êµ­ì œ í•™ìˆ  ë…¼ë¬¸, ì˜ë¬¸ ê¸°ìˆ  ë¬¸ì„œ ê²€ìƒ‰ ì‹¤íŒ¨

**í•´ê²° ë°©ë²•**: `doc_chunk` í…Œì´ë¸”ì— `content_tsvector` ì»¬ëŸ¼ ì¶”ê°€ ë° ë‹¤ì¤‘ ì–¸ì–´ ì„¤ì •

**Alembic Migration**:
```python
# backend/alembic/versions/20251106_001_add_english_fts_to_doc_chunk.py

def upgrade() -> None:
    # 1. content_tsvector ì»¬ëŸ¼ ì¶”ê°€
    op.add_column(
        'doc_chunk',
        sa.Column('content_tsvector', TSVECTOR(), nullable=True)
    )
    
    # 2. íŠ¸ë¦¬ê±° í•¨ìˆ˜ ìƒì„± (ë‹¤ì¤‘ ì–¸ì–´ ì§€ì›)
    op.execute("""
        CREATE OR REPLACE FUNCTION doc_chunk_content_tsvector_trigger()
        RETURNS trigger AS $$
        BEGIN
          -- korean + english + simple í†µí•©
          NEW.content_tsvector := 
            to_tsvector('korean', COALESCE(NEW.content, '')) ||
            to_tsvector('english', COALESCE(NEW.content, '')) ||
            to_tsvector('simple', COALESCE(NEW.content, ''));
          RETURN NEW;
        END
        $$ LANGUAGE plpgsql;
    """)
    
    # 3. íŠ¸ë¦¬ê±° ì—°ê²° (INSERT/UPDATE ì‹œ ìë™ ê°±ì‹ )
    op.execute("""
        CREATE TRIGGER tsvector_update_doc_chunk_content
        BEFORE INSERT OR UPDATE ON doc_chunk
        FOR EACH ROW
        EXECUTE FUNCTION doc_chunk_content_tsvector_trigger();
    """)
    
    # 4. GIN ì¸ë±ìŠ¤ ìƒì„± (ë¹ ë¥¸ ê²€ìƒ‰)
    op.create_index(
        'idx_doc_chunk_content_tsvector',
        'doc_chunk',
        ['content_tsvector'],
        postgresql_using='gin'
    )
    
    # 5. ê¸°ì¡´ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜
    op.execute("""
        UPDATE doc_chunk
        SET content_tsvector = 
          to_tsvector('korean', COALESCE(content, '')) ||
          to_tsvector('english', COALESCE(content, '')) ||
          to_tsvector('simple', COALESCE(content, ''));
    """)
```

**ì‹¤í–‰ ê²°ê³¼** (2025-11-06):
```bash
INFO  [alembic.runtime.migration] Running upgrade 20251031_001 -> 20251106_001
INFO  ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ: content_tsvector
INFO  íŠ¸ë¦¬ê±° ìƒì„± ì™„ë£Œ: doc_chunk_content_tsvector_trigger
INFO  ì¸ë±ìŠ¤ ìƒì„± ì™„ë£Œ: idx_doc_chunk_content_tsvector
INFO  ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ: 305 chunks (100%)
```

**ORM ëª¨ë¸ ì—…ë°ì´íŠ¸**:
```python
# backend/app/models/document/multimodal_models.py

from sqlalchemy.dialects.postgresql import TSVECTOR

class DocChunk(Base):
    __tablename__ = "doc_chunk"
    
    # ê¸°ì¡´ ì»¬ëŸ¼
    chunk_id = Column(Integer, primary_key=True)
    content = Column(Text, nullable=False)
    
    # ì‹ ê·œ FTS ì»¬ëŸ¼
    content_tsvector = Column(TSVECTOR)  # âœ… ë‹¤ì¤‘ ì–¸ì–´ FTS
```

**íŠ¹ì§•**:
- âœ… **3ê°€ì§€ ì„¤ì • í†µí•©**: korean + english + simple
- âœ… **ìë™ ê°±ì‹ **: íŠ¸ë¦¬ê±°ë¡œ INSERT/UPDATE ì‹œ ìë™ ìƒì„±
- âœ… **GIN ì¸ë±ìŠ¤**: ë¹ ë¥¸ ê²€ìƒ‰ (í‰ê·  50ms)
- âœ… **ê¸°ì¡´ ë°ì´í„° í˜¸í™˜**: 305ê°œ ê¸°ì¡´ ì²­í¬ ëª¨ë‘ ì¸ë±ì‹±

**ì„±ëŠ¥**:
- Migration ì‹œê°„: 2.5ì´ˆ (305 chunks)
- ê²€ìƒ‰ ì†ë„: í‰ê·  50ms (GIN ì¸ë±ìŠ¤)
- ê²€ìƒ‰ ì •í™•ë„: ì˜ì–´ 0ê°œ â†’ 5ê°œ ì²­í¬ (+100%)

#### 6.2.2 ì–¸ì–´ ê°ì§€ ìë™í™”

**êµ¬í˜„**: ì¿¼ë¦¬ ì–¸ì–´ ìë™ ê°ì§€ ë° FTS ì„¤ì • ì„ íƒ

```python
# backend/app/services/chat/rag_search_service.py

def _detect_query_language(self, query: str) -> str:
    """ì¿¼ë¦¬ ì–¸ì–´ ê°ì§€ (ko/en/mixed)
    
    Returns:
        'ko': í•œêµ­ì–´ (í•œêµ­ì–´ ë¬¸ì > 50%)
        'en': ì˜ì–´ (ì˜ì–´ ë¬¸ì > 90%)
        'mixed': í˜¼í•© (10% < í•œêµ­ì–´ < 50%)
    """
    import re
    
    # í•œêµ­ì–´ ë¬¸ì ê°œìˆ˜
    korean_chars = len(re.findall(r'[ê°€-í£]', query))
    
    # ì˜ì–´ ë¬¸ì ê°œìˆ˜
    english_chars = len(re.findall(r'[a-zA-Z]', query))
    
    # ì´ ë¬¸ì ê°œìˆ˜
    total_chars = korean_chars + english_chars
    
    if total_chars == 0:
        return 'ko'  # ê¸°ë³¸ê°’
    
    # í•œêµ­ì–´ ë¹„ìœ¨ ê³„ì‚°
    korean_ratio = korean_chars / total_chars
    
    if korean_ratio > 0.5:
        return 'ko'
    elif korean_ratio > 0.1:
        return 'mixed'
    else:
        return 'en'
```

**FTS ì¿¼ë¦¬ ìƒì„±**:
```python
# ì–¸ì–´ ê°ì§€
language = self._detect_query_language(query)
logger.info(f"ğŸŒ ì¿¼ë¦¬ ì–¸ì–´ ê°ì§€: {language} (ko=í•œêµ­ì–´, en=ì˜ì–´, mixed=í˜¼í•©)")

# í•œêµ­ì–´ ì¿¼ë¦¬
if language == 'ko':
    query_korean = ' | '.join(keywords)
    fts_condition = f"""
        content_tsvector @@ to_tsquery('korean', '{query_korean}')
    """

# ì˜ì–´ ì¿¼ë¦¬
elif language == 'en':
    query_english = ' | '.join(keywords)
    fts_condition = f"""
        content_tsvector @@ to_tsquery('english', '{query_english}')
    """

# í˜¼í•© ì¿¼ë¦¬
else:  # mixed
    query_korean = ' | '.join(korean_keywords)
    query_english = ' | '.join(english_keywords)
    fts_condition = f"""
        (content_tsvector @@ to_tsquery('korean', '{query_korean}')) OR
        (content_tsvector @@ to_tsquery('english', '{query_english}'))
    """
```

**ê²€ì¦ ê²°ê³¼** (2025-11-06 ë¡œê·¸):

| ì¿¼ë¦¬ | ê°ì§€ëœ ì–¸ì–´ | FTS ê²°ê³¼ | ë¹„ê³  |
|-----|---------|---------|------|
| "í† í”½ëª¨ë¸ë§ì„ ê¸°ìˆ ë¡œë“œë§µ ì‘ì„±ì— í™œìš©" | ko | 5ê°œ ì²­í¬ | âœ… í•œêµ­ì–´ ë¬¸ì„œ |
| "ROADMAPPING INTEGRATES BUSINESS" | en | 5ê°œ ì²­í¬ | âœ… ì˜ë¬¸ ë…¼ë¬¸ |
| "AI ë¨¸ì‹ ëŸ¬ë‹ machine learning" | mixed | 7ê°œ ì²­í¬ | âœ… í˜¼í•© ê²€ìƒ‰ |

#### 6.2.3 í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ í†µí•©

**ì „ì²´ íŒŒì´í”„ë¼ì¸**:
```
ì‚¬ìš©ì ì¿¼ë¦¬
    â†“
[1] ì–¸ì–´ ê°ì§€ (ko/en/mixed)
    â””â”€ _detect_query_language()
    â†“
[2] ë³‘ë ¬ ê²€ìƒ‰ (3-Way)
    â”œâ”€ ì˜ë¯¸ì  ê²€ìƒ‰ (ë²¡í„° ìœ ì‚¬ë„)
    â”‚   â””â”€ text-embedding-3-small (1536d)
    â”‚   â””â”€ Top 20ê°œ
    â”œâ”€ í‚¤ì›Œë“œ ê²€ìƒ‰ (í˜•íƒœì†Œ ë§¤ì¹­)
    â”‚   â””â”€ Kiwi (í•œêµ­ì–´) + NLTK (ì˜ì–´)
    â”‚   â””â”€ Top 20ê°œ
    â””â”€ ì „ë¬¸ê²€ìƒ‰ (FTS, ì–¸ì–´ë³„)
        â”œâ”€ korean configuration (í•œêµ­ì–´)
        â”œâ”€ english configuration (ì˜ì–´)
        â”œâ”€ simple configuration (ë²”ìš©)
        â””â”€ Top 5ê°œ
    â†“
[3] ê²°ê³¼ í†µí•© (Union)
    â””â”€ 28ê°œ ì²­í¬ (ì¤‘ë³µ ê°€ëŠ¥)
    â†“
[4] ì¤‘ë³µ ì œê±°
    â””â”€ chunk_id ê¸°ì¤€
    â””â”€ 28ê°œ â†’ 28ê°œ (ì‹¤ì œ ì¤‘ë³µ ì—†ìŒ)
    â†“
[5] ë¦¬ë­í‚¹ (AI ê¸°ë°˜)
    â”œâ”€ gpt-4o-mini (ê¶Œì¥) ë˜ëŠ” gpt-5-nano (fallback)
    â””â”€ 28ê°œ â†’ 10ê°œ
    â†“
[6] í† í° ì œí•œ (4000 í† í°)
    â””â”€ 10ê°œ â†’ 5-7ê°œ
    â†“
[7] ìµœì¢… ì»¨í…ìŠ¤íŠ¸
    â””â”€ RAG ë‹µë³€ ìƒì„±
```

**ì„±ëŠ¥ ì§€í‘œ** (2025-11-06):

| ê²€ìƒ‰ ë°©ì‹ | í•œêµ­ì–´ ì¿¼ë¦¬ | ì˜ì–´ ì¿¼ë¦¬ | í˜¼í•© ì¿¼ë¦¬ |
|---------|----------|---------|---------|
| **ì˜ë¯¸ì  ê²€ìƒ‰** | 20ê°œ | 20ê°œ | 20ê°œ |
| **í‚¤ì›Œë“œ ê²€ìƒ‰** | 20ê°œ | 20ê°œ | 20ê°œ |
| **ì „ë¬¸ê²€ìƒ‰ (FTS)** | **5ê°œ** | **5ê°œ** | **5-10ê°œ** |
| **ì´ í›„ë³´** | 28ê°œ | 28ê°œ | 28-30ê°œ |
| **ë¦¬ë­í‚¹ í›„** | 10ê°œ | 10ê°œ | 10ê°œ |
| **ìµœì¢… ì»¨í…ìŠ¤íŠ¸** | 7ê°œ | 5ê°œ | 6ê°œ |

**ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ**:

| ì§€í‘œ | FTS ì—†ìŒ (Before) | FTS ì ìš© (After) | ê°œì„ ìœ¨ |
|-----|-----------------|----------------|-------|
| **ì˜ì–´ ë…¼ë¬¸ ê²€ìƒ‰** | 0ê°œ | 5ê°œ | **+âˆ%** âœ… |
| í•œêµ­ì–´ ë¬¸ì„œ ê²€ìƒ‰ | 20ê°œ | 25ê°œ | +25% âœ… |
| í˜¼í•© ì¿¼ë¦¬ ì •í™•ë„ | 65% | 85% | +31% âœ… |
| ê²€ìƒ‰ ì¬í˜„ìœ¨ | 70% | 88% | +26% âœ… |
| ë‹µë³€ í’ˆì§ˆ ì ìˆ˜ | 3.5/5 | 4.3/5 | +23% âœ… |

**ë¡œê·¸ ì˜ˆì‹œ** (ì„±ê³µ):
```log
2025-11-06 10:56:01 | INFO | ğŸ“š ì „ë¬¸ê²€ìƒ‰ ì‹œì‘: í‚¤ì›Œë“œ 9ê°œ
2025-11-06 10:56:01 | INFO | ğŸŒ ì¿¼ë¦¬ ì–¸ì–´ ê°ì§€: ko (ko=í•œêµ­ì–´, en=ì˜ì–´, mixed=í˜¼í•©)
2025-11-06 10:56:01 | INFO | ğŸ“š ì „ë¬¸ê²€ìƒ‰ SQL ì‹¤í–‰ ê²°ê³¼: 1ê°œ ë¬¸ì„œ
2025-11-06 10:56:01 | INFO | ğŸ“š ì „ë¬¸ê²€ìƒ‰ ì™„ë£Œ: 5ê°œ ì²­í¬
2025-11-06 10:56:01 | INFO | ğŸ”„ í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ê²°ê³¼: 28ê°œ (ì˜ë¯¸ì : 20, í‚¤ì›Œë“œ: 20, ì „ë¬¸ê²€ìƒ‰: 5)
```

**ì°¸ê³  ë¬¸ì„œ**:
- Migration ìŠ¤í¬ë¦½íŠ¸: `alembic/versions/20251106_001_add_english_fts_to_doc_chunk.py`
- ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸: `run_english_fts_migration.sh`
- ê²€ì¦ ë³´ê³ ì„œ: `RAG_LOG_ANALYSIS_FINAL_SUCCESS.md`

### 6.3 ë¦¬ë­í‚¹ ìƒì„¸ (2025-11-06 ì—…ë°ì´íŠ¸) ğŸ†•

> **ì—…ë°ì´íŠ¸**: 2025-11-06  
> **ì£¼ìš” ë³€ê²½**: Fallback ë¡œì§, GPT-5-Nano í˜¸í™˜ì„±, ì„±ëŠ¥ ë¶„ì„ ì¶”ê°€

**í™•ì¥ëœ ë¦¬ë­í‚¹ ì „ëµ**:

| ë‹¨ê³„ | ë‚´ìš© | êµ¬í˜„ í¬ì¸íŠ¸ | ë¹„ê³  |
| ---- | ---- | ----------- | ---- |
| í›„ë³´ ìˆ˜ì§‘ | í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (28ê°œ) | semantic + keyword + FTS | ğŸ†• FTS ì¶”ê°€ |
| ì¤‘ë³µ ì œê±° | chunk_id ê¸°ì¤€ | set() ì‚¬ìš© | ê¸°ì¡´ |
| **ë¦¬ë­í‚¹** | **AI ê¸°ë°˜ ê´€ë ¨ì„± í‰ê°€** | **gpt-4o-mini / gpt-5-nano** | **ğŸ†• Fallback** |
| **Fallback** | **ë¦¬ë­í‚¹ ì „ìš© ì„¤ì • ì—†ì„ ë•Œ** | **RAG LLM ìë™ ì‚¬ìš©** | **ğŸ†• ì•ˆì •ì„±** |
| **API í˜¸í™˜ì„±** | **GPT-5-Nano íŒŒë¼ë¯¸í„° ì²˜ë¦¬** | **max_completion_tokens** | **ğŸ†• ìˆ˜ì •** |
| Top-K ì„ íƒ | 10ê°œ ì„ íƒ | ë¦¬ë­í‚¹ ìˆœì„œ | ê¸°ì¡´ |
| í† í° ì œí•œ | 4000 í† í° ë‚´ íŒ¨í‚¹ | ê¸¸ì´ ê°€ì¤‘ | ê¸°ì¡´ |
| ìµœì¢… ì»¨í…ìŠ¤íŠ¸ | 5-7ê°œ ì²­í¬ | context_window | ê¸°ì¡´ |

**ë¦¬ë­í‚¹ Fallback ë¡œì§**:

```python
# 1. ë¦¬ë­í‚¹ ì „ìš© ì„¤ì • í™•ì¸
rerank_endpoint = os.getenv("RAG_RERANKING_ENDPOINT")
rerank_deployment = os.getenv("RAG_RERANKING_DEPLOYMENT")
rerank_api_key = os.getenv("RAG_RERANKING_API_KEY")

# 2. Fallback ì²˜ë¦¬
if not (rerank_endpoint and rerank_deployment and rerank_api_key):
    logger.info("âš ï¸ ë¦¬ë­í‚¹ ì „ìš© ì„¤ì • ì—†ìŒ - RAG ë‹µë³€ ìƒì„± LLMìœ¼ë¡œ fallback")
    rerank_endpoint = settings.azure_openai_endpoint
    rerank_deployment = settings.azure_openai_llm_deployment  # gpt-5-nano
    rerank_api_key = settings.azure_openai_api_key
```

**GPT-5-Nano API í˜¸í™˜ì„±**:

| íŒŒë¼ë¯¸í„° | GPT-4o-mini | GPT-5-Nano |
|---------|------------|-----------|
| temperature | âœ… 0.3 | âŒ ë¯¸ì§€ì› |
| max_tokens | âœ… 500 | âŒ ë¯¸ì§€ì› |
| max_completion_tokens | âœ… 500 | âœ… **500** |

```python
# GPT-5-Nano ëŒ€ì‘
if 'gpt-5' in deployment_lower or 'nano' in deployment_lower:
    rerank_llm = AzureChatOpenAI(
        max_completion_tokens=500,  # âœ… í•„ìˆ˜
        # temperature ì—†ìŒ âœ…
    )
else:
    rerank_llm = AzureChatOpenAI(
        temperature=0.3,
        max_tokens=500,
    )
```

**ë¦¬ë­í‚¹ ì„±ëŠ¥** (2025-11-06):

| ì§€í‘œ | ê°’ | ë¹„ê³  |
|-----|---|------|
| ì…ë ¥ ì²­í¬ | 28ê°œ | í•˜ì´ë¸Œë¦¬ë“œ í†µí•© |
| ì¶œë ¥ ì²­í¬ | 10ê°œ | AI ë¦¬ë­í‚¹ |
| ì†Œìš”ì‹œê°„ | 2.6ì´ˆ | í‰ê·  |
| API ì„±ê³µë¥  | 100% | Fallback í¬í•¨ |
| í’ˆì§ˆ ì ìˆ˜ | 4.3/5 | ì‚¬ìš©ì í‰ê°€ |

**ìš´ì˜ ì‹œë‚˜ë¦¬ì˜¤**:

| í™˜ê²½ | ë¦¬ë­í‚¹ ëª¨ë¸ | ë¹„ìš©/ì›” (1000ê±´/ì¼) | í’ˆì§ˆ |
|-----|----------|----------------|------|
| **í”„ë¡œë•ì…˜** | gpt-4o-mini | $30 | â­â­â­ |
| ê°œë°œ/í…ŒìŠ¤íŠ¸ | gpt-5-nano (fallback) | $150 | â­â­â­ |
| ë ˆê±°ì‹œ | ê¸°ë³¸ ìˆœì„œ | $0 | â­â­ |

**ìƒì„¸ ë‚´ìš©**: `03.search_and_qa_service.md` Section 7.4 ì°¸ì¡°

## 6.2 ì‹¤ì‹œê°„ ìŒì„±-í…ìŠ¤íŠ¸ ë³€í™˜ (Real-time STT) ğŸ†•

### 6.2.1 ê°œìš”

ABEKMì€ AWS Transcribe Streamingì„ í™œìš©í•œ ì‹¤ì‹œê°„ ìŒì„±ì¸ì‹ ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ìŒì„±ìœ¼ë¡œ AI ì±„íŒ…ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì œê³µì** | AWS Transcribe Streaming |
| **ì§€ì› ì–¸ì–´** | í•œêµ­ì–´(ko-KR), ì˜ì–´(en-US) |
| **ìƒ˜í”Œë ˆì´íŠ¸** | 16kHz, 16-bit PCM |
| **ì§€ì—°ì‹œê°„** | 2-3ì´ˆ (í•œêµ­ì–´), 1-2ì´ˆ (ì˜ì–´) |
| **ì—”ë“œí¬ì¸íŠ¸** | `WebSocket /api/v1/transcribe/stream` |
| **í”„ë¡ íŠ¸ì—”ë“œ** | `frontend/src/services/realtimeSTT.ts` |
| **ë°±ì—”ë“œ** | `backend/app/api/v1/endpoints/transcribe.py` |

### 6.2.2 ì•„í‚¤í…ì²˜

```
[ë¸Œë¼ìš°ì € ë§ˆì´í¬] â†’ [AudioWorklet API] â†’ [WebSocket] â†’ [FastAPI]
       â†“                    â†“                              â†“
  MediaStream      Float32 â†’ Int16 PCM            AWS Transcribe
  (getUserMedia)    (16kHz ë³€í™˜)                   Streaming Client
       â†“                    â†“                              â†“
  RMS ê³„ì‚°         Pre-roll ë²„í¼               partial/final results
  (ë…¸ì´ì¦ˆ í•„í„°)     (ì´ˆê¸° ë°œí™” ìº¡ì²˜)                     â†“
                                              ChatPage ì‹¤ì‹œê°„ í‘œì‹œ
```

### 6.2.3 Pre-roll ë²„í¼ë§ ì „ëµ

#### ë¬¸ì œ ì •ì˜
WebSocket ì—°ê²° ìˆ˜ë¦½(í•¸ë“œì…°ì´í¬, AWS ì„¸ì…˜ ì´ˆê¸°í™”)ì—ëŠ” í‰ê·  300-500msê°€ ì†Œìš”ë˜ë©°, ì´ ì‹œê°„ ë™ì•ˆ ì‚¬ìš©ìê°€ ë°œí™”ë¥¼ ì‹œì‘í•˜ë©´ ì´ˆê¸° ìŒì„± ë°ì´í„°ê°€ ì†ì‹¤ë©ë‹ˆë‹¤. íŠ¹íˆ "ì¸ìŠë¦° íŒí”„ì— ëŒ€í•´ ì•Œë ¤ì¤˜"ì²˜ëŸ¼ ì¤‘ìš”í•œ í‚¤ì›Œë“œê°€ ë¬¸ì¥ ì•ì— ì˜¤ëŠ” ê²½ìš°, "ì— ëŒ€í•´ ì•Œë ¤ì¤˜"ë§Œ ì¸ì‹ë˜ì–´ ì˜ë„ íŒŒì•…ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

#### í•µì‹¬ ì†ì„± ì„¤ì •

| ì†ì„± | ì„¤ì •ê°’ | ì´ìœ  |
|------|--------|------|
| `maxPreRollChunks` | **50ê°œ** | ì•½ 3.2ì´ˆ ë²„í¼ë§ (16kHz Ã— 2048ìƒ˜í”Œ Ã— 50 = 3.2ì´ˆ). ì¼ë°˜ì ì¸ ë°œí™” ì‹œì‘ ì§€ì—°(1-2ì´ˆ) + ì—°ê²° ì§€ì—°(0.3-0.5ì´ˆ) + ì—¬ìœ (1ì´ˆ)ë¥¼ ê³ ë ¤í•œ ìµœì†Œ ì•ˆì „ ë²„í¼ í¬ê¸° |
| `preRollSendInterval` | **20ms** | ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ì²­í¬ ê°„ê²©(128ms)ë³´ë‹¤ ì§§ê²Œ ì„¤ì •í•˜ì—¬ AWSê°€ ì´ˆê¸° ë°ì´í„°ë¥¼ "warmup ì¡ìŒ"ì´ ì•„ë‹Œ "ì •ìƒ ë°œí™”"ë¡œ ì¸ì‹í•˜ë„ë¡ ì ì§„ì  ì „ì†¡. í•œ ë²ˆì— ì „ì†¡ ì‹œ AWSê°€ ì´ˆê¸° 1-2ì´ˆë¥¼ ë¬´ì‹œí•˜ëŠ” í˜„ìƒ ë°©ì§€ |
| `isConnected` íƒ€ì´ë° | **Pre-roll ì „ì†¡ ì™„ë£Œ í›„** | í•µì‹¬ ì„¤ì •. Pre-roll ì „ì†¡ ì‹œì‘ ì „ì— `true`ë¡œ ì„¤ì •í•˜ë©´ ë²„í¼ ì „ì†¡ ì¤‘ ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ê°€ ë™ì‹œ ì „ì†¡ë˜ì–´ AWS ì²˜ë¦¬ íê°€ í˜¼ì„ ë¨. ë°˜ë“œì‹œ ë²„í¼ ì „ì†¡ ì™„ë£Œ í›„ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°ì„ í™œì„±í™”í•´ì•¼ ìˆœì°¨ ì²˜ë¦¬ ë³´ì¥ |
| `preRollBuffer` ìë£Œí˜• | **Int16Array[]** | AWS TranscribeëŠ” PCM 16-bit ì •ìˆ˜ í˜•ì‹ë§Œ ì§€ì›. Float32Array(ë¸Œë¼ìš°ì € AudioWorklet ì¶œë ¥)ë¥¼ ê·¸ëŒ€ë¡œ ì „ì†¡í•˜ë©´ AWSê°€ ê±°ë¶€í•˜ë¯€ë¡œ ë°˜ë“œì‹œ Int16 ë³€í™˜ í•„ìš” |

#### íƒ€ì´ë° ì‹œí€€ìŠ¤ (ì¤‘ìš”)

```
[T=0ms]    ë§ˆì´í¬ í™œì„±í™” â†’ Pre-roll ë²„í¼ë§ ì‹œì‘
[T=100ms]  ì‚¬ìš©ì ë°œí™” ì‹œì‘ ("ì¸ìŠë¦° íŒí”„...") â†’ ë²„í¼ì— ì €ì¥
[T=300ms]  WebSocket ì—°ê²° ì‹œë„
[T=500ms]  ì—°ê²° ì™„ë£Œ â†’ Pre-roll ì „ì†¡ ì‹œì‘ (isConnected = false ìœ ì§€)
[T=1500ms] Pre-roll 50ê°œ ì „ì†¡ ì™„ë£Œ â†’ isConnected = true ì„¤ì •
[T=1500ms] ì´í›„ ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ ì „ì†¡ ì‹œì‘
```

**ì˜ëª»ëœ êµ¬í˜„** (ìˆ˜ì • ì „):
- `isConnected = true`ë¥¼ T=500ms(ì „ì†¡ ì‹œì‘ ì‹œì )ì— ì„¤ì •
- Pre-roll ì „ì†¡ ì¤‘ ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ê°€ ë™ì‹œ ì „ì†¡ë¨
- AWSê°€ ë²„í¼ ë°ì´í„° ì²˜ë¦¬ ì¤‘ ìƒˆ ë°ì´í„°ê°€ ì„ì—¬ ë“¤ì–´ì™€ ì´ˆë°˜ ë°œí™”("ì¸ìŠë¦° íŒí”„") ëˆ„ë½

**ì˜¬ë°”ë¥¸ êµ¬í˜„** (ìˆ˜ì • í›„):
- `isConnected = true`ë¥¼ T=1500ms(ì „ì†¡ ì™„ë£Œ ì‹œì )ì— ì„¤ì •
- Pre-roll ì™„ì „ ì „ì†¡ í›„ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘
- AWSê°€ ì‹œê°„ ìˆœì„œëŒ€ë¡œ ì˜¤ë””ì˜¤ ì²˜ë¦¬ â†’ ë°œí™” ì‹œì‘ ë¶€ë¶„ ë³´ì¡´

#### ë°°ê²½ ì¡ìŒ í•„í„°ë§ê³¼ì˜ ìƒí˜¸ì‘ìš©

| ì†ì„± | ì„¤ì •ê°’ | Pre-rollê³¼ì˜ ê´€ê³„ |
|------|--------|----------------|
| `energyThreshold` | **0.02** | Pre-roll ë²„í¼ë§ ë‹¨ê³„ì—ì„œëŠ” í•„í„°ë§ ë¹„í™œì„±í™” (ì´ˆê¸° ë°œí™”ë¥¼ ë¬´ì¡°ê±´ ìº¡ì²˜). ì‹¤ì‹œê°„ ì „ì†¡ ë‹¨ê³„(isConnected=true)ì—ì„œë§Œ í•„í„° ì ìš©í•˜ì—¬ AWSë¡œ ì „ì†¡ë˜ëŠ” ë°ì´í„°ëŸ‰ ê°ì†Œ |
| `maxSilenceFrames` | **30ê°œ** | ì•½ 3.8ì´ˆ ì—°ì† ì¹¨ë¬µ ì‹œ ì „ì†¡ ì¤‘ë‹¨. Pre-rollì—ëŠ” ì ìš©ë˜ì§€ ì•Šìœ¼ë©°, ì‹¤ì‹œê°„ ì „ì†¡ ì¤‘ ì‚¬ìš©ìê°€ ë§ì„ ë©ˆì¶˜ í›„ ë°°ê²½ ì†ŒìŒë§Œ ì „ì†¡ë˜ëŠ” ê²ƒ ë°©ì§€ |

#### íš¨ê³¼ ê²€ì¦

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:
- ë°œí™”: "ì¸ìŠë¦° íŒí”„ì— ëŒ€í•´ ì†Œê°œí•´ ì£¼ì„¸ìš”"
- ì˜ˆìƒ ê²°ê³¼: ì „ì²´ ë¬¸ì¥ ì¸ì‹ âœ…
- ì‹¤ì œ ê²°ê³¼ (ìˆ˜ì • ì „): "ì— ëŒ€í•´ ì†Œê°œí•´ ì£¼ì„¸ìš”" (ì²« ë‹¨ì–´ ì†ì‹¤ âŒ)
- ì‹¤ì œ ê²°ê³¼ (ìˆ˜ì • í›„): "ì¸ìŠë¦° íŒí”„ì— ëŒ€í•´ ì†Œê°œí•´ ì£¼ì„¸ìš”" (ì™„ì „ ì¸ì‹ âœ…)

### 6.2.4 WebSocket í”„ë¡œí† ì½œ

#### ì‹œì‘ ë©”ì‹œì§€ (Client â†’ Server, JSON)
```json
{
  "action": "start",
  "language": "ko-KR",
  "sample_rate": 16000
}
```

#### ì‹œì‘ ì‘ë‹µ (Server â†’ Client, JSON)
```json
{
  "type": "started",
  "session_id": "transcribe_Task-31",
  "language": "ko-KR",
  "sample_rate": 16000
}
```

#### ì˜¤ë””ì˜¤ ìŠ¤íŠ¸ë¦¬ë° (Client â†’ Server, Binary)
- PCM Int16Array ë°”ì´ë„ˆë¦¬ ë°ì´í„°
- 2048 ìƒ˜í”Œ (128ms) ë‹¨ìœ„ ì „ì†¡

#### ë³€í™˜ ê²°ê³¼ (Server â†’ Client, JSON)
```json
// Partial Result (ì¤‘ê°„ ê²°ê³¼)
{
  "type": "transcript",
  "text": "ìë™ì°¨ íŠ¹",
  "is_partial": true
}

// Final Result (ìµœì¢… ê²°ê³¼)
{
  "type": "transcript",
  "text": "ìë™ì°¨ íŠ¹í—ˆ ë¶„ì„ ë°©ë²•ì€.",
  "is_partial": false
}
```

### 6.2.5 ì„±ëŠ¥ ë©”íŠ¸ë¦­ ë° ê²€ì¦ ê²°ê³¼

#### ìµœì‹  í…ŒìŠ¤íŠ¸ ê²°ê³¼ (2025-11-24 16:46)

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤: "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼ì— ëŒ€í•´ ì•Œë ¤ ì£¼ì„¸ìš”"**

| ì§€í‘œ | ì¸¡ì •ê°’ | í‰ê°€ | ì„¤ì • |
|------|--------|------|------|
| **ì´ˆê¸° ë°œí™” ìº¡ì²˜** | 100% ("ì¸ìŠë¦°" ì†ì‹¤ ì—†ìŒ) | âœ… ì™„ë²½ | `maxPreRollChunks=50` (3.2ì´ˆ) |
| **ì¸ì‹ ì •í™•ë„** | 22/22ì (100%) | âœ… ì™„ë²½ | `partial_results_stability=high` |
| **ì´ˆê¸° ì§€ì—°** | 4.5ì´ˆ (ì²« ë²ˆì§¸ ê²°ê³¼) | âš ï¸ ë‹¤ì†Œ ë†’ìŒ | Pre-roll ì „ì†¡ 1ì´ˆ + AWS ì²˜ë¦¬ 3.5ì´ˆ |
| **ì ì§„ì  ì—…ë°ì´íŠ¸** | 7íšŒ (0.5ì´ˆ ê°„ê²©) | âœ… ìš°ìˆ˜ | ì‚¬ìš©ì í”¼ë“œë°± ì–‘í˜¸ |
| **ì˜¤ë””ì˜¤ í’ˆì§ˆ** | RMS 0.13 (ë°œí™”) vs 0.007 (ë°°ê²½) | âœ… ëª…í™•í•œ ì°¨ì´ | `energyThreshold=0.02` |
| **ì²˜ë¦¬ ì²­í¬ ìˆ˜** | 1,279ê°œ (ì•½ 82ì´ˆ) | â„¹ï¸ ì •ìƒ | ì¹¨ë¬µ/ë°°ê²½ ì†ŒìŒ í¬í•¨ |

#### ì ì§„ì  ì¸ì‹ ê³¼ì • (Partial Results)

```
T=4.5ì´ˆ:  "ì¸ìŠ" (2ì) â† ì²« ë²ˆì§¸ ë¶€ë¶„ ê²°ê³¼
T=5.0ì´ˆ:  "ì¸ìŠë¦° íŒ" (5ì)
T=5.5ì´ˆ:  "ì¸ìŠë¦° íŒí”„ì˜" (7ì)
T=6.0ì´ˆ:  "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼" (10ì)
T=6.5ì´ˆ:  "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼ì— ëŒ€í•´ì„œ" (15ì)
T=7.0ì´ˆ:  "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼ì— ëŒ€í•´ì„œ ì•Œë ¤" (18ì)
T=7.5ì´ˆ:  "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼ì— ëŒ€í•´ì„œ ì•Œë ¤ì£¼ì„¸ìš”." (22ì, Final âœ…)
```

**íŠ¹ì§•**:
- `partial_results_stability=high` íš¨ê³¼: ì´ˆê¸° "ì¸ìŠ"ì´ "ì¸ìˆ˜ë¦¬"ë¡œ ë³€ê²½ë˜ì§€ ì•Šê³  ì•ˆì •ì  ìœ ì§€
- 500ms ê°„ê²©ìœ¼ë¡œ ì ì§„ì  í™•ì¥ â†’ ì‚¬ìš©ì ì…ë ¥ í”¼ë“œë°± ìš°ìˆ˜
- ìµœì¢… ê²°ê³¼ì—ì„œ ë§ˆì¹¨í‘œ(.) ìë™ ì¶”ê°€

#### ì´ì „ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¹„êµ

| ì–¸ì–´ | ë°œí™” ë‚´ìš© | ì²˜ë¦¬ ì²­í¬ | ì¸ì‹ ê²°ê³¼ | ì´ˆê¸° ì§€ì—° | ì •í™•ë„ |
|------|----------|----------|----------|----------|--------|
| í•œêµ­ì–´ (ìµœì‹ ) | "ì¸ìŠë¦° íŒí”„ì˜ íš¨ê³¼ì— ëŒ€í•´ ì•Œë ¤ ì£¼ì„¸ìš”" | 1,279ê°œ | âœ… ì™„ì „ ì¸ì‹ | 4.5ì´ˆ | 100% |
| í•œêµ­ì–´ (ì´ì „) | "ìë™ì°¨ íŠ¹í—ˆ ë¶„ì„ ë°©ë²•ì€" | 1,159ê°œ | âœ… ì™„ì „ ì¸ì‹ | 2-3ì´ˆ | 90% |
| ì˜ì–´ | "How to create a technology roadmap" | 2,723ê°œ | âœ… ì™„ì „ ì¸ì‹ | 1-2ì´ˆ | 95% |

#### ì•Œë ¤ì§„ ì œí•œì‚¬í•­ ë° ê°œì„  ê³„íš

| ë¬¸ì œ | í˜„ì¬ ìƒíƒœ | ê°œì„  ë°©ì•ˆ | ìš°ì„ ìˆœìœ„ |
|------|----------|----------|---------|
| ì´ˆê¸° ì§€ì—° ë†’ìŒ (4.5ì´ˆ) | Pre-roll ì „ì†¡(1ì´ˆ) + AWS ì²˜ë¦¬(3.5ì´ˆ) | Pre-roll í¬ê¸° ì¶•ì†Œ (50â†’40ê°œ, 2.5ì´ˆ) í…ŒìŠ¤íŠ¸ | ì¤‘ê°„ |
| WebSocket ì¢…ë£Œ ìˆœì„œ | í´ë¼ì´ì–¸íŠ¸ ë¨¼ì € ì¢…ë£Œ â†’ AWS ì¶”ê°€ ê²°ê³¼ ì†ì‹¤ | Graceful Shutdown êµ¬í˜„ | ë†’ìŒ |
| ìë™ ì¤‘ì§€ ê¸°ëŠ¥ ì—†ìŒ | ì‚¬ìš©ì ìˆ˜ë™ ë§ˆì´í¬ ë²„íŠ¼ í´ë¦­ í•„ìš” | 3ì´ˆ ì—°ì† ì¹¨ë¬µ ê°ì§€ ì‹œ ìë™ STT ì¢…ë£Œ | ë†’ìŒ |
| ì¸ì¦ ê²½ê³  | `async_session_maker` import ì˜¤ë¥˜ | WebSocket ì¸ì¦ ë¡œì§ ë¶„ë¦¬ | ë‚®ìŒ |
| ë™ìŒì´ì˜ì–´ ì˜¤ì¸ì‹ | "íŠ¹í—ˆ" â†’ "íŠ¹ê¸‰" ê°€ëŠ¥ | AWS Custom Vocabulary ì„¤ì • | ë‚®ìŒ |

### 6.2.6 UI/UX í†µí•©

**ChatPage ë§ˆì´í¬ ë²„íŠ¼**:
```tsx
const handleVoiceInput = () => {
  if (isRecording) {
    realtimeSTT.stop();
    setIsRecording(false);
  } else {
    realtimeSTT.start(
      (text, isPartial) => {
        if (isPartial) {
          setPartialTranscript(text);  // ì„ì‹œ í‘œì‹œ
        } else {
          setMessage(text);  // ì…ë ¥ì°½ì— ìµœì¢… í…ìŠ¤íŠ¸ ì„¤ì •
        }
      },
      (error) => console.error('STT Error:', error),
      selectedLanguage  // 'ko-KR' | 'en-US'
    );
    setIsRecording(true);
  }
};
```

**ì‹œê°ì  í”¼ë“œë°±**:
- ğŸ¤ ë§ˆì´í¬ ë²„íŠ¼: ë…¹ìŒ ìƒíƒœ í† ê¸€
- ğŸ”´ ë¹¨ê°„ ì : ë…¹ìŒ ì¤‘ í‘œì‹œ
- ğŸ“ íŒŒë€ í…ìŠ¤íŠ¸: Partial transcript í‘œì‹œ
- âœ… ê²€ì€ í…ìŠ¤íŠ¸: Final transcript í™•ì •

### 6.2.7 AWS Transcribe ì„¤ì • ì†ì„±

#### í•µì‹¬ API íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ì„¤ì •ê°’ | ì´ìœ  ë° íš¨ê³¼ |
|---------|--------|------------|
| `language_code` | **ko-KR** (í•œêµ­ì–´), en-US (ì˜ì–´) | AWS Transcribe Streamingì€ ë‹¨ì¼ ì–¸ì–´ ì„¸ì…˜ë§Œ ì§€ì›. ìë™ ì–¸ì–´ ê°ì§€(`auto`)ëŠ” ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°ì—ì„œ ë¯¸ì§€ì›í•˜ë¯€ë¡œ ì„¸ì…˜ ì‹œì‘ ì „ ì–¸ì–´ ëª…ì‹œ í•„ìš” |
| `media_sample_rate_hz` | **16000** (16kHz) | ìŒì„± ì¸ì‹ ìµœì  ì£¼íŒŒìˆ˜. ë‚®ì€ ê°’(8kHz)ì€ ìŒì§ˆ ì €í•˜ë¡œ ì¸ì‹ë¥  í•˜ë½, ë†’ì€ ê°’(48kHz)ì€ ëŒ€ì—­í­ ë‚­ë¹„ ë° AWS ë¹„ìš© ì¦ê°€. ì „í™” ìŒì„±(8kHz)ê³¼ ê³ ìŒì§ˆ(48kHz) ì‚¬ì´ ê· í˜•ì  |
| `media_encoding` | **pcm** | ë¹„ì••ì¶• PCM í¬ë§·. AWS TranscribeëŠ” ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°ì—ì„œ ì••ì¶• ì½”ë±(opus, flac) ë¯¸ì§€ì›. ë¸Œë¼ìš°ì € AudioWorklet ì¶œë ¥(Float32)ì„ Int16 PCMìœ¼ë¡œ ë³€í™˜ í•„ìˆ˜ |
| `enable_partial_results_stabilization` | **true** | ë¶€ë¶„ ê²°ê³¼(partial transcript) ì•ˆì •í™” í™œì„±í™”. ë¹„í™œì„±í™” ì‹œ "ì¸ìŠë¦°" â†’ "ì¸ìˆ˜ë¦¬" â†’ "ì¸ìŠë¦°"ì²˜ëŸ¼ ê²°ê³¼ê°€ ê³„ì† ë³€ê²½ë˜ì–´ ì‚¬ìš©ì í˜¼ë€. í™œì„±í™” ì‹œ ì´ˆê¸° ì¶”ì¸¡ì„ ë³´ìˆ˜ì ìœ¼ë¡œ ì œê³µí•˜ì—¬ ë³€ê²½ ë¹ˆë„ ê°ì†Œ |
| `partial_results_stability` | **high** | **low**: ë¹ ë¥¸ ì‘ë‹µ, ì¦ì€ ë³€ê²½ (íƒ€ì´í•‘ ëŠë‚Œ)<br>**medium**: ê· í˜• (ê¸°ë³¸ê°’)<br>**high**: ëŠë¦° ì‘ë‹µ, ë†’ì€ ì •í™•ë„ (ì¶”ì²œ). ì˜ë£Œ/ê¸°ìˆ  ìš©ì–´ê°€ ë§ì€ ABEKM íŠ¹ì„±ìƒ ì¦ì€ ë³€ê²½ë³´ë‹¤ ì •í™•í•œ ì´ˆê¸° ì¶”ì¸¡ì´ ì¤‘ìš” |
| `enable_channel_identification` | **false** | ì±„ë„ ë¶„ë¦¬ ë¹„í™œì„±í™”. ë¸Œë¼ìš°ì € ë§ˆì´í¬ëŠ” ëª¨ë…¸ ì…ë ¥(1ì±„ë„)ì´ë¯€ë¡œ ì±„ë„ ì‹ë³„ ë¶ˆí•„ìš”. `true` ì„¤ì • ì‹œ `number_of_channels â‰¥ 2` í•„ìˆ˜ì´ë‚˜ ëª¨ë…¸ ì˜¤ë””ì˜¤ì—ì„œëŠ” AWS ì˜¤ë¥˜ ë°œìƒ |
| `number_of_channels` | **ì„¤ì • ì•ˆ í•¨** | `enable_channel_identification=false`ì¼ ë•Œ ì´ íŒŒë¼ë¯¸í„° ì œê±° í•„ìš”. 1ë¡œ ì„¤ì • ì‹œ AWSê°€ "ìµœì†Œ 2 ì´ìƒ" ì˜¤ë¥˜ ë°˜í™˜. ì±„ë„ ì‹ë³„ ë¹„í™œì„±í™” ì‹œ AWSê°€ ìë™ìœ¼ë¡œ ëª¨ë…¸ ì²˜ë¦¬ |

#### ì˜¤ì¸ì‹ í›„ì²˜ë¦¬ ì†ì„±

| ì†ì„± | ì„¤ì • ë°©ë²• | ëª©ì  |
|------|----------|------|
| `post_process_transcript` | ìµœì¢… ê²°ê³¼(is_partial=false)ì—ë§Œ ì ìš© | ë¶€ë¶„ ê²°ê³¼ë§ˆë‹¤ í›„ì²˜ë¦¬ ì‹œ ì¤‘ê°„ í…ìŠ¤íŠ¸ê°€ ê³„ì† ë³€ê²½ë˜ì–´ ì‚¬ìš©ì í˜¼ë€. í™•ì • ê²°ê³¼ì—ë§Œ ì‚¬ì „ ê¸°ë°˜ êµì²´ ì ìš© |
| `COMMON_MISRECOGNITIONS` ì‚¬ì „ | "ì‹¤ë§ í˜ì´ì§€" â†’ "ì¸ìŠë¦° íŒí”„" ë“± ë§¤í•‘ | AWS Transcribe í•œêµ­ì–´ ëª¨ë¸ì€ ì „ë¬¸ ì˜ë£Œ/ê¸°ìˆ  ìš©ì–´ ì¸ì‹ë¥  ë‚®ìŒ. ë™ìŒì´ì˜ì–´ ì˜¤ì¸ì‹ íŒ¨í„´ì„ ì‚¬ì „ì— ë“±ë¡í•˜ì—¬ ìë™ ë³´ì • |
| `should_post_process` ì¡°ê±´ | í…ìŠ¤íŠ¸ ê¸¸ì´ â‰¥ 3ì, is_partial=false | ë„ˆë¬´ ì§§ì€ í…ìŠ¤íŠ¸("ë„¤", "ì˜ˆ")ëŠ” í›„ì²˜ë¦¬ ì œì™¸í•˜ì—¬ ê³¼ë„í•œ êµì²´ ë°©ì§€. ë¶€ë¶„ ê²°ê³¼ëŠ” ì œì™¸í•˜ì—¬ ì„±ëŠ¥ ìµœì í™” |

#### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

**.env í•„ìˆ˜ ë³€ìˆ˜**:
```bash
# AWS ì¸ì¦ (IAM ê¶Œí•œ: transcribe:StartStreamTranscription í•„ìš”)
AWS_ACCESS_KEY_ID=AKIA***
AWS_SECRET_ACCESS_KEY=***
AWS_REGION=ap-northeast-2  # ì„œìš¸ ë¦¬ì „ (í•œêµ­ì–´ ì§€ì›)

# AWS Transcribe ê¸°ë³¸ê°’ (ì½”ë“œì—ì„œ ì¬ì •ì˜ ê°€ëŠ¥)
TRANSCRIBE_LANGUAGE_CODE=ko-KR
TRANSCRIBE_SAMPLE_RATE=16000
TRANSCRIBE_PARTIAL_STABILITY=high  # low|medium|high
```

**ì˜ì¡´ì„±**:
```bash
# Backend
pip install amazon-transcribe==0.6.2  # AWS SDK
pip install fastapi[websockets]       # WebSocket ì§€ì›

# Frontend (ë¸Œë¼ìš°ì € ë‚´ì¥ API, ë³„ë„ ì„¤ì¹˜ ë¶ˆí•„ìš”)
# - MediaStream API (getUserMedia)
# - AudioWorklet API (ì˜¤ë””ì˜¤ ì²˜ë¦¬)
# - WebSocket API (ì–‘ë°©í–¥ í†µì‹ )
```

#### ì„±ëŠ¥ íŠœë‹ ê°€ì´ë“œ

| ì‹œë‚˜ë¦¬ì˜¤ | ê¶Œì¥ ì„¤ì • | íŠ¸ë ˆì´ë“œì˜¤í”„ |
|---------|----------|------------|
| **ë¹ ë¥¸ ì‘ë‹µ ìš°ì„ ** | `partial_results_stability=low`, í›„ì²˜ë¦¬ ë¹„í™œì„±í™” | ì¸ì‹ë¥  í•˜ë½, ì¦ì€ í…ìŠ¤íŠ¸ ë³€ê²½ |
| **ì •í™•ë„ ìš°ì„ ** (ê¶Œì¥) | `partial_results_stability=high`, í›„ì²˜ë¦¬ í™œì„±í™” | ì´ˆê¸° ì‘ë‹µ 0.5-1ì´ˆ ì§€ì—° |
| **ëŒ€ì—­í­ ì ˆì•½** | `energyThreshold=0.05`, `maxSilenceFrames=20` | ë°°ê²½ ì†ŒìŒ ë§ì€ í™˜ê²½ì—ì„œ ë°œí™” ì†ì‹¤ ê°€ëŠ¥ |
| **ì´ˆê¸° ë°œí™” ìº¡ì²˜ ê°•í™”** | `maxPreRollChunks=70` (4.5ì´ˆ), `isConnected` ì§€ì—° | ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€ (140KB), ì‹¤ì‹œê°„ ì „ì†¡ ì‹œì‘ ì§€ì—° |

### 6.2.8 ê°œì„  ì‚¬í•­ ì ìš© (2025-11-24) ğŸ†•

#### 1. ìë™ ì¤‘ì§€ ê¸°ëŠ¥

**ëª©ì **: ì‚¬ìš©ìê°€ ë°œí™”ë¥¼ ë©ˆì¶˜ í›„ ìˆ˜ë™ìœ¼ë¡œ ë§ˆì´í¬ ë²„íŠ¼ì„ í´ë¦­í•˜ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ STT ì¢…ë£Œ

**êµ¬í˜„**:
| ì†ì„± | ì„¤ì •ê°’ | ì„¤ëª… |
|------|--------|------|
| `continuousSilenceCount` | ë‚´ë¶€ ì¹´ìš´í„° | ì—°ì† ì¹¨ë¬µ ì²­í¬ ëˆ„ì  ì¹´ìš´í„° |
| `autoStopSilenceThreshold` | **23ê°œ** | ì•½ 3ì´ˆ ì¹¨ë¬µ (23 Ã— 128ms = 2.94ì´ˆ) |
| `autoStopCallback` | ì½œë°± í•¨ìˆ˜ | ìë™ ì¤‘ì§€ ì¡°ê±´ ì¶©ì¡± ì‹œ `stop()` í˜¸ì¶œ |

**ë™ì‘ ì›ë¦¬**:
1. ì˜¤ë””ì˜¤ RMS < 0.02 (ì¹¨ë¬µ) â†’ `continuousSilenceCount++`
2. ì˜¤ë””ì˜¤ RMS â‰¥ 0.02 (ë°œí™”) â†’ `continuousSilenceCount = 0` (ë¦¬ì…‹)
3. `continuousSilenceCount â‰¥ 23` â†’ ìë™ ì¤‘ì§€ íŠ¸ë¦¬ê±°

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// ìë™ ì¤‘ì§€ í™œì„±í™” (ê¸°ë³¸ê°’)
realtimeSTT.start(onTranscript, onError, 'ko-KR', true);

// ìë™ ì¤‘ì§€ ë¹„í™œì„±í™” (ìˆ˜ë™ ì œì–´ í•„ìš”)
realtimeSTT.start(onTranscript, onError, 'ko-KR', false);
```

**íš¨ê³¼**:
- ì‚¬ìš©ì ê²½í—˜ ê°œì„ : ë°œí™” ì¢…ë£Œ í›„ ìë™ìœ¼ë¡œ ì…ë ¥ì°½ì— í…ìŠ¤íŠ¸ í™•ì •
- ë¶ˆí•„ìš”í•œ ë°°ê²½ ì†ŒìŒ ì „ì†¡ ë°©ì§€ (ëŒ€ì—­í­ ì ˆì•½)
- ë§ˆì´í¬ ë²„íŠ¼ í´ë¦­ ë‹¨ê³„ ì œê±°

#### 2. Pre-roll ë²„í¼ í¬ê¸° ìµœì í™”

**ë³€ê²½ ì „**: `maxPreRollChunks = 50` (3.2ì´ˆ)  
**ë³€ê²½ í›„**: `maxPreRollChunks = 40` (2.5ì´ˆ)

**ì´ìœ **:
- ì´ˆê¸° ì§€ì—° ê°ì†Œ: 4.5ì´ˆ â†’ 3.8ì´ˆ (ì•½ 0.7ì´ˆ ê°œì„  ëª©í‘œ)
- 40ê°œ ì²­í¬(2.5ì´ˆ)ë„ ì¼ë°˜ì ì¸ ë°œí™” ì‹œì‘ ì§€ì—°(1-2ì´ˆ) + ì—°ê²° ì§€ì—°(0.3-0.5ì´ˆ) ì»¤ë²„ ê°€ëŠ¥
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ: 100KB â†’ 80KB

**ê²€ì¦ í•„ìš”**: ë¹ ë¥¸ ë°œí™” ì‹œì‘ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ì´ˆê¸° ë‹¨ì–´ ì†ì‹¤ ì—¬ë¶€ í…ŒìŠ¤íŠ¸

#### 3. Graceful Shutdown (ë°±ì—”ë“œ)

**ë¬¸ì œ**: í´ë¼ì´ì–¸íŠ¸ê°€ WebSocketì„ ë¨¼ì € ì¢…ë£Œí•˜ë©´ AWSì—ì„œ ì „ì†¡ ì¤‘ì¸ ë§ˆì§€ë§‰ ê²°ê³¼ê°€ ì†ì‹¤ë¨

**í•´ê²°**:
```python
# session.close() ë‚´ë¶€
await asyncio.wait_for(self.handler_task, timeout=2.0)  # AWS í•¸ë“¤ëŸ¬ ì™„ë£Œ ëŒ€ê¸°
```

**ë™ì‘ ì‹œí€€ìŠ¤**:
1. í´ë¼ì´ì–¸íŠ¸ê°€ `{"action": "stop"}` ì „ì†¡
2. ë°±ì—”ë“œê°€ `session.close()` í˜¸ì¶œ (AWS ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ ì‹ í˜¸ ì „ì†¡)
3. **ìµœëŒ€ 2ì´ˆ ëŒ€ê¸°** (AWSê°€ ë§ˆì§€ë§‰ ê²°ê³¼ ì „ì†¡ ì™„ë£Œí•  ì‹œê°„ ì œê³µ)
4. í´ë¼ì´ì–¸íŠ¸ì— `{"type": "stopped"}` ì‘ë‹µ ì „ì†¡
5. WebSocket ì¢…ë£Œ

**íš¨ê³¼**:
- ë°œí™” ì¢…ë£Œ í›„ ì¶”ê°€ ë°œì–¸("ê·¸ëŸ¼", "ë„¤" ë“±)ì´ ì†ì‹¤ë˜ì§€ ì•Šê³  ì •ìƒ ì „ì†¡
- íƒ€ì„ì•„ì›ƒ(2ì´ˆ)ìœ¼ë¡œ ë¬´í•œ ëŒ€ê¸° ë°©ì§€

#### 4. ì¸ì¦ ê²½ê³  í•´ê²°

**ë³€ê²½ ì „**: `async_session_maker` import ì˜¤ë¥˜ (ë¹„ë™ê¸° ì„¸ì…˜ ì‚¬ìš© ì‹¤íŒ¨)  
**ë³€ê²½ í›„**: ë™ê¸° `SessionLocal` ì‚¬ìš©

**ì´ìœ **:
- WebSocket ì¸ì¦ì€ ì—°ê²° ì´ˆê¸°ì—ë§Œ 1íšŒ ìˆ˜í–‰ (ì„±ëŠ¥ ì˜í–¥ ë¯¸ë¯¸)
- ë¹„ë™ê¸° DB ì„¸ì…˜ì˜ ë³µì¡ì„± ì œê±° (WebSocket ìˆ˜ëª… ê´€ë¦¬ ë‹¨ìˆœí™”)
- STT ê¸°ëŠ¥ì€ DB ì˜ì¡´ì„± ì—†ìŒ (ì¸ì¦ ì‹¤íŒ¨ ì‹œì—ë„ ì •ìƒ ì‘ë™)

**ê²°ê³¼**: `âš ï¸ [STT-AUTH] ì¸ì¦ ì‹¤íŒ¨` ê²½ê³  ì œê±°

#### ì ìš© í›„ ì˜ˆìƒ ì„±ëŠ¥

| ì§€í‘œ | ë³€ê²½ ì „ | ë³€ê²½ í›„ (ì˜ˆìƒ) | ê°œì„ ìœ¨ |
|------|---------|--------------|--------|
| **ì´ˆê¸° ì§€ì—°** | 4.5ì´ˆ | 3.8ì´ˆ | -15% â¬‡ï¸ |
| **ìë™ ì¤‘ì§€** | ìˆ˜ë™ (ë²„íŠ¼ í´ë¦­) | ìë™ (3ì´ˆ ì¹¨ë¬µ) | UX ê°œì„  â¬†ï¸ |
| **WebSocket ì¢…ë£Œ ì†ì‹¤** | ìˆìŒ ("ê·¸ëŸ¼." ëˆ„ë½) | ì—†ìŒ (2ì´ˆ ëŒ€ê¸°) | ì•ˆì •ì„± â¬†ï¸ |
| **ì¸ì¦ ê²½ê³ ** | ìˆìŒ | ì—†ìŒ | ë¡œê·¸ ì •ë¦¬ â¬†ï¸ |

## 7. ë©€í‹° ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°

| ë‹¨ê³„                   | ì—­í•           | ì‚°ì¶œë¬¼              |
| -------------------- | ----------- | ---------------- |
| Analyzer             | ë¬¸ì„œ/ì§ˆì˜ ì˜ë¯¸ ë¶„ì„ | í•µì‹¬ í† í”½/ì„¹ì…˜ ë§¤í•‘      |
| Insight Extractor    | í†µì°°/í‚¤ í¬ì¸íŠ¸ ì¶”ì¶œ | insight ë¦¬ìŠ¤íŠ¸      |
| Summarizer           | ìš”ì•½/ì••ì¶•       | êµ¬ì¡°í™” ìš”ì•½ í…ìŠ¤íŠ¸       |
| Presentation Builder | ìŠ¬ë¼ì´ë“œ êµ¬ì¡°í™”    | outline, ìŠ¬ë¼ì´ë“œ ë©”íƒ€ |
| Finalizer            | ì‘ë‹µ í¬ë§·/ì¶œì²˜ ì •ë¦¬ | ìµœì¢… ë‹µë³€ í…ìŠ¤íŠ¸        |

## 8. ì„¸ì…˜ ë° ìƒíƒœ ê´€ë¦¬

| í•­ëª©               | ì €ì¥ì†Œ                           | ë‚´ìš©                     |
| ---------------- | ----------------------------- | ---------------------- |
| ì§„í–‰ì¤‘ ëŒ€í™” ë©”ì‹œì§€       | Redis (list/hash)             | ìµœê·¼ nê°œ ë©”ì‹œì§€, ì„ì‹œ ë²„í¼       |
| ì„¸ì…˜ ë©”íƒ€(ìµœì´ˆ/ë§ˆì§€ë§‰ í™œë™) | PostgreSQL (tb_chat_sessions) | ìš”ì•½ ì´ë¦„, ë©”ì‹œì§€ ìˆ˜           |
| ë¬¸ì„œ ì„ íƒ ìƒíƒœ         | í”„ë¡ íŠ¸ ë©”ëª¨ë¦¬ / ì„œë²„ ì „ë‹¬               | selectedDocuments ì»¨í…ìŠ¤íŠ¸ |
| PPT ì§„í–‰           | í´ë¼ì´ì–¸íŠ¸ state + SSE             | outline/progress stage |

## 9. ì˜¤ë¥˜ ë° ë³µêµ¬ ì „ëµ

| ìƒí™©         | ì²˜ë¦¬              | Fallback             |
| ---------- | --------------- | -------------------- |
| LLM ê³µê¸‰ì ì˜¤ë¥˜ | ì¬ì‹œë„ + ë‹¤ë¥¸ ê³µê¸‰ì    | provider failover ìˆœí™˜ |
| ê²€ìƒ‰ ê²°ê³¼ ë¶€ì¡±   | í‚¤ì›Œë“œ ë¹„ì¤‘ ìƒí–¥ ì¬ê²€ìƒ‰   | ë‹¨ìˆœ ìš”ì•½ ì‘ë‹µ             |
| ì—ì´ì „íŠ¸ ë‹¨ê³„ ì‹¤íŒ¨ | í•´ë‹¹ ë‹¨ê³„ ìŠ¤í‚µ/ë¡œê·¸ ê¸°ë¡  | ë‹¨ì¼ LLM ì‘ë‹µ ì „í™˜         |
| PPT ìƒì„± ì‹¤íŒ¨  | stage=error ì´ë²¤íŠ¸ | ì¬ì‹œë„ ì•ˆë‚´ ë©”ì‹œì§€           |

## 10. í’ˆì§ˆ/ì„±ëŠ¥ ë³´í˜¸ ì¥ì¹˜

- í† í° ê°€ë“œ (í”„ë¡¬í”„íŠ¸/ì‘ë‹µ ê¸¸ì´ ì œí•œ)
- ì¤‘ë³µ ì²­í¬ ì œê±°, ìœ ì‚¬ë„ ì„ê³„ê°’ ì ìš©
- ë¹„ì •ìƒ ì„¸ì…˜(ì—°ì† ì˜¤ë¥˜) ì°¨ë‹¨/ëƒ‰ê° ì‹œê°„
- ë²¤ë”ë³„ ì‹œê°„ ì´ˆê³¼ ì„¤ì • ë° íšŒë¡œ ì°¨ë‹¨(circuit breaker) íŒ¨í„´

## 11. ë³´ì•ˆ/ê¶Œí•œ ì—°ê³„

- ì»¨í…Œì´ë„ˆ ID ëª©ë¡ ê¸°ë°˜ ê²€ìƒ‰ ì œí•œ
- ì‚¬ìš©ì RBAC â†’ ì¿¼ë¦¬ ì‹œ í•„í„° ì…ë ¥ ê°•ì œ
- ë¡œê·¸ì— ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹(ì‚¬ìš©ì ID, ë‚´ë¶€ ì‹ë³„ì ìµœì†Œí™”)

## 12. í™•ì¥ í¬ì¸íŠ¸ (í–¥í›„)

| ì˜ì—­          | í™•ì¥ ì•„ì´ë””ì–´                  | ë¹„ê³             |
| ----------- | ------------------------ | ------------- |
| Retrieval   | Adaptive re-ranking (ML) | í˜„ì¬ Rule ê¸°ë°˜    |
| Multi-Agent | ë™ì  ê·¸ë˜í”„ í•™ìŠµ                | ì •ì  ë§¤í•‘ â†’ í•™ìŠµ ì „í™˜ |
| Generation  | ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬           | ë„ë©”ì¸ë³„ í…œí”Œë¦¿      |
| Evaluation  | ìë™ í’ˆì§ˆ í‰ê°€(LLM-as-Judge)   | ìƒ˜í”Œë§ ë°°ì¹˜        |
| PPT         | í‘œ/ì°¨íŠ¸ ìë™ ìƒì„±               | ë°ì´í„° ì†ŒìŠ¤ ì—°ê³„     |

## 13. ê´€ë ¨ ì£¼ìš” ì½”ë“œ ìœ„ì¹˜

| ê¸°ëŠ¥                  | ê²½ë¡œ                                                                      | ì„¤ëª…                   |
| ------------------- | ----------------------------------------------------------------------- | -------------------- |
| ìŠ¤íŠ¸ë¦¬ë° ì—”ë“œí¬ì¸íŠ¸          | backend/app/api/v1/chat.py                                              | SSE ì‘ë‹µ, RAG/ì—ì´ì „íŠ¸ ë¶„ê¸°  |
| **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ API** ğŸ†•  | **backend/app/api/v1/search.py**                                        | **ë©€í‹°ëª¨ë‹¬/CLIP ì—”ë“œí¬ì¸íŠ¸**  |
| ë©€í‹° ì—ì´ì „íŠ¸ ì„œë¹„ìŠ¤         | backend/app/services/multi_agent/integrated_service.py                  | ì‹¤í–‰ ëª¨ë“œ ê²°ì •/ì›Œí¬í”Œë¡œìš°       |
| ì›Œí¬í”Œë¡œìš° ì •ì˜            | backend/app/services/multi_agent/langgraph_workflow.py                  | ì—ì´ì „íŠ¸ ë…¸ë“œ/íë¦„           |
| ì—ì´ì „íŠ¸ íˆ´              | backend/app/services/multi_agent/enhanced_agent_tools.py                | ë¶„ì„/í‚¤ì›Œë“œ/í”„ë ˆì  í…Œì´ì…˜ íˆ´      |
| RAG ê²€ìƒ‰              | backend/app/services/chat/rag_search_service.py                         | í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰/ë¦¬ë­í‚¹         |
| **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ì„œë¹„ìŠ¤** ğŸ†•  | **backend/app/services/document/search/multimodal_search_service.py**   | **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ë¡œì§**       |
| **CLIP ì„ë² ë”© ì„œë¹„ìŠ¤** ğŸ†• | **backend/app/services/document/vision/image_embedding_service.py**     | **CLIP ì„ë² ë”© ìƒì„±**      |
| í”„ë¡ íŠ¸ ì±„íŒ… í˜ì´ì§€          | frontend/src/pages/user/ChatPage.tsx                                    | UI/ëª¨ë“œ ì „í™˜/ë¬¸ì„œ ë™ê¸°í™”      |
| í”„ë¡ íŠ¸ ê²€ìƒ‰ í˜ì´ì§€ ğŸ†•       | frontend/src/pages/user/SearchPage.tsx                                  | ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ UI           |
| í”„ë¡ íŠ¸ í›…               | frontend/src/pages/user/chat/hooks/useChat.ts                           | SSE ì—°ê²°/ì„¸ì…˜ ê´€ë¦¬         |
| **í”„ë¡ íŠ¸ ê²€ìƒ‰ í›…** ğŸ†•     | **frontend/src/pages/user/search/hooks/useSearch.ts**                   | **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ ë¡œì§**       |
| **ê²€ìƒ‰ ì„œë¹„ìŠ¤** ğŸ†•       | **frontend/src/services/searchService.ts**                              | **ë©€í‹°ëª¨ë‹¬/CLIP API í˜¸ì¶œ** |
| PPT ìƒì„± í›…            | frontend/src/pages/user/chat/components/presentation/usePresentation.ts | Outline/PPT ë¹Œë“œ       |

## 14. ë©€í‹°ëª¨ë‹¬ ì§€ì› ìš”ì•½ (2025-10-17) ğŸ†•

### 14.1 êµ¬í˜„ ì™„ë£Œ í•­ëª©

- âœ… **ë°±ì—”ë“œ CLIP ì„ë² ë”© ì„œë¹„ìŠ¤** í”„ë¡œë•ì…˜ ë°°í¬
  - Azure CLIP API ìš°ì„  ì‹œë„
  - ë¡œì»¬ CLIP ëª¨ë¸ ìë™ fallback
  - í…ìŠ¤íŠ¸ ë° ì´ë¯¸ì§€ ì„ë² ë”© ìƒì„± (512ì°¨ì›)
- âœ… **ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰ API** 2ê°œ ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
  - `POST /api/v1/search/multimodal`: í…ìŠ¤íŠ¸ + ì´ë¯¸ì§€ ë©”íƒ€
  - `POST /api/v1/search/clip`: ì´ë¯¸ì§€ ì—…ë¡œë“œ ê²€ìƒ‰
- âœ… **ë¬¸ì„œ ì—…ë¡œë“œ ì‘ë‹µ í™•ì¥**: multimodal_metadata í•„ë“œ
  - ì´ë¯¸ì§€/í‘œ/ì°¨íŠ¸ ê°œìˆ˜
  - CLIP ì„ë² ë”© ìƒíƒœ
  - ì´ë¯¸ì§€ ê²€ìƒ‰ ê°€ëŠ¥ ì—¬ë¶€
- âœ… **í”„ë¡ íŠ¸ì—”ë“œ ê²€ìƒ‰ íƒ€ì… í™•ì¥**
  - ğŸ¨ ë©€í‹°ëª¨ë‹¬ (ì´ë¯¸ì§€ ìš°ì„ )
  - ğŸ–¼ï¸ CLIP (ì´ë¯¸ì§€ ê²€ìƒ‰)
- âœ… **ì´ë¯¸ì§€ ì—…ë¡œë“œ UI** ì™„ì„±
  - SearchBar ë° FloatingSearchBar
  - ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° (ì¸ë„¤ì¼ + ë©”íƒ€)
  - íŒŒì¼ ê²€ì¦ (íƒ€ì…, 10MB ì œí•œ)
- âœ… **ê²€ìƒ‰ ê²°ê³¼ ë©”íƒ€ í‘œì‹œ**
  - ğŸ–¼ï¸ ì´ë¯¸ì§€ ê°œìˆ˜ ë±ƒì§€ (íŒŒë€ìƒ‰)
  - ğŸ¨ ì´ë¯¸ì§€ ëª¨ë‹¬ë¦¬í‹° ë±ƒì§€ (ë³´ë¼ìƒ‰)
  - ğŸ” CLIP ì ìˆ˜ ë±ƒì§€ (ì´ˆë¡ìƒ‰)

### 14.2 ì„±ëŠ¥ ì§€í‘œ

| í•­ëª©          | ì¸¡ì •ê°’       | ë¹„ê³                            |
| ----------- | --------- | ---------------------------- |
| CLIP ì„ë² ë”© ìƒì„± | 300-500ms | CPU ê¸°ë°˜, GPU ì‚¬ìš© ì‹œ 50-100ms ì˜ˆìƒ |
| ë©€í‹°ëª¨ë‹¬ ê²€ìƒ‰     | 200-400ms | í…ìŠ¤íŠ¸ ê²€ìƒ‰ + CLIP ê²€ìƒ‰             |
| ì´ë¯¸ì§€ ì—…ë¡œë“œ ê²€ìƒ‰  | 400-800ms | ì´ë¯¸ì§€ ì „ì²˜ë¦¬ + CLIP + ê²€ìƒ‰          |
| ê²€ìƒ‰ ì •í™•ë„      | 92%       | ì´ë¯¸ì§€ í¬í•¨ ë¬¸ì„œ ê²€ìƒ‰                 |
| CLIP ë²¡í„° ì°¨ì›  | 512d      | L2 Norm = 1.0000             |
| í…ìŠ¤íŠ¸ ë²¡í„° ì°¨ì›   | 1536d     | Azure OpenAI                 |

### 14.3 í–¥í›„ ê°œì„  ë°©í–¥

- [ ] GPU ì§€ì›ìœ¼ë¡œ CLIP ì¶”ë¡  ì†ë„ ê°œì„  (10ë°° í–¥ìƒ ì˜ˆìƒ)
- [ ] ì´ë¯¸ì§€ ì¸ë„¤ì¼ í‘œì‹œ (ê²€ìƒ‰ ê²°ê³¼ì— ì‹¤ì œ ì´ë¯¸ì§€)
- [ ] ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë¯¸ì§€ ì—…ë¡œë“œ
- [ ] ë³µìˆ˜ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì§€ì›
- [ ] CLIP ìœ ì‚¬ë„ ì‹œê°í™” ê·¸ë˜í”„
- [ ] ì´ë¯¸ì§€ ìº¡ì…”ë‹ ìë™ ìƒì„± (GPT-4V)
- [ ] ë¹„ë””ì˜¤ ê²€ìƒ‰ (ì”¬ ê°ì§€, íƒ€ì„ìŠ¤íƒ¬í”„)
- [ ] ì˜¤ë””ì˜¤ ê²€ìƒ‰ (Whisper íŠ¸ëœìŠ¤í¬ë¦½ì…˜)

### 14.4 ì°¸ê³  ë¬¸ì„œ

- `MULTIMODAL_INTEGRATION_COMPLETE_FINAL.md`: ì „ì²´ êµ¬í˜„ ë³´ê³ ì„œ
- `MULTIMODAL_SEARCH_TESTING_GUIDE.md`: í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ
- `backend/test_multimodal_pipeline.py`: íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸
- `AZURE_CLIP_ISSUE_RESOLVED.md`: CLIP ì´ìŠˆ í•´ê²° ê¸°ë¡

---

ì°¸ê³  ë¬¸ì„œ
- ì‹œìŠ¤í…œ ê°œìš” 6ì¥: `01.docs/01.system_overview_design.md`ì˜ "6. AI ì§€ì‹ìƒì„± ì‹œìŠ¤í…œ ìƒì„¸" ìš”ì•½ì„ í•¨ê»˜ ì°¸ì¡°í•˜ì„¸ìš”.

## 14. ìš©ì–´ ì •ë¦¬

| ìš©ì–´            | ì •ì˜                                            |
| ------------- | --------------------------------------------- |
| RAG           | Retrieval-Augmented Generation, ê²€ìƒ‰ + ìƒì„± ê²°í•© íŒ¨í„´ |
| Hybrid Search | ë²¡í„°(ì˜ë¯¸) + í‚¤ì›Œë“œ(BM25/TF-IDF) ê²°í•© ê²€ìƒ‰               |
| Multi-Agent   | ì—­í•  ë¶„ë¦¬ëœ ë³µìˆ˜ ì—ì´ì „íŠ¸ í˜‘ì—… ì‹¤í–‰ êµ¬ì¡°                       |
| SSE           | Server-Sent Events, ë‹¨ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë° ì±„ë„               |
| Outline       | PPT ìƒì„± ì „ ìŠ¬ë¼ì´ë“œ êµ¬ì¡° ì´ˆì•ˆ                           |

---

ë³¸ ë¬¸ì„œëŠ” `01.system_overview_design.md` 6ì¥ê³¼ ì—°ê³„ë˜ë©°, ë³€ê²½ ë°œìƒ ì‹œ ë‘ ë¬¸ì„œ ê°„ ë™ê¸°í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.

## 15. API ìš”ì•½ (ë³¸ ì„¹ì…˜ ê´€ë ¨)

- ì±„íŒ… ìŠ¤íŠ¸ë¦¼: `POST /api/v1/chat/stream` (SSE)
- ì„¸ì…˜: `GET/POST/DELETE /api/v1/chat/sessions/*`
- PPT í…œí”Œë¦¿: `GET /api/v1/chat/presentation/templates` (+ ìƒì„¸/ì¸ë„¤ì¼/íŒŒì¼)
- PPT Outline: `POST /api/v1/chat/presentation/outline`
- PPT Quick ë¹Œë“œ: `POST /api/v1/chat/presentation/build-quick` (SSE)
- PPT í…œí”Œë¦¿ ë¹Œë“œ: `POST /api/v1/chat/presentation/build-with-template` (SSE)