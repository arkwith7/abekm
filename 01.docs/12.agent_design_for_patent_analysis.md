# íŠ¹í—ˆ ë¶„ì„ ì—ì´ì „íŠ¸ ê³ ë„í™” ì„¤ê³„ì„œ (Patent Analysis Agent Refactoring Design)

## 1. ê°œìš”
ë³¸ ë¬¸ì„œëŠ” ê¸°ì¡´ì˜ ë‹¨ì¼ ë„êµ¬(`PatentSearchTool`) ê¸°ë°˜ íŠ¹í—ˆ ë¶„ì„ ì‹œìŠ¤í…œì„ **Layered Tool Architecture**ë¡œ ì¬ì„¤ê³„í•˜ì—¬, ì—ì´ì „íŠ¸ê°€ ì‚¬ìš©ìì˜ ì˜ë„(ê²€ìƒ‰, ìƒì„¸ ë¶„ì„, ê¶Œë¦¬ ë¶„ì„ ë“±)ì— ë§ì¶° ìµœì ì˜ ë„êµ¬ë¥¼ ì„ íƒí•˜ê³  ì •ë°€í•œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.

## 2. ì•„í‚¤í…ì²˜ ì„¤ê³„ (Layered Architecture)

ì‹œìŠ¤í…œì€ ë‹¤ìŒ 3ê³„ì¸µìœ¼ë¡œ êµ¬ì„±ëœë‹¤.

### Layer 1: Provider Adapter (ì €ìˆ˜ì¤€ API í´ë¼ì´ì–¸íŠ¸)
ê° ë°ì´í„° ì œê³µì(KIPRIS, SerpAPI ë“±)ì˜ API ëª…ì„¸ì™€ 1:1ë¡œ ë§¤í•‘ë˜ëŠ” ì €ìˆ˜ì¤€ í´ë¼ì´ì–¸íŠ¸ ëª¨ë“ˆ.

*   **KIPRIS Client (`backend/app/clients/kipris.py`)**
    *   `search_patents`: íŠ¹í—ˆ/ì‹¤ìš©ì‹ ì•ˆ ê²€ìƒ‰ (Advanced Search)
    *   `get_bibliography`: ì„œì§€ ì •ë³´ ì¡°íšŒ (ìš”ì•½, ëŒ€í‘œë„ë©´ ë“±)
    *   `get_full_text`: ì „ë¬¸(Full Text) ì¡°íšŒ (ì²­êµ¬í•­, ìƒì„¸ì„¤ëª…)
    *   `get_legal_status`: í–‰ì •/ë²•ì  ìƒíƒœ ì¡°íšŒ (ë“±ë¡, ê±°ì ˆ, ì†Œë©¸, ì‹¬ì‚¬ì´ë ¥)
    *   `get_images`: ë„ë©´ ì´ë¯¸ì§€ ì¡°íšŒ
*   **Google Patents Client (`backend/app/clients/google_patents.py`)**
    *   `search`: ê¸€ë¡œë²Œ íŠ¹í—ˆ ê²€ìƒ‰
    *   `get_details`: ìƒì„¸ ì •ë³´ ë° ì¸ìš© ê´€ê³„

### Layer 2: Functional Tools (ê¸°ëŠ¥ë³„ ë„êµ¬)
ì—ì´ì „íŠ¸ê°€ ì‚¬ìš©í•˜ëŠ” ì‹¤ì œ ë„êµ¬(Tool). ì‚¬ìš©ìì˜ "ì˜ë„" ë‹¨ìœ„ë¡œ ê¸°ëŠ¥ì„ ì¶”ìƒí™”í•œë‹¤.

1.  **PatentDiscoveryTool (íŠ¹í—ˆ íƒìƒ‰ ë„êµ¬)**
    *   **ëª©ì **: ê´‘ë²”ìœ„í•œ íƒìƒ‰, ë¦¬ìŠ¤íŠ¸ í™•ë³´.
    *   **ê¸°ëŠ¥**: í‚¤ì›Œë“œ/ì¶œì›ì¸/IPC ê¸°ë°˜ ê²€ìƒ‰. ê°€ë²¼ìš´ ì„œì§€ ì •ë³´(ë²ˆí˜¸, ì œëª©, ì¶œì›ì¸, ë‚ ì§œ, ìƒíƒœ)ë§Œ ë°˜í™˜.
    *   **Use Case**: "ì‚¼ì„±ì „ìì˜ AI íŠ¹í—ˆ ì°¾ì•„ì¤˜", "ìµœê·¼ 3ë…„ ë°˜ë„ì²´ íŠ¹í—ˆ ë¦¬ìŠ¤íŠ¸ ë½‘ì•„ì¤˜"

2.  **PatentDetailTool (íŠ¹í—ˆ ìƒì„¸ ë¶„ì„ ë„êµ¬)**
    *   **ëª©ì **: íŠ¹ì • íŠ¹í—ˆì˜ ê¸°ìˆ ì  ë‚´ìš© ì‹¬ì¸µ ë¶„ì„.
    *   **ê¸°ëŠ¥**: íŠ¹í—ˆ ë²ˆí˜¸ë¥¼ ì…ë ¥ë°›ì•„ **ì²­êµ¬í•­(Claims)**, **ìƒì„¸ì„¤ëª…**, **ë„ë©´** ë“± ë¬´ê±°ìš´ ë°ì´í„°ë¥¼ ë¡œë”©.
    *   **Use Case**: "ì´ íŠ¹í—ˆì˜ í•µì‹¬ ê¸°ìˆ ì´ ë­ì•¼?", "ì²­êµ¬í•­ 1í•­ ë¶„ì„í•´ì¤˜"

3.  **PatentLegalTool (ê¶Œë¦¬/í–‰ì • ë¶„ì„ ë„êµ¬)**
    *   **ëª©ì **: íŠ¹í—ˆì˜ ë²•ì  ìœ íš¨ì„± ë° ê¶Œë¦¬ ìƒíƒœ í™•ì¸.
    *   **ê¸°ëŠ¥**: í˜„ì¬ ê¶Œë¦¬ ìƒíƒœ(ë“±ë¡/í¬ê¸°/ì†Œë©¸), ì¡´ì† ê¸°ê°„, ì‹¬ì‚¬ ì§„í–‰ ì´ë ¥, ë“±ë¡ë£Œ ë‚©ë¶€ í˜„í™© í™•ì¸.
    *   **Use Case**: "ì´ íŠ¹í—ˆ ì•„ì§ ìœ íš¨í•´?", "ë“±ë¡ëœ íŠ¹í—ˆì•¼ ê±°ì ˆëœ íŠ¹í—ˆì•¼?"

4.  **PatentCitationTool (ì¸ìš© ë¶„ì„ ë„êµ¬)** (Optional/Future)
    *   **ëª©ì **: ê¸°ìˆ ì˜ ì˜í–¥ë ¥ ë° ì›ì²œ ê¸°ìˆ  ì¶”ì .
    *   **ê¸°ëŠ¥**: ì¸ìš©(Forward)/í”¼ì¸ìš©(Backward) ê´€ê³„ ë¶„ì„.

### Layer 3: Agent Strategy (ì—ì´ì „íŠ¸ ìš´ìš© ì „ëµ)
ì—ì´ì „íŠ¸ëŠ” ì‚¬ìš©ìì˜ ìš”ì²­ì„ ë¶„ì„í•˜ì—¬ ìœ„ ë„êµ¬ë“¤ì„ ìˆœì°¨ì  ë˜ëŠ” ë³‘ë ¬ì ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.

*   **Scenario A: ê¸°ìˆ  ë™í–¥ ì¡°ì‚¬**
    *   User: "í˜„ëŒ€ì°¨ì˜ ìˆ˜ì†Œì „ì§€ ìµœê·¼ ë™í–¥ ì•Œë ¤ì¤˜"
    *   Agent: `PatentDiscoveryTool` í˜¸ì¶œ â†’ ë¦¬ìŠ¤íŠ¸ í™•ë³´ â†’ ì—°ë„ë³„/IPCë³„ í†µê³„ ë¶„ì„ â†’ ìš”ì•½ ë³´ê³ .
*   **Scenario B: íŠ¹ì • ê¸°ìˆ  ì‹¬ì¸µ ë¶„ì„**
    *   User: "ê³µê°œë²ˆí˜¸ 10-2024-0000000 íŠ¹í—ˆ ë¶„ì„í•´ì¤˜"
    *   Agent: `PatentDetailTool` í˜¸ì¶œ â†’ ì²­êµ¬í•­/ìš”ì•½ í™•ë³´ â†’ LLM ê¸°ìˆ  ë¶„ì„ ìˆ˜í–‰.
*   **Scenario C: FTO(ììœ ì‹¤ì‹œ) ê¸°ì´ˆ ì¡°ì‚¬**
    *   User: "ì´ ê¸°ìˆ  ìš°ë¦¬ê°€ ì¨ë„ ë˜ëŠ”ì§€ í™•ì¸í•´ì¤˜"
    *   Agent: `PatentDiscoveryTool`ë¡œ ìœ ì‚¬ íŠ¹í—ˆ ê²€ìƒ‰ â†’ `PatentLegalTool`ë¡œ ìœ íš¨ì„±(ì†Œë©¸ ì—¬ë¶€) í™•ì¸.

## 3. ë°ì´í„° ëª¨ë¸ ì„¤ê³„

### 3.1. PatentBasicInfo (Discovery ê²°ê³¼)
*   `patent_number`: ì¶œì›/ë“±ë¡ ë²ˆí˜¸
*   `title`: ë°œëª…ì˜ ëª…ì¹­
*   `applicant`: ì¶œì›ì¸
*   `application_date`: ì¶œì›ì¼
*   `status`: ìš”ì•½ ìƒíƒœ (ë“±ë¡/ê³µê°œ/ê±°ì ˆ ë“±)
*   `ipc_codes`: ëŒ€í‘œ IPC

### 3.2. PatentFullText (Detail ê²°ê³¼)
*   `claims`: ì²­êµ¬í•­ ë¦¬ìŠ¤íŠ¸
*   `description`: ìƒì„¸ ì„¤ëª…
*   `abstract`: ì´ˆë¡
*   `inventors`: ë°œëª…ì ì „ì²´
*   `drawings`: ë„ë©´ URL ë¦¬ìŠ¤íŠ¸

### 3.3. PatentLegalStatus (Legal ê²°ê³¼)
*   `current_status`: í˜„ì¬ ë²•ì  ìƒíƒœ (ë“±ë¡, í¬ê¸°, ì†Œë©¸, ê±°ì ˆ)
*   `registration_date`: ë“±ë¡ì¼
*   `expiration_date`: ì˜ˆìƒ ë§Œë£Œì¼
*   `history`: ì‹¬ì‚¬ ì´ë ¥ (ì¶œì›ì„œ ì œì¶œ -> ì˜ê²¬ì œì¶œí†µì§€ -> ë“±ë¡ê²°ì • ë“±)

## 4. êµ¬í˜„ ë¡œë“œë§µ

1.  **Phase 1: Client Refactoring**
    *   `backend/app/clients/kipris.py` ì‘ì„±
    *   KIPRIS API Key ê´€ë¦¬ ë° ì„¸ì…˜ ì²˜ë¦¬ ìµœì í™”
    *   ê° API ì—”ë“œí¬ì¸íŠ¸ë³„ ë©”ì„œë“œ êµ¬í˜„

2.  **Phase 2: Tool Implementation**
    *   `PatentDiscoveryTool`, `PatentDetailTool`, `PatentLegalTool` êµ¬í˜„
    *   LangChain BaseTool ìƒì† ë° ìŠ¤í‚¤ë§ˆ ì •ì˜

3.  **Phase 3: Agent Integration**
    *   `PatentAnalysisAgent`ê°€ ìƒˆë¡œìš´ íˆ´ë“¤ì„ ì‚¬ìš©í•˜ë„ë¡ ë¡œì§ ë³€ê²½
    *   LLM í”„ë¡¬í”„íŠ¸ ìµœì í™” (íˆ´ ì„ íƒ ê°€ì´ë“œ)

4.  **Phase 4: Testing & Verification**
    *   ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° ì‹œë‚˜ë¦¬ì˜¤ë³„ í†µí•© í…ŒìŠ¤íŠ¸

## 5. êµ¬í˜„ ê²°ê³¼ (Implementation Results - 2025.11.28)

ì„¤ê³„ì— ë”°ë¥¸ êµ¬í˜„ì´ ì™„ë£Œë˜ì—ˆìœ¼ë©°, ì£¼ìš” ë³€ê²½ ì‚¬í•­ê³¼ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

### 5.1. Layer 1: KIPRIS Client êµ¬í˜„ (`backend/app/clients/kipris.py`)
*   **ê¸°ëŠ¥ êµ¬í˜„**:
    *   `search_patents`: `getAdvancedSearch` APIë¥¼ ì‚¬ìš©í•˜ì—¬ ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„. `ipc_all` íŒŒì‹± ë° `customer_no` ì²˜ë¦¬ ë¡œì§ ì¶”ê°€.
    *   `search_applicant_code`: ì¶œì›ì¸ ëª…ì¹­ìœ¼ë¡œ íŠ¹í—ˆê³ ê°ë²ˆí˜¸ë¥¼ ì¡°íšŒí•˜ì—¬ ê²€ìƒ‰ ì •í™•ë„ë¥¼ ë†’ì´ëŠ” ë¡œì§ êµ¬í˜„.
    *   `get_biblio_detail`: `getBiblioDetailInfo` API ì—°ë™ (ì²­êµ¬í•­, ìƒì„¸ ì •ë³´ ì¡°íšŒìš©).
*   **ê°œì„  ì‚¬í•­ (2025.11.28 ì—…ë°ì´íŠ¸)**:
    *   **URL ì¸ì½”ë”© ìˆ˜ì •**: `aiohttp`ì™€ `urllib.parse.quote`ì˜ ì´ì¤‘ ì¸ì½”ë”© ë¬¸ì œ í•´ê²°. ê²€ìƒ‰ ì •í™•ë„ ëŒ€í­ í–¥ìƒ.
    *   **Total Count íŒŒì‹±**: XML ì‘ë‹µì—ì„œ `<totalCount>` í•„ë“œë¥¼ ì¶”ì¶œí•˜ì—¬ ì „ì²´ ê²€ìƒ‰ ê²°ê³¼ ìˆ˜ ì œê³µ ê¸°ëŠ¥ ì¶”ê°€.
    *   **ë°˜í™˜ íƒ€ì… ë³€ê²½**: `(List[PatentData], int)` íŠœí”Œì„ ë°˜í™˜í•˜ì—¬ ë°ì´í„°ì™€ ë©”íƒ€ë°ì´í„°(ì´ ê°œìˆ˜)ë¥¼ ë¶„ë¦¬ ì „ë‹¬.
    *   XML íŒŒì‹± ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”.
    *   API í‚¤ ëˆ„ë½ ì‹œ ì•ˆì „í•œ í´ë°± ì²˜ë¦¬.
    *   ì„œë¹„ìŠ¤ëª… ì˜¤íƒ€(`patUtiModInfoSearchSevice`) ìˆ˜ì • ë° ì ìš©.

### 5.2. Layer 2: Functional Tools êµ¬í˜„ (`backend/app/tools/retrieval/patent_functional_tools.py`)
*   **PatentDiscoveryTool**:
    *   ìƒíƒœ: **ì™„ë£Œ (Verified)**
    *   í…ŒìŠ¤íŠ¸ ê²°ê³¼: "ì¸ê³µì§€ëŠ¥ ì´ë¯¸ì§€ ìƒì„±" ì¿¼ë¦¬ë¡œ 8ê±´ì˜ ìœ íš¨í•œ íŠ¹í—ˆ ë°ì´í„° í™•ë³´ í™•ì¸. "ì‚¼ì„±ì „ì" ê²€ìƒ‰ ì‹œ 30ë§Œ ê±´ ì´ìƒì˜ Total Count ì •í™•íˆ ë°˜í™˜ í™•ì¸.
    *   **ë°˜í™˜ í¬ë§· ë³€ê²½**: ê¸°ì¡´ `List[Dict]`ì—ì„œ `Dict{'patents': List, 'total_count': int}` êµ¬ì¡°ë¡œ ë³€ê²½í•˜ì—¬ í†µê³„ ì •ë³´ ì „ë‹¬ ëŠ¥ë ¥ ê°•í™”.
    *   íŠ¹ì§•: ê²€ìƒ‰ ì†ë„ê°€ ë¹ ë¥´ë©°, ì‹œê°í™”ì— í•„ìš”í•œ í•µì‹¬ ë©”íƒ€ë°ì´í„°(ì¶œì›ì¸, ë‚ ì§œ, IPC ë“±)ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì œê³µ.
*   **PatentDetailTool**:
    *   ìƒíƒœ: **êµ¬í˜„ ì™„ë£Œ (Refinement Needed)**
    *   êµ¬ì¡°ëŠ” ì™„ì„±ë˜ì—ˆìœ¼ë‚˜, KIPRISì˜ ìƒì„¸ ì •ë³´ API ì—”ë“œí¬ì¸íŠ¸ íŠ¹ì„±ìƒ ì¼ë¶€ ë°ì´í„°(ì²­êµ¬í•­ ë“±)ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš°ê°€ ìˆì–´ ì¶”ê°€ íŠœë‹ í•„ìš”.
*   **PatentLegalTool**:
    *   ìƒíƒœ: **êµ¬í˜„ ì™„ë£Œ (Refinement Needed)**
    *   ê¸°ë³¸ ê³¨ê²© êµ¬í˜„ ì™„ë£Œ. í–‰ì • ì •ë³´ API ì—°ë™ ìµœì í™” í•„ìš”.

### 5.3. Layer 3: Agent Integration (`backend/app/agents/patent/patent_analysis_agent.py`)
*   **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ë¡œì§ ì ìš©**:
    *   **KR (í•œêµ­)**: ìƒˆë¡œ êµ¬í˜„ëœ `PatentDiscoveryTool`ì„ ì‚¬ìš©í•˜ì—¬ KIPRIS ì§ì ‘ ì—°ë™. ë°ì´í„° ì •í•©ì„± ë° ìµœì‹ ì„± í™•ë³´.
    *   **Global (ë¯¸êµ­/ìœ ëŸ½ ë“±)**: ê¸°ì¡´ `PatentSearchTool` (SerpAPI)ì„ ì‚¬ìš©í•˜ì—¬ ê¸€ë¡œë²Œ ì»¤ë²„ë¦¬ì§€ ìœ ì§€.
*   **ë°ì´í„° ë§¤í•‘ ë° í†µê³„ ì²˜ë¦¬**:
    *   `_map_discovery_to_patent_data` ë©”ì„œë“œë¥¼ í†µí•´ Layer 2ì˜ ê²°ê³¼ë¥¼ ê¸°ì¡´ ì—ì´ì „íŠ¸ íŒŒì´í”„ë¼ì¸ê³¼ í˜¸í™˜ë˜ë„ë¡ ë³€í™˜.
    *   **Total Count í†µí•©**: `PatentDiscoveryTool`ì´ ë°˜í™˜í•˜ëŠ” `total_count`ë¥¼ ì—ì´ì „íŠ¸ ìµœì¢… ê²°ê³¼(`total_patents`)ì— ë°˜ì˜í•˜ì—¬, ì‹¤ì œ ê²€ìƒ‰ëœ(retrieved) ê°œìˆ˜ë³´ë‹¤ ë” ì •í™•í•œ ì „ì²´ ëª¨ì§‘ë‹¨ ê·œëª¨ë¥¼ ì‚¬ìš©ìì—ê²Œ ì œê³µ.
*   **ê²€ì¦**:
    *   í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸(`test_patent_tools.py`)ë¥¼ í†µí•´ ëª¨ë“ˆ ë™ì‘ í™•ì¸ ì™„ë£Œ.
    *   "ì‚¼ì„±ì „ì" í‚¤ì›Œë“œ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ê²€ìƒ‰ ê²°ê³¼ ë° ì´ ê±´ìˆ˜(30ë§Œ+ ê±´) ì •ìƒ ì¶œë ¥ í™•ì¸.

### 5.4. íŠ¹í—ˆ ìˆ˜ì§‘ ê´€ë¦¬ ì‹œìŠ¤í…œ ê³ ë„í™” (2025-12-24)

#### ë°°ê²½ ë° ë¬¸ì œì 
ê¸°ì¡´ íŠ¹í—ˆ ìˆ˜ì§‘ ì‹œìŠ¤í…œì€ Celery ë¹„ë™ê¸° ì‘ì—…ìœ¼ë¡œ KIPRIS ê²€ìƒ‰ ë° ë°ì´í„° ì €ì¥ì„ ìˆ˜í–‰í–ˆìœ¼ë‚˜, ì‚¬ìš©ì í”¼ë“œë°±ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ UX ë¬¸ì œê°€ ë°œê²¬ë˜ì—ˆë‹¤:

1. **ìƒíƒœ ëª¨í˜¸ì„±**: ìˆ˜ì§‘ ì™„ë£Œ ì‹œ "completed" ìƒíƒœë§Œ í‘œì‹œë˜ì–´, 0ê±´ ìˆ˜ì§‘ì´ ì‹¤íŒ¨ì¸ì§€ ê²€ìƒ‰ ì¡°ê±´ ë¬¸ì œì¸ì§€ êµ¬ë¶„ ë¶ˆê°€
2. **ê²°ê³¼ ì¶”ì  ë¶€ì¬**: ê° ì„¤ì •ì˜ ë§ˆì§€ë§‰ ì‹¤í–‰ ì´ë ¥ì„ í™•ì¸í•  ë°©ë²• ì—†ìŒ
3. **í”¼ë“œë°± ë¶€ì¡±**: ì§„í–‰ ì¤‘/ì„±ê³µ/ì‹¤íŒ¨ ìƒíƒœ êµ¬ë¶„ì´ ì‹œê°ì ìœ¼ë¡œ ëª…í™•í•˜ì§€ ì•ŠìŒ

#### ê°œì„  êµ¬í˜„ ì‚¬í•­

**1) ëª…í™•í•œ 4ë‹¨ê³„ ìƒíƒœ ê´€ë¦¬**

`TbPatentCollectionTasks.status` í•„ë“œ í™œìš©:
- `pending`: Celery ì‘ì—… ëŒ€ê¸° ì¤‘
- `running`: KIPRIS API í˜¸ì¶œ ë° DB ì €ì¥ ì§„í–‰ ì¤‘
- `completed`: ì •ìƒ ì™„ë£Œ (0ê±´ í¬í•¨)
- `failed`: ì˜ˆì™¸ ë°œìƒìœ¼ë¡œ ì¸í•œ ì‹¤íŒ¨

**2) ìƒíƒœë³„ ì‚¬ìš©ì ë©”ì‹œì§€ ìë™ ìƒì„±**

í”„ë¡ íŠ¸ì—”ë“œ `pollTask()` í•¨ìˆ˜ê°€ ë°±ì—”ë“œ ìƒíƒœë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì ì ˆí•œ ë©”ì‹œì§€ ìƒì„±:

```typescript
interface TaskStatus {
  status: 'pending' | 'running' | 'completed' | 'failed';
  message?: string;  // ìë™ ìƒì„±ëœ ì‚¬ìš©ì ë©”ì‹œì§€
  completedAt?: string;  // ì™„ë£Œ ì‹œê°
  collected: number;
  errors: number;
}

// ë©”ì‹œì§€ ìƒì„± ë¡œì§
if (status === 'completed') {
  if (collected === 0) {
    message = 'âš ï¸ ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” íŠ¹í—ˆê°€ ì—†ìŠµë‹ˆë‹¤. ê²€ìƒ‰ ì¡°ê±´ì„ ì¡°ì •í•´ë³´ì„¸ìš”.';
  } else {
    message = `âœ… ìˆ˜ì§‘ ì™„ë£Œ: ${collected}ê±´ ì„±ê³µ${errors > 0 ? `, ${errors}ê±´ ì‹¤íŒ¨` : ''}`;
  }
}
```

**3) ë§ˆì§€ë§‰ ìˆ˜ì§‘ ê²°ê³¼ ì˜ì†í™”**

ìŠ¤í‚¤ë§ˆ í™•ì¥ (`TbPatentCollectionSettings`):
```python
last_collection_date = Column(DateTime(timezone=True), nullable=True)
last_collection_result = Column(JSONB, nullable=True)
# í˜•ì‹: {"collected": 25, "errors": 2}
```

ì‘ì—… ì™„ë£Œ ì‹œ ìë™ ì—…ë°ì´íŠ¸ (`PatentCollectionService.update_task_progress()`):
```python
if status == "completed":
    await self.session.execute(
        update(TbPatentCollectionSettings)
        .where(TbPatentCollectionSettings.setting_id == task.setting_id)
        .values(
            last_collection_date=datetime.utcnow(),
            last_collection_result={"collected": collected_count, "errors": error_count}
        )
    )
```

**4) UI/UX ì‹œê°í™” ê°œì„ **

- **ìƒ‰ìƒ êµ¬ë¶„**: ìƒíƒœë³„ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ìë™ ì ìš©
  - ğŸ”µ íŒŒë€ìƒ‰ (`text-blue-700`): ì‹¤í–‰ ì¤‘
  - ğŸŸ¡ ë…¸ë€ìƒ‰ (`text-yellow-700`): 0ê±´ ìˆ˜ì§‘ (ì£¼ì˜)
  - ğŸŸ¢ ë…¹ìƒ‰ (`text-green-700`): ì„±ê³µ (ê±´ìˆ˜ > 0)
  - ğŸ”´ ë¹¨ê°„ìƒ‰ (`text-red-700`): ì‹¤íŒ¨

- **ì¡°ê±´ë¶€ ë Œë”ë§**:
  - ì§„í–‰ ì¤‘ì¼ ë•Œë§Œ í”„ë¡œê·¸ë ˆìŠ¤ ë°” í‘œì‹œ
  - ì™„ë£Œ ì‹œ ê²°ê³¼ ìš”ì•½ ë°•ìŠ¤ 5ì´ˆê°„ í‘œì‹œ í›„ ìë™ ì œê±°
  - ë¹„í™œì„± ìƒíƒœì¼ ë•Œ ë§ˆì§€ë§‰ ìˆ˜ì§‘ ì •ë³´ ì¹´ë“œ í‘œì‹œ

**5) êµ¬í˜„ íŒŒì¼ ëª©ë¡**

| ê³„ì¸µ | íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| Model | `backend/app/models/patent/collection_models.py` | `last_collection_result` JSONB ì»¬ëŸ¼ ì¶”ê°€ |
| Service | `backend/app/services/patent/collection_service.py` | `update_task_progress()`ì—ì„œ completed ì‹œ ì„¤ì • ì—…ë°ì´íŠ¸ |
| API | `backend/app/api/v1/patent_collection.py` | `PatentCollectionSettingResponse`ì— í•„ë“œ ì¶”ê°€ |
| Migration | `backend/alembic/versions/20251224_add_last_collection_result.py` | ìŠ¤í‚¤ë§ˆ ë³€ê²½ ë§ˆì´ê·¸ë ˆì´ì…˜ |
| Frontend | `frontend/src/pages/user/PatentCollectionSettings.tsx` | `pollTask()` ë¡œì§ ê°œì„ , UI ì»´í¬ë„ŒíŠ¸ ë¦¬íŒ©í† ë§ |

**6) ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤**

*ì‹œë‚˜ë¦¬ì˜¤ A: ì •ìƒ ìˆ˜ì§‘*
1. ì‚¬ìš©ìê°€ "ìˆ˜ì§‘ ì‹œì‘" í´ë¦­
2. "ğŸš€ ìˆ˜ì§‘ ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤..." (pending)
3. "ğŸ”„ ìˆ˜ì§‘ ì¤‘... (15/100)" + í”„ë¡œê·¸ë ˆìŠ¤ ë°” (running)
4. "âœ… ìˆ˜ì§‘ ì™„ë£Œ: 25ê±´ ì„±ê³µ" (completed, ë…¹ìƒ‰)
5. 5ì´ˆ í›„ ìë™ ì œê±° â†’ "ë§ˆì§€ë§‰ ìˆ˜ì§‘: 2025-12-24 10:30 / 25ê±´ ìˆ˜ì§‘"

*ì‹œë‚˜ë¦¬ì˜¤ B: 0ê±´ ìˆ˜ì§‘ (ê²€ìƒ‰ ì¡°ê±´ ë¬¸ì œ)*
1. ë™ì¼ íë¦„
2. "âš ï¸ ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” íŠ¹í—ˆê°€ ì—†ìŠµë‹ˆë‹¤. ê²€ìƒ‰ ì¡°ê±´ì„ ì¡°ì •í•´ë³´ì„¸ìš”." (completed, ë…¸ë€ìƒ‰)
3. ì‚¬ìš©ìëŠ” ì‹¤íŒ¨ê°€ ì•„ë‹ˆë¼ ì¡°ê±´ ì¬ê²€í† ê°€ í•„ìš”í•¨ì„ ëª…í™•íˆ ì¸ì§€

*ì‹œë‚˜ë¦¬ì˜¤ C: ì‘ì—… ì‹¤íŒ¨*
1. KIPRIS API ì˜¤ë¥˜ ë˜ëŠ” DB ì €ì¥ ì˜ˆì™¸ ë°œìƒ
2. "âŒ ìˆ˜ì§‘ ì‘ì—…ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤" (failed, ë¹¨ê°„ìƒ‰)
3. ë°±ì—”ë“œ ë¡œê·¸ì— ìƒì„¸ ì˜¤ë¥˜ ê¸°ë¡

#### ì„±ê³¼ ë° íš¨ê³¼

- **ì‚¬ìš©ì í˜¼ë€ í•´ì†Œ**: 0ê±´ ìˆ˜ì§‘ê³¼ ì‹¤íŒ¨ë¥¼ ëª…í™•íˆ êµ¬ë¶„
- **ìš´ì˜ íš¨ìœ¨ì„±**: ê° ì„¤ì •ì˜ ì‹¤í–‰ ì´ë ¥ìœ¼ë¡œ í™œìš©ë„ íŒŒì•… ê°€ëŠ¥
- **ìê°€ ì§„ë‹¨ ê°€ëŠ¥**: 0ê±´ ì‹œ ìë™ ì•ˆë‚´ ë©”ì‹œì§€ë¡œ ì‚¬ìš©ì ìŠ¤ìŠ¤ë¡œ ì¡°ê±´ ì¡°ì •
- **UI ì¼ê´€ì„±**: ìƒíƒœë³„ ìƒ‰ìƒ ë° ì•„ì´ì½˜ìœ¼ë¡œ ì‹œê°ì  ê°€ë…ì„± í–¥ìƒ

## 6. í–¥í›„ ê³ ë„í™” ê³„íš (Future Improvements)

### 6.1. ë°ì´í„° ê¹Šì´ í™•ë³´ (Deep Dive)
*   **ì „ë¬¸(Full Text) í™•ë³´**: í˜„ì¬ ì„œì§€ ì •ë³´ ìœ„ì£¼ì˜ ë°ì´í„°ë¥¼ ë„˜ì–´, `PatentDetailTool`ì´ ì²­êµ¬í•­ ì „ë¬¸ê³¼ ìƒì„¸ ì„¤ëª…ì„ ì™„ë²½í•˜ê²Œ ê°€ì ¸ì˜¤ë„ë¡ KIPRISì˜ `getFullTextInfo` ë“± ì¶”ê°€ API ë°œêµ´ ë° ì—°ë™.
*   **ë²•ì  ìƒíƒœ ìƒì„¸í™”**: ë‹¨ìˆœ ë“±ë¡/ê±°ì ˆ ìƒíƒœë¥¼ ë„˜ì–´, ì‹¬ì‚¬ ì§„í–‰ ë‹¨ê³„(ì˜ê²¬ì œì¶œí†µì§€, ë³´ì •ì„œ ì œì¶œ ë“±)ë¥¼ íƒ€ì„ë¼ì¸ìœ¼ë¡œ ì‹œê°í™”í•  ìˆ˜ ìˆë„ë¡ `PatentLegalTool` ê³ ë„í™”.

### 6.2. ì—ì´ì „íŠ¸ ì§€ëŠ¥í™”
*   **ìë™ ì‹¬ì¸µ ë¶„ì„**: ê²€ìƒ‰ ê²°ê³¼ ì¤‘ ì‚¬ìš©ìê°€ ê´€ì‹¬ì„ ë³´ì¼ë§Œí•œ í•µì‹¬ íŠ¹í—ˆ(Top 3)ì— ëŒ€í•´ì„œëŠ” ì—ì´ì „íŠ¸ê°€ ìŠ¤ìŠ¤ë¡œ `PatentDetailTool`ì„ í˜¸ì¶œí•˜ì—¬ ìš”ì•½ ì •ë³´ë¥¼ ë¯¸ë¦¬ ìƒì„±í•˜ëŠ” ë¡œì§ ì¶”ê°€.
*   **FTO(ììœ ì‹¤ì‹œ) ë¶„ì„ ìë™í™”**: ì²­êµ¬í•­ ë¹„êµ ë¶„ì„ ê¸°ëŠ¥ì„ ì—ì´ì „íŠ¸ ìŠ¤í‚¬ë¡œ ë‚´ì¬í™”.

### 6.3. ì‹œê°í™” ê³ ë„í™”
*   **IPC ë„¤íŠ¸ì›Œí¬ ë§µ**: `ipc_all` ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ê¸°ìˆ  ê°„ì˜ ìœµí•© ê´€ê³„ë¥¼ ë³´ì—¬ì£¼ëŠ” ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ ì¶”ê°€.
*   **ì¶œì›ì¸-ê¸°ìˆ  ë§¤íŠ¸ë¦­ìŠ¤**: ê²½ìŸì‚¬ë“¤ì´ ì–´ë–¤ ê¸°ìˆ  ë¶„ì•¼ì— ì§‘ì¤‘í•˜ê³  ìˆëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” íˆíŠ¸ë§µ ìƒì„±.

## 7. ì„ í–‰ê¸°ìˆ ì¡°ì‚¬ Agentic AI ì„¤ê³„ (Prior Art Search with ReAct)

ë³¸ ì„¹ì…˜ì€ â€œíŠ¹í—ˆ ë¬¸ì„œ â†’ ì„œì§€/í•µì‹¬ìš”ì†Œ ì¶”ì¶œ â†’ KIPRIS ì…ë ¥ê°’ ìë™ êµ¬ì„± â†’ ReAct ë°˜ë³µ ê²€ìƒ‰/ì •ì œ â†’ ì„ í–‰ê¸°ìˆ ì¡°ì‚¬ë³´ê³ ì„œ ìƒì„±â€ í”Œë¡œìš°ë¥¼ ì œí’ˆ ì½”ë“œì— ì—°ê²°í•˜ê¸° ìœ„í•œ êµ¬ì²´ ì„¤ê³„ì´ë‹¤.

### 7.1. ëª©í‘œ / ë¹„ëª©í‘œ
*   **ëª©í‘œ**:
    *   íŠ¹í—ˆ ëª…ì„¸ì„œ(ë˜ëŠ” ì•„ì´ë””ì–´ ë¬¸ì„œ) 1ê±´ì„ ì…ë ¥ìœ¼ë¡œ ë°›ì•„, KIPRIS(ìš°ì„ ) ê¸°ë°˜ì˜ ì¬í˜„ ê°€ëŠ¥í•œ ê²€ìƒ‰ ì „ëµì„ ìˆ˜ë¦½í•˜ê³  ë°˜ë³µ ê°œì„ í•˜ì—¬ ì„ í–‰ê¸°ìˆ  í›„ë³´ë¥¼ ìˆ˜ì§‘í•œë‹¤.
    *   í›„ë³´ íŠ¹í—ˆì˜ í•µì‹¬ ìœ ì‚¬ì /ì°¨ì´ì  ë° ë²•ì  ìƒíƒœë¥¼ ìš”ì•½í•˜ì—¬ â€œì„ í–‰ê¸°ìˆ ì¡°ì‚¬ë³´ê³ ì„œâ€ í…œí”Œë¦¿ìœ¼ë¡œ ì¶œë ¥í•œë‹¤.
    *   êµ¬ì¡°ì ìœ¼ë¡œëŠ” Provider Adapter íŒ¨í„´ì„ ìœ ì§€í•˜ì—¬, ì¶”í›„ USPTO/Google Patents ë“±ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ í™•ì¥í•œë‹¤.
*   **ë¹„ëª©í‘œ(ì´ˆê¸° ë²„ì „)**:
    *   ë²•ë¥ ì  íŒë‹¨ì„ ëŒ€ì²´í•˜ëŠ” FTO/ë¬´íš¨ê°€ëŠ¥ì„±ì— ëŒ€í•œ í™•ì • ê²°ë¡  ì œê³µ.
    *   ëª¨ë“  êµ­ê°€/ì–¸ì–´ë¥¼ ë™ì¼ í’ˆì§ˆë¡œ ì»¤ë²„(ìš°ì„ ìˆœìœ„ëŠ” KR(KIPRIS) â†’ Global í™•ì¥).

### 7.2. ì…ë ¥/ì¶œë ¥ ì •ì˜
*   **ì…ë ¥(í˜„ì¬)**:
    *   íŠ¹í—ˆ ë¬¸ì„œ íŒŒì¼(PDF/DOCX) ë˜ëŠ” ì¶”ì¶œëœ í…ìŠ¤íŠ¸
*   **ì…ë ¥(í™•ì¥)**:
    *   URL ë§í¬(ì˜ˆ: KIPRIS ìƒì„¸ í˜ì´ì§€, ê³µê°œ/ë“±ë¡ ê³µë³´ URL) ê¸°ë°˜ ìˆ˜ì§‘
*   **ì¶œë ¥**:
    *   ì„ í–‰ê¸°ìˆ ì¡°ì‚¬ë³´ê³ ì„œ(êµ¬ì¡°í™” JSON + Markdown/HTML ë Œë”)
    *   ì¬í˜„ ê°€ëŠ¥í•œ ê²€ìƒ‰ ë¡œê·¸(ê²€ìƒ‰ì‹, í•„í„°, ë°˜ë³µ ë‹¨ê³„ë³„ ì˜ì‚¬ê²°ì •)

### 7.3. ì „ì²´ ì²˜ë¦¬ íë¦„ (End-to-End)
1) **ë¬¸ì„œ ì´í•´(Extraction)**
    *   ì…ë ¥ ë¬¸ì„œì—ì„œ ì•„ë˜ ì •ë³´ë¥¼ ì¶”ì¶œí•˜ê³  ì •ê·œí™”í•œë‹¤.
        *   ì„œì§€: ë°œëª…ì˜ ëª…ì¹­, ì¶œì›ì¸/ë°œëª…ì, ì¶œì›/ê³µê°œ/ë“±ë¡ ë²ˆí˜¸(ê°€ëŠ¥ ì‹œ), ì¶œì›ì¼/ê³µê°œì¼/ìš°ì„ ê¶Œ, êµ­ê°€
        *   ê¸°ìˆ ìš”ì•½: ìš”ì•½(abstract), í•´ê²° ê³¼ì œ, í•µì‹¬ êµ¬ì„±ìš”ì†Œ, ì£¼ìš” íš¨ê³¼
        *   ì²­êµ¬í•­: ë…ë¦½í•­ ìš°ì„ (1í•­ ë“±) + ì¢…ì†í•­ì€ ìš”ì•½ ìˆ˜ì¤€
        *   ë¶„ë¥˜: IPC/CPC(ê°€ëŠ¥ ì‹œ), í‚¤ì›Œë“œ
    *   ì‚°ì¶œë¬¼: `TargetPatentSpec` (êµ¬ì¡°í™” ê°ì²´)

2) **KIPRIS ê²€ìƒ‰ ì…ë ¥ê°’ ìë™ êµ¬ì„±(Query Synthesis)**
    *   `TargetPatentSpec` â†’ KIPRIS Advanced Searchì— íˆ¬ì… ê°€ëŠ¥í•œ â€œê²€ìƒ‰ì‹ í›„ë³´êµ°â€ì„ ìƒì„±í•œë‹¤.
    *   ìƒì„± ì „ëµ(ì˜ˆì‹œ):
        *   (A) ì œëª©/ìš”ì•½ í‚¤ì›Œë“œ ê¸°ë°˜ OR ë¬¶ìŒ + í•µì‹¬ êµ¬ì„±ìš”ì†Œ(í•„ìˆ˜ì–´) AND
        *   (B) IPC/CPC ê¸°ë°˜ í•„í„° + í‚¤ì›Œë“œ ë³´ê°•
        *   (C) ì¶œì›ì¸/ë°œëª…ì ì‹œë“œ(ê³¼ë„í•œ í¸í–¥ ë°©ì§€ë¥¼ ìœ„í•´ ë‚®ì€ ê°€ì¤‘ì¹˜)
        *   (D) ì²­êµ¬í•­ ë…ë¦½í•­ì—ì„œ ì¶”ì¶œí•œ ê¸°ëŠ¥/êµ¬ì„±ìš”ì†Œ ê¸°ë°˜ ì¡°í•©
    *   ì‚°ì¶œë¬¼: `SearchPlan` (query_variants, í•„í„°, ê°€ë“œë ˆì¼)

3) **ReAct ë°˜ë³µ ê²€ìƒ‰/ì •ì œ(Agent Loop)**
    *   ì—ì´ì „íŠ¸ëŠ” â€œí˜„ì¬ ê²€ìƒ‰ì‹ìœ¼ë¡œ ì¶©ë¶„í•œ ì»¤ë²„ë¦¬ì§€ê°€ í™•ë³´ë˜ì—ˆëŠ”ê°€?â€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°˜ë³µ ìˆ˜í–‰í•œë‹¤.
    *   ê° ë°˜ë³µ ë‹¨ê³„(Iteration)ì—ì„œ ìˆ˜í–‰ ê°€ëŠ¥í•œ í–‰ë™(Action) ì˜ˆì‹œ:
        *   `PatentDiscoveryTool`ë¡œ ê²€ìƒ‰ ì‹¤í–‰(í•„ìš” ì‹œ ì—¬ëŸ¬ query variantë¥¼ ìˆœì°¨ ì‹¤í–‰)
        *   ê²°ê³¼ì˜ ìƒìœ„ Nê±´ì„ ìƒ˜í”Œë§í•´ ìš”ì•½/í‚¤ì›Œë“œ/IPCë¥¼ ê´€ì°°í•˜ê³ , ê²€ìƒ‰ì‹ì˜ ëˆ„ë½/ê³¼ì‰ì„ ì§„ë‹¨
        *   ê²€ìƒ‰ì‹ ìˆ˜ì •(ë™ì˜ì–´ ì¶”ê°€, í•„ìˆ˜ì–´/ì œì™¸ì–´ ì¡°ì •, IPC í™•ì¥/ì¶•ì†Œ)
        *   ì¤‘ë³µ ì œê±°/í´ëŸ¬ìŠ¤í„°ë§ìœ¼ë¡œ í›„ë³´êµ°ì˜ ë‹¤ì–‘ì„± í™•ë³´
    *   ì¢…ë£Œ ì¡°ê±´(ì´ˆê¸° ê¶Œì¥):
        *   ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜/ì‹œê°„ ì œí•œ
        *   ìœ íš¨ í›„ë³´(Top-K)ì—ì„œ ì‹ ê·œ ì •ë³´(ìƒˆ IPC/ìƒˆ í‚¤ì›Œë“œ/ìƒˆ íŒ¨ë°€ë¦¬)ê°€ ë” ì´ìƒ ì¦ê°€í•˜ì§€ ì•Šì„ ë•Œ

4) **ìƒì„¸/ë²•ì  ìƒíƒœ ë³´ê°•(Enrichment)**
    *   ìµœì¢… í›„ë³´ Top-Kì— ëŒ€í•´:
        *   `PatentDetailTool`: ì„œì§€/ìš”ì•½/ì²­êµ¬í•­/ìƒì„¸ì„¤ëª…(ê°€ëŠ¥ ë²”ìœ„) í™•ë³´
        *   `PatentLegalTool`: ë²•ì  ìƒíƒœ/ê¶Œë¦¬ ì¡´ì†/ì´ë ¥ ìš”ì•½
    *   ì‚°ì¶œë¬¼: `CandidatePatent[]` (ì›ë¬¸/ìš”ì•½/ë²•ì ìƒíƒœ í¬í•¨)

5) **ìœ ì‚¬ë„ ë° ê·¼ê±° ì‘ì„±(Scoring & Evidence)**
    *   ìœ ì‚¬ë„ëŠ” ë‹¨ì¼ ìˆ˜ì¹˜ë¡œ ê³ ì •í•˜ì§€ ì•Šê³ , â€œê·¼ê±° ì¤‘ì‹¬â€ìœ¼ë¡œ êµ¬ì„±í•œë‹¤.
        *   í…ìŠ¤íŠ¸ ìœ ì‚¬ë„(ìš”ì•½/ì²­êµ¬í•­ ê¸°ë°˜)
        *   êµ¬ì„±ìš”ì†Œ ë§¤ì¹­(í•µì‹¬ êµ¬ì„±ìš”ì†Œê°€ í›„ë³´ì— ì¡´ì¬í•˜ëŠ”ì§€)
        *   ë¶„ë¥˜/í‚¤ì›Œë“œ ì¼ì¹˜ë„(IPC/CPC)
    *   ì‚°ì¶œë¬¼: `Comparison[]` (ìœ ì‚¬ì /ì°¨ì´ì , ë¦¬ìŠ¤í¬ í¬ì¸íŠ¸, ê·¼ê±° ì¸ìš©)

6) **ë³´ê³ ì„œ í…œí”Œë¦¿ ìƒì„±(Reporting)**
    *   ë³´ê³ ì„œ ì„¹ì…˜(ê¶Œì¥):
        *   ì¡°ì‚¬ ëª©ì /ë²”ìœ„
        *   ì…ë ¥ ë¬¸ì„œ ìš”ì•½(ì„œì§€ + í•µì‹¬ìš”ì†Œ)
        *   ê²€ìƒ‰ ì „ëµ(ë°˜ë³µ ë‹¨ê³„ë³„ ê²€ìƒ‰ì‹/í•„í„°/ì˜ì‚¬ê²°ì • ë¡œê·¸)
        *   ê²€ìƒ‰ ê²°ê³¼ ìš”ì•½(Top-K í›„ë³´ ë¦¬ìŠ¤íŠ¸)
        *   í›„ë³´ë³„ ìƒì„¸ ë¹„êµ(í•µì‹¬ ìœ ì‚¬ì /ì°¨ì´ì /ë²•ì ìƒíƒœ)
        *   ê²°ë¡ (ì´ˆê¸° ê´€ì°°/ì¶”ê°€ ì¡°ì‚¬ ê¶Œê³ ; ë²•ë¥  ìë¬¸ ì•„ë‹˜ ëª…ì‹œ)

### 7.4. ë°ì´í„° ëª¨ë¸(ì´ˆì•ˆ)
*   `TargetPatentSpec`
    *   `title`, `abstract`, `claims_independent[]`, `applicants[]`, `inventors[]`, `ipc[]`, `cpc[]`, `country`, `dates{}`
    *   `core_components[]`, `core_effects[]`, `keywords[]`
*   `SearchPlan`
    *   `query_variants[]`, `filters{ipc/cpc/date/country}`, `stop_conditions{}`
    *   `guardrails{max_iterations,max_results_per_query,rate_limit}`
*   `SearchIteration`
    *   `query_used`, `result_stats{total_count,retrieved}`, `observations[]`, `refinement_decision`
*   `CandidatePatent`
    *   `publication_number`, `title`, `abstract`, `ipc[]`, `assignee`, `url`, `legal_status{}`
    *   `evidence{matched_components[],key_snippets[]}`
*   `PriorArtReport`
    *   `target: TargetPatentSpec`, `iterations[]`, `candidates[]`, `comparisons[]`, `recommendations[]`

### 7.5. ê¸°ì¡´ ì½”ë“œì™€ì˜ ì—°ê²° í¬ì¸íŠ¸(ê¶Œì¥)
*   **ReAct ë£¨í”„ êµ¬í˜„ ê¸°ë°˜**: `backend/app/agents/patent/patent_analysis_agent_v2.py`
    *   ê¸°ì¡´ LangGraph ReAct ìŠ¤íƒ€ì¼ì„ ìœ ì§€í•˜ë˜, â€œì„ í–‰ê¸°ìˆ ì¡°ì‚¬â€ì— ë§ëŠ” ìƒíƒœ(`TargetPatentSpec`, `SearchPlan`, `SearchIteration`)ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©í–¥ì´ ì•ˆì „í•˜ë‹¤.
*   **ë„êµ¬ ê³„ì¸µ ì¬ì‚¬ìš©**: `backend/app/tools/retrieval/patent_functional_tools.py`
    *   Discovery/Detail/Legal 3ì¢… ë„êµ¬ë¥¼ â€œìˆ˜ì§‘/ë³´ê°•â€ ë‹¨ê³„ì— ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤.
*   **Provider Adapter í™•ì¥(USPTO)**:
    *   Layer 1ì— `USPTOClient`(ë˜ëŠ” `uspto.py`)ë¥¼ ì¶”ê°€í•˜ê³ , Discovery/Detail/Legalì˜ ë™ì¼ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•œë‹¤.
    *   Layer 2/3ëŠ” Providerê°€ ë°”ë€Œì–´ë„ ë™ì¼í•œ `CandidatePatent` ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë§¤í•‘ ê³„ì¸µì„ ë‘”ë‹¤.

### 7.6. ìš´ì˜/í’ˆì§ˆ ê°€ë“œë ˆì¼
*   **ì¬í˜„ì„±**: ë³´ê³ ì„œì— â€œê²€ìƒ‰ì‹/í•„í„°/ë°˜ë³µ ë¡œê·¸â€ë¥¼ ë°˜ë“œì‹œ í¬í•¨í•œë‹¤.
*   **ë¹„ìš©/ì†ë„**: ë°˜ë³µ íšŸìˆ˜, ìƒì„¸ ì¡°íšŒ Top-K, ë ˆì´íŠ¸ë¦¬ë°‹ì„ ê¸°ë³¸ ì œí•œìœ¼ë¡œ ë‘”ë‹¤.
*   **ì‹ ë¢°ì„±**: KIPRIS ì¥ì• /ì‘ë‹µ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ëŒ€ë¹„(ì—ëŸ¬ ë¶„ë¥˜, ì¬ì‹œë„, ë¶€ë¶„ ê²°ê³¼ ë°˜í™˜).
*   **ì»´í”Œë¼ì´ì–¸ìŠ¤**: ê²°ê³¼ëŠ” ì°¸ê³ ìš©ì´ë©° ë²•ë¥  ìë¬¸ì´ ì•„ë‹˜ì„ í…œí”Œë¦¿ì— ëª…ì‹œí•œë‹¤.
---

## 8. íŠ¹í—ˆ ì •ë³´ ìë™ ìˆ˜ì§‘ ì‹œìŠ¤í…œ (Patent Auto-Collection System)

> **ìµœì´ˆ êµ¬í˜„**: 2025-12-22  
> **ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ë°°í¬ ì™„ë£Œ  
> **í†µí•©**: KIPRIS API + Celery + S3 + Vector Search

### 8.1. ì‹œìŠ¤í…œ ê°œìš”

KIPRIS APIë¥¼ í†µí•œ íŠ¹í—ˆ ìë™ ìˆ˜ì§‘ ì‹œìŠ¤í…œìœ¼ë¡œ, ì‚¬ìš©ìê°€ UIì—ì„œ ê²€ìƒ‰ ì¡°ê±´ì„ ì„¤ì •í•˜ë©´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ íŠ¹í—ˆë¥¼ ìˆ˜ì§‘í•˜ê³  ë²¡í„° ê²€ìƒ‰ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ì €ì¥í•©ë‹ˆë‹¤.

#### 8.1.1. ì£¼ìš” ê¸°ëŠ¥
- **ìë™ ìˆ˜ì§‘**: í‚¤ì›Œë“œ, IPC ì½”ë“œ, ì¶œì›ì¸ ê¸°ë°˜ KIPRIS ê²€ìƒ‰
- **ìŠ¤ì¼€ì¤„ë§**: ìˆ˜ë™/ì¼ê°„/ì£¼ê°„/ì›”ê°„ ìë™ ìˆ˜ì§‘
- **PDF ê´€ë¦¬**: KIPRIS PDF ìë™ ë‹¤ìš´ë¡œë“œ ë° S3 ì €ì¥
- **ë²¡í„° ê²€ìƒ‰**: ì„ë² ë”© ìë™ ìƒì„±ìœ¼ë¡œ ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ ì§€ì›
- **ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§**: Celery ì‘ì—… ì§„í–‰ë¥  ì‹¤ì‹œê°„ í™•ì¸

#### 8.1.2. ë°ì´í„° íë¦„
```
[Frontend] ìˆ˜ì§‘ ì„¤ì • ìƒì„±
    â†“
[Backend API] ì„¤ì • ì €ì¥ + Celery ì‘ì—… dispatch
    â†“
[Celery Worker] KIPRIS ê²€ìƒ‰
    â†“
[ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸]
    â”œâ”€ PostgreSQL ì €ì¥ (TbPatentBibliographicInfo)
    â”œâ”€ PDF ë‹¤ìš´ë¡œë“œ â†’ S3 ì—…ë¡œë“œ
    â”œâ”€ ì„ë² ë”© ìƒì„± (Bedrock/Azure)
    â””â”€ ë²¡í„° ì¸ë±ì‹± (pgvector)
    â†“
[ì§€ì‹ ì»¨í…Œì´ë„ˆ] íŠ¹í—ˆ ë¬¸ì„œ í‘œì‹œ + ê²€ìƒ‰ ê°€ëŠ¥
```

### 8.2. UI ì„¤ê³„

#### 8.2.1. ìˆ˜ì§‘ ì„¤ì • í™”ë©´ (CollectionSettingsPanel)

**ìœ„ì¹˜**: `frontend/src/pages/user/my-knowledge/components/PatentCollectionSettings.tsx`

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸**:
```typescript
interface CollectionSettings {
  container_id: string;           // ì €ì¥í•  ì§€ì‹ ì»¨í…Œì´ë„ˆ
  search_config: {
    keywords: string[];           // ê²€ìƒ‰ í‚¤ì›Œë“œ
    ipc_codes: string[];          // IPC ë¶„ë¥˜ ì½”ë“œ
    applicants: string[];         // ì¶œì›ì¸ëª…
  };
  max_results: number;            // ìµœëŒ€ ìˆ˜ì§‘ ê±´ìˆ˜
  schedule_type: 'manual' | 'daily' | 'weekly' | 'monthly';
  auto_download_pdf: boolean;     // PDF ìë™ ë‹¤ìš´ë¡œë“œ
  auto_generate_embeddings: boolean; // ì„ë² ë”© ìë™ ìƒì„±
}
```

**UI êµ¬ì„±**:
1. **ê²€ìƒ‰ ì¡°ê±´ ì…ë ¥**
   - í‚¤ì›Œë“œ ì…ë ¥ (ë‹¤ì¤‘ ì…ë ¥, ì‰¼í‘œ êµ¬ë¶„)
   - IPC ì½”ë“œ ì„ íƒ (ë“œë¡­ë‹¤ìš´ + ìë™ì™„ì„±)
   - ì¶œì›ì¸ ì…ë ¥ (ë‹¤ì¤‘ ì…ë ¥)

2. **ìˆ˜ì§‘ ì˜µì…˜**
   - ìµœëŒ€ ìˆ˜ì§‘ ê±´ìˆ˜ (ìŠ¬ë¼ì´ë”: 10~1000)
   - PDF ë‹¤ìš´ë¡œë“œ ì—¬ë¶€ (í† ê¸€)
   - ì„ë² ë”© ìƒì„± ì—¬ë¶€ (í† ê¸€)

3. **ìŠ¤ì¼€ì¤„ ì„¤ì •**
   - ìˆ˜ì§‘ ì£¼ê¸° (ë¼ë””ì˜¤ ë²„íŠ¼: ìˆ˜ë™/ì¼ê°„/ì£¼ê°„/ì›”ê°„)
   - ë‹¤ìŒ ì‹¤í–‰ ì‹œê° í‘œì‹œ (ìë™ ê³„ì‚°)

#### 8.2.2. ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (CollectionMonitorPanel)

**ìœ„ì¹˜**: `frontend/src/pages/user/my-knowledge/components/PatentCollectionMonitor.tsx`

**ëª¨ë‹ˆí„°ë§ ì •ë³´**:
```typescript
interface CollectionStatus {
  task_id: string;
  state: 'PENDING' | 'PROGRESS' | 'SUCCESS' | 'FAILURE';
  current: number;        // í˜„ì¬ ì²˜ë¦¬ ê±´ìˆ˜
  total: number;          // ì „ì²´ ê±´ìˆ˜
  message: string;        // ìƒíƒœ ë©”ì‹œì§€
  result?: {
    saved_count: number;  // ì €ì¥ ì„±ê³µ
    skipped_count: number; // ì¤‘ë³µ ìŠ¤í‚µ
    failed_count: number;  // ì‹¤íŒ¨
  };
}
```

**UI ìš”ì†Œ**:
- **ì§„í–‰ë¥  ë°”**: í¼ì„¼íŠ¸ í‘œì‹œ + í˜„ì¬/ì „ì²´ ê±´ìˆ˜
- **ìƒíƒœ ë©”ì‹œì§€**: "KIPRIS ê²€ìƒ‰ ì¤‘...", "10/50 íŠ¹í—ˆ ì €ì¥ ì¤‘..."
- **ì‹¤ì‹œê°„ ë¡œê·¸**: WebSocket ë˜ëŠ” 3ì´ˆ í´ë§ìœ¼ë¡œ ì—…ë°ì´íŠ¸
- **ì™„ë£Œ í†µê³„**: ì„±ê³µ/ìŠ¤í‚µ/ì‹¤íŒ¨ ê±´ìˆ˜ ìš”ì•½

#### 8.2.3. ìˆ˜ì§‘ ì´ë ¥ ì¡°íšŒ

**í…Œì´ë¸” êµ¬ì„±**:
| ìˆ˜ì§‘ ì‹œê° | ê²€ìƒ‰ ì¡°ê±´ | ê²°ê³¼ | ìƒíƒœ | ì•¡ì…˜ |
|----------|----------|------|------|------|
| 2025-12-22 14:30 | AI, G06N | 45ê±´ | ì™„ë£Œ | ìƒì„¸ |
| 2025-12-21 10:00 | ì‚¼ì„±ì „ì | 120ê±´ | ì™„ë£Œ | ìƒì„¸ |

**í•„í„°ë§**:
- ê¸°ê°„ ì„ íƒ (ìµœê·¼ 7ì¼/30ì¼/ì „ì²´)
- ìƒíƒœë³„ í•„í„° (ì„±ê³µ/ì‹¤íŒ¨/ì§„í–‰ì¤‘)

### 8.3. ë°±ì—”ë“œ ì•„í‚¤í…ì²˜

#### 8.3.1. API ì—”ë“œí¬ì¸íŠ¸

**ë¼ìš°í„°**: `backend/app/api/v1/patent_collection.py`

```python
# ìˆ˜ì§‘ ì„¤ì • ê´€ë¦¬
POST   /api/v1/patent-collection/settings          # ì„¤ì • ìƒì„±
GET    /api/v1/patent-collection/settings          # ì„¤ì • ëª©ë¡ ì¡°íšŒ
PUT    /api/v1/patent-collection/settings/{id}     # ì„¤ì • ìˆ˜ì •
DELETE /api/v1/patent-collection/settings/{id}     # ì„¤ì • ì‚­ì œ

# ìˆ˜ì§‘ ì‹¤í–‰ ë° ëª¨ë‹ˆí„°ë§
POST   /api/v1/patent-collection/start/{setting_id} # ìˆ˜ì§‘ ì‹œì‘
GET    /api/v1/patent-collection/status/{task_id}   # ì§„í–‰ë¥  ì¡°íšŒ
POST   /api/v1/patent-collection/cancel/{task_id}   # ìˆ˜ì§‘ ì·¨ì†Œ

# ìˆ˜ì§‘ ì´ë ¥
GET    /api/v1/patent-collection/history            # ì´ë ¥ ì¡°íšŒ
GET    /api/v1/patent-collection/statistics         # í†µê³„ ì¡°íšŒ
```

#### 8.3.2. Celery ì‘ì—… í

**ë©”ì¸ ì‘ì—…**: `backend/app/tasks/patent_collection_tasks.py`

```python
@celery_app.task(bind=True, base=BaseTask)
def collect_patents_from_kipris(
    self,
    setting_id: int,
    user_emp_no: str
) -> dict:
    """
    KIPRIS APIë¥¼ í†µí•œ íŠ¹í—ˆ ìˆ˜ì§‘ ë©”ì¸ ì‘ì—…
    
    ì²˜ë¦¬ ë‹¨ê³„:
    1. ìˆ˜ì§‘ ì„¤ì • ë¡œë“œ
    2. KIPRIS ê²€ìƒ‰ (KIPRISClient.search_patents)
    3. ê° íŠ¹í—ˆë§ˆë‹¤:
       - TbPatentBibliographicInfo ì €ì¥
       - TbFileBssInfo ìƒì„±
       - PDF ë‹¤ìš´ë¡œë“œ (ì„ íƒ)
       - S3 ì—…ë¡œë“œ (ì„ íƒ)
       - ì„ë² ë”© ìƒì„± (ì„ íƒ)
    4. ê²°ê³¼ ë°˜í™˜ (ì„±ê³µ/ìŠ¤í‚µ/ì‹¤íŒ¨ ê±´ìˆ˜)
    """
```

**ì§„í–‰ë¥  ì—…ë°ì´íŠ¸**:
```python
# Celery ì‘ì—… ë‚´ë¶€ì—ì„œ í˜¸ì¶œ
self.update_state(
    state='PROGRESS',
    meta={
        'current': processed_count,
        'total': total_count,
        'message': f'{patent.title} ì²˜ë¦¬ ì¤‘...'
    }
)
```

**ì—ëŸ¬ ì²˜ë¦¬**:
- `autoretry_for`: KIPRIS API ì¼ì‹œ ì¥ì•  ì‹œ ìë™ ì¬ì‹œë„
- `max_retries`: 3íšŒ
- `retry_backoff`: ì§€ìˆ˜ ë°±ì˜¤í”„ (2ì´ˆ â†’ 4ì´ˆ â†’ 8ì´ˆ)

#### 8.3.3. ë°ì´í„° ëª¨ë¸

**íŠ¹í—ˆ ì„œì§€ì •ë³´**: `backend/app/models/patent/tb_patent_bibliographic_info.py`

```python
class TbPatentBibliographicInfo(Base):
    __tablename__ = "tb_patent_bibliographic_info"
    
    patent_id = Column(BigInteger, primary_key=True)
    application_number = Column(String(50), unique=True, index=True)
    publication_number = Column(String(50), index=True)
    
    # ë°œëª… ì •ë³´
    title = Column(Text, nullable=False)
    abstract = Column(Text)
    
    # ì¶œì›ì¸/ë°œëª…ì
    applicant_name = Column(String(500))
    inventor_names = Column(ARRAY(String))
    
    # ë¶„ë¥˜ ì •ë³´
    ipc_codes = Column(ARRAY(String))
    
    # ë‚ ì§œ ì •ë³´
    application_date = Column(Date)
    publication_date = Column(Date)
    
    # ë²•ì  ìƒíƒœ
    legal_status = Column(String(50))
    jurisdiction = Column(String(10), default='KR')
    
    # ì—°ê²°
    file_bss_info_sno = Column(BigInteger, ForeignKey("tb_file_bss_info.file_bss_info_sno"))
```

**ìˆ˜ì§‘ ì„¤ì •**: `backend/app/models/patent/tb_patent_collection_settings.py`

```python
class TbPatentCollectionSettings(Base):
    __tablename__ = "tb_patent_collection_settings"
    
    setting_id = Column(BigInteger, primary_key=True)
    user_emp_no = Column(String(20), nullable=False, index=True)
    container_id = Column(String(50), nullable=False)
    
    # ê²€ìƒ‰ ì¡°ê±´ (JSON)
    search_config = Column(JSONB, nullable=False)
    # ì˜ˆ: {"keywords": ["AI"], "ipc_codes": ["G06N"], "applicants": ["ì‚¼ì„±"]}
    
    # ìˆ˜ì§‘ ì˜µì…˜
    max_results = Column(Integer, default=100)
    schedule_type = Column(String(20), default='manual')
    auto_download_pdf = Column(Boolean, default=False)
    auto_generate_embeddings = Column(Boolean, default=True)
    
    # ìƒíƒœ
    is_active = Column(Boolean, default=True)
    last_run_at = Column(DateTime(timezone=True))
    next_run_at = Column(DateTime(timezone=True))
```

**ìˆ˜ì§‘ ë¡œê·¸**: `backend/app/models/patent/tb_patent_collection_logs.py`

```python
class TbPatentCollectionLog(Base):
    __tablename__ = "tb_patent_collection_logs"
    
    log_id = Column(BigInteger, primary_key=True)
    setting_id = Column(BigInteger, ForeignKey("tb_patent_collection_settings.setting_id"))
    task_id = Column(String(255), unique=True, index=True)
    
    # ê²°ê³¼
    status = Column(String(20))  # SUCCESS, FAILURE, CANCELLED
    saved_count = Column(Integer, default=0)
    skipped_count = Column(Integer, default=0)
    failed_count = Column(Integer, default=0)
    
    # ì—ëŸ¬ ì •ë³´
    error_message = Column(Text)
    
    # ì‹œê°
    started_at = Column(DateTime(timezone=True))
    completed_at = Column(DateTime(timezone=True))
```

### 8.4. ë°ì´í„° íŒŒì´í”„ë¼ì¸

#### 8.4.1. KIPRIS â†’ PostgreSQL

**ì„œë¹„ìŠ¤**: `backend/app/services/patent/collection_service.py`

```python
class PatentCollectionService:
    async def save_patent_to_database(
        self,
        patent_data: Dict[str, Any],
        container_id: str,
        user_emp_no: str,
        auto_generate_embeddings: bool = True
    ) -> Optional[int]:
        """
        KIPRIS íŠ¹í—ˆ ë°ì´í„°ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
        
        ë‹¨ê³„:
        1. ì¤‘ë³µ ì²´í¬ (application_number)
        2. TbPatentBibliographicInfo ìƒì„±
        3. TbFileBssInfo ìƒì„± (document_type='patent')
        4. ì„ë² ë”© ìƒì„± (ì„ íƒ)
        
        Returns:
            file_bss_info_sno (ë¬¸ì„œ ID)
        """
```

**XML íŒŒì‹±**: `backend/app/services/patent/kipris_client.py`

```python
class KIPRISClient:
    async def search_patents(
        self,
        keywords: List[str] = None,
        ipc_codes: List[str] = None,
        applicants: List[str] = None,
        start_date: str = None,
        end_date: str = None,
        max_results: int = 100
    ) -> List[Dict[str, Any]]:
        """
        KIPRIS AdvancedSearch API í˜¸ì¶œ
        
        ì‘ë‹µ XML íŒŒì‹±:
        - applicationNumber: ì¶œì›ë²ˆí˜¸
        - inventionTitle: ë°œëª…ëª…ì¹­
        - abstract: ì´ˆë¡
        - applicantName: ì¶œì›ì¸
        - inventorName: ë°œëª…ì
        - ipcNumber: IPC ì½”ë“œ
        - applicationDate: ì¶œì›ì¼
        - publicationNumber: ê³µê°œë²ˆí˜¸
        - publicationDate: ê³µê°œì¼
        """
```

#### 8.4.2. PDF â†’ S3

**PDF ë‹¤ìš´ë¡œë“œ**: `backend/app/services/patent/kipris_client.py`

```python
async def download_patent_pdf(
    self,
    application_number: str,
    save_path: str
) -> bool:
    """
    KIPRIS PDF ë‹¤ìš´ë¡œë“œ API
    
    ì—”ë“œí¬ì¸íŠ¸: /downloadService/download
    íŒŒë¼ë¯¸í„°:
    - applicationNumber: ì¶œì›ë²ˆí˜¸
    - publicationNumber: ê³µê°œë²ˆí˜¸ (í´ë°±)
    
    ì €ì¥ ê²½ë¡œ: uploads/patents/{application_number}.pdf
    """
```

**S3 ì—…ë¡œë“œ**: `backend/app/services/patent/collection_service.py`

```python
async def download_and_upload_patent_pdf(
    self,
    patent_data: Dict[str, Any],
    file_bss_info_sno: int
) -> Optional[str]:
    """
    1. KIPRISì—ì„œ PDF ë‹¤ìš´ë¡œë“œ
    2. S3 ì—…ë¡œë“œ (documents/patents/{file_bss_info_sno}.pdf)
    3. ë¡œì»¬ íŒŒì¼ ì‚­ì œ
    4. TbFileBssInfo.path ì—…ë°ì´íŠ¸
    
    Returns:
        S3 í‚¤ (ì˜ˆ: "documents/patents/12345.pdf")
    """
```

#### 8.4.3. ì„ë² ë”© ìƒì„±

**ë²¡í„° ìƒì„±**: `backend/app/services/patent/collection_service.py`

```python
async def _generate_patent_embeddings(
    self,
    patent_data: Dict[str, Any],
    file_bss_info_sno: int
) -> bool:
    """
    íŠ¹í—ˆ í…ìŠ¤íŠ¸ ì„ë² ë”© ìƒì„±
    
    ì²˜ë¦¬ ë‹¨ê³„:
    1. ì„ë² ë”© í…ìŠ¤íŠ¸ ì¤€ë¹„
       - ë°œëª…ëª…ì¹­ + ì´ˆë¡ + ì²­êµ¬í•­ (ìš°ì„ ìˆœìœ„ ìˆœ)
       - ìµœëŒ€ 8000 í† í°
    
    2. ì„ë² ë”© ìƒì„±
       - Provider: Bedrock Titan v2 (1024d) ë˜ëŠ” Azure OpenAI (1536d)
       - ëª¨ë¸: settings.default_embedding_model
    
    3. DocChunkSession ìƒì„±
       - chunking_strategy: 'patent_auto'
    
    4. DocChunk ìƒì„±
       - content_text: ì„ë² ë”© í…ìŠ¤íŠ¸
       - section_heading: 'patent_summary'
    
    5. DocEmbedding ì €ì¥
       - aws_vector_1024 ë˜ëŠ” azure_vector_1536
       - provider, model_name, dimension ë©”íƒ€ë°ì´í„°
    
    6. TbDocumentSearchIndex ì—…ë°ì´íŠ¸
       - Full-Text Search ì¸ë±ìŠ¤ (Korean + English)
    """
```

**Provider ì„ íƒ**:
```python
# .env ì„¤ì •
DEFAULT_EMBEDDING_PROVIDER=aws  # ë˜ëŠ” azure

# Bedrock (ê¸°ë³¸)
- ëª¨ë¸: amazon.titan-embed-text-v2:0
- ì°¨ì›: 1024
- ì €ì¥: DocEmbedding.aws_vector_1024

# Azure OpenAI (í´ë°±)
- ëª¨ë¸: text-embedding-3-small
- ì°¨ì›: 1536
- ì €ì¥: DocEmbedding.azure_vector_1536
```

### 8.5. ìš´ì˜ ë° ëª¨ë‹ˆí„°ë§

#### 8.5.1. ì„±ëŠ¥ ìµœì í™”
- **ë°°ì¹˜ ì²˜ë¦¬**: 100ê±´ì”© ê·¸ë£¹í™”í•˜ì—¬ ì²˜ë¦¬
- **ë³‘ë ¬ ì²˜ë¦¬**: PDF ë‹¤ìš´ë¡œë“œì™€ ì„ë² ë”© ìƒì„± ë³‘ë ¬ ì‹¤í–‰ (asyncio)
- **ìºì‹±**: KIPRIS API ì‘ë‹µ ìºì‹œ (Redis, 1ì‹œê°„ TTL)

#### 8.5.2. ì—ëŸ¬ ì²˜ë¦¬
- **KIPRIS API ì¥ì• **: ìë™ ì¬ì‹œë„ (3íšŒ, ì§€ìˆ˜ ë°±ì˜¤í”„)
- **ì¤‘ë³µ íŠ¹í—ˆ**: application_number ê¸°ì¤€ ìŠ¤í‚µ
- **PDF ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨**: ë¡œê·¸ë§Œ ë‚¨ê¸°ê³  ê³„ì† ì§„í–‰
- **ì„ë² ë”© ì‹¤íŒ¨**: Bedrock â†’ Azure í´ë°±

#### 8.5.3. ë¡œê¹…
```python
logger.info(f"[PATENT-COLLECTION] ìˆ˜ì§‘ ì‹œì‘: {search_config}")
logger.info(f"[PATENT-COLLECTION] KIPRIS ê²€ìƒ‰ ì™„ë£Œ: {len(patents)}ê±´")
logger.info(f"[PATENT-COLLECTION] ì €ì¥ ì™„ë£Œ: {saved_count}ê±´")
logger.warning(f"[PATENT-COLLECTION] ì¤‘ë³µ ìŠ¤í‚µ: {skipped_count}ê±´")
logger.error(f"[PATENT-COLLECTION] ì‹¤íŒ¨: {failed_count}ê±´")
```

---

## 9. íŠ¹í—ˆ ë¬¸ì„œ êµ¬ì¡°í™” ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (Patent Document Structuring Pipeline)

> **ìµœì´ˆ êµ¬í˜„**: 2025-12-24  
> **ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ë°°í¬ ì™„ë£Œ  
> **ëª©ì **: íŠ¹í—ˆ ë¬¸ì„œì˜ ì •í˜•í™”ëœ êµ¬ì¡°(ì²­êµ¬í•­, ëª…ì„¸ì„œ, ë„ë©´)ë¥¼ ë³´ì¡´í•˜ì—¬ ê²€ìƒ‰ í’ˆì§ˆ í–¥ìƒ

### 9.1. ê°œìš”

íŠ¹í—ˆ ë¬¸ì„œëŠ” íŠ¹í—ˆì²­ í‘œì¤€ ì–‘ì‹ì— ë”°ë¼ **ì²­êµ¬í•­, ê¸°ìˆ ë¶„ì•¼, ë°œëª…ì˜ ë°°ê²½, ìƒì„¸í•œ ì„¤ëª…** ë“± 11ê°œ ì„¹ì…˜ìœ¼ë¡œ êµ¬ì¡°í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¼ë°˜ ë¬¸ì„œ íŒŒì´í”„ë¼ì¸(GeneralPipeline)ì€ ì´ëŸ¬í•œ êµ¬ì¡°ë¥¼ ë¬´ì‹œí•˜ê³  ì²­í‚¹í•˜ë¯€ë¡œ, íŠ¹í—ˆ íŠ¹í™” íŒŒì´í”„ë¼ì¸(PatentPipeline)ì„ êµ¬í˜„í•˜ì—¬ ì„¹ì…˜ë³„ ì²­í‚¹ ë° ë©”íƒ€ë°ì´í„° ì €ì¥ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

#### 9.1.1. ë¬¸ì œì  (ê¸°ì¡´ GeneralPipeline)
- **ì„¹ì…˜ í˜¼ì¬**: ì²­êµ¬í•­ê³¼ ëª…ì„¸ì„œê°€ í•˜ë‚˜ì˜ ì²­í¬ì— í˜¼í•©
- **ì²­êµ¬í•­ ì†ì‹¤**: ê°€ì¥ ì¤‘ìš”í•œ ë²•ì  ìš”ì†Œê°€ ë‹¤ë¥¸ ë‚´ìš©ê³¼ êµ¬ë¶„ ë¶ˆê°€
- **ê²€ìƒ‰ ì •í™•ë„ ì €í•˜**: "ì²­êµ¬í•­ë§Œ ê²€ìƒ‰" ê°™ì€ ì„¹ì…˜ ê¸°ë°˜ ì¿¼ë¦¬ ë¶ˆê°€
- **êµ¬ì¡° ì •ë³´ ì†Œì‹¤**: íŠ¹í—ˆì˜ ê³„ì¸µì  êµ¬ì¡°ê°€ í‰ë©´í™”ë¨

#### 9.1.2. í•´ê²° ë°©ì•ˆ (PatentPipeline)
- **ì„¹ì…˜ ìë™ ê°ì§€**: ì •ê·œì‹ íŒ¨í„´ìœ¼ë¡œ 11ê°œ í‘œì¤€ ì„¹ì…˜ ì¸ì‹
- **ì²­êµ¬í•­ ê°œë³„ íŒŒì‹±**: ë…ë¦½í•­/ì¢…ì†í•­ ìë™ ë¶„ë¦¬
- **ì„¹ì…˜ë³„ ì²­í‚¹**: ê° ì„¹ì…˜ì„ ë…ë¦½ ì²­í¬ë¡œ ì²˜ë¦¬
- **ë©”íƒ€ë°ì´í„° ì €ì¥**: DocChunk.section_headingì— ì„¹ì…˜ íƒ€ì… ì €ì¥

### 9.2. PatentPipeline ì•„í‚¤í…ì²˜

#### 9.2.1. íŒŒì´í”„ë¼ì¸ êµ¬ì¡°

**íŒŒì¼**: `backend/app/services/document/pipelines/patent_pipeline.py`

```python
class PatentPipeline(GeneralPipeline):
    """
    íŠ¹í—ˆ ë¬¸ì„œ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
    
    GeneralPipeline ìƒì†:
    - ê¸°ë³¸ ë©€í‹°ëª¨ë‹¬ ì²˜ë¦¬ (Upstage Document Parse)
    - í…ìŠ¤íŠ¸/ì´ë¯¸ì§€/í‘œ ì¶”ì¶œ
    - ì²­í‚¹, ì„ë² ë”©, ì¸ë±ì‹±
    
    íŠ¹í—ˆ íŠ¹í™” ì¶”ê°€:
    - íŠ¹í—ˆ ì„¹ì…˜ ê°ì§€ (PatentSectionDetector)
    - ì²­êµ¬í•­ ê°œë³„ í•­ íŒŒì‹±
    - ì„¹ì…˜ ì •ë³´ Blob Storage ì €ì¥
    """
    
    async def process(self) -> Dict[str, Any]:
        # 1. ê¸°ë³¸ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (ì¶”ì¶œ, ì²­í‚¹, ì„ë² ë”©, ì¸ë±ì‹±)
        result = await super().process()
        
        # 2. íŠ¹í—ˆ ì„¹ì…˜ ê°ì§€ (í›„ì²˜ë¦¬)
        await self._detect_and_save_patent_sections()
        
        return result
```

**ì²˜ë¦¬ íë¦„**:
```
PDF ì—…ë¡œë“œ
    â†“
PatentPipeline.process()
    â”œâ”€ Step 1: Upstage Document Parse
    â”‚   â†’ extraction_full_text.txt ì €ì¥
    â”‚
    â”œâ”€ Step 2: Multimodal ê°ì²´ ì¶”ì¶œ
    â”‚   â†’ ì´ë¯¸ì§€, í‘œ, ìˆ˜ì‹
    â”‚
    â”œâ”€ Step 3: ì²­í‚¹
    â”‚   â†’ doc_chunk í…Œì´ë¸” (section_heading í¬í•¨)
    â”‚
    â”œâ”€ Step 4: ì„ë² ë”©
    â”‚   â†’ doc_embedding í…Œì´ë¸”
    â”‚
    â”œâ”€ Step 5: ì¸ë±ì‹±
    â”‚   â†’ pgvector + Full-Text Search
    â”‚
    â””â”€ Step 6: íŠ¹í—ˆ ì„¹ì…˜ ê°ì§€ (í›„ì²˜ë¦¬)
        â†’ patent_sections.json ì €ì¥
```

#### 9.2.2. PatentSectionDetector

**íŒŒì¼**: `backend/app/services/document/extraction/patent_section_detector.py`

**ê°ì§€ ê°€ëŠ¥í•œ ì„¹ì…˜ (11ê°œ)**:

| ì„¹ì…˜ íƒ€ì… | í•œê¸€ ì´ë¦„ | ìš°ì„ ìˆœìœ„ | íŒ¨í„´ ì˜ˆì‹œ |
|-----------|-----------|----------|-----------|
| `claims` | ì²­êµ¬í•­ | 0 (ìµœê³ ) | `[ì²­êµ¬í•­]`, `[íŠ¹í—ˆì²­êµ¬ë²”ìœ„]` |
| `title` | ë°œëª…ì˜ ëª…ì¹­ | 1 | `[ë°œëª…ì˜ ëª…ì¹­]` |
| `technical_field` | ê¸°ìˆ ë¶„ì•¼ | 2 | `[ê¸°ìˆ  ë¶„ì•¼]` |
| `background` | ë°œëª…ì˜ ë°°ê²½ | 3 | `[ë°œëª…ì˜ ë°°ê²½]` |
| `prior_art` | ì„ í–‰ê¸°ìˆ ë¬¸í—Œ | 4 | `[ì„ í–‰ê¸°ìˆ  ë¬¸í—Œ]` |
| `problem` | í•´ê²°í•˜ê³ ì í•˜ëŠ” ê³¼ì œ | 5 | `[í•´ê²°í•˜ê³ ì í•˜ëŠ” ê³¼ì œ]` |
| `solution` | ê³¼ì œì˜ í•´ê²° ìˆ˜ë‹¨ | 6 | `[ê³¼ì œì˜ í•´ê²° ìˆ˜ë‹¨]` |
| `effects` | ë°œëª…ì˜ íš¨ê³¼ | 7 | `[ë°œëª…ì˜ íš¨ê³¼]` |
| `brief_description_drawings` | ë„ë©´ì˜ ê°„ë‹¨í•œ ì„¤ëª… | 8 | `[ë„ë©´ì˜ ê°„ë‹¨í•œ ì„¤ëª…]` |
| `detailed_description` | ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš© | 9 | `[ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©]` |
| `drawings` | ë„ë©´ | 10 | `[ë„ ë©´]` |

**ì •ê·œì‹ íŒ¨í„´**:
```python
SECTION_PATTERNS = [
    {
        "type": "claims",
        "patterns": [
            r"^\s*\[?\s*ì²­\s*êµ¬\s*í•­?\s*\]?",
            r"^\s*\[?\s*íŠ¹í—ˆ\s*ì²­êµ¬\s*ë²”ìœ„\s*\]?",
            r"^\s*Claims?\s*:",
        ],
        "priority": 0
    },
    # ... (11ê°œ ì„¹ì…˜)
]
```

**ì²­êµ¬í•­ íŒŒì‹±**:
```python
def _parse_claims(self, claims_text: str) -> List[PatentSection]:
    """
    ì²­êµ¬í•­ í…ìŠ¤íŠ¸ì—ì„œ ê°œë³„ í•­ íŒŒì‹±
    
    íŒ¨í„´:
    - "ì²­êµ¬í•­ 1"
    - "ì œ1í•­"
    - "[ì²­êµ¬í•­ 1]"
    - "Claim 1."
    
    ê²°ê³¼:
    [
        PatentSection(type="claim_1", title="ì²­êµ¬í•­ 1", content="..."),
        PatentSection(type="claim_2", title="ì²­êµ¬í•­ 2", content="..."),
        ...
    ]
    """
```

#### 9.2.3. ë°ì´í„° ì €ì¥

**Blob Storage**: `intermediate/multimodal/{document_id}/patent_sections.json`

```json
{
  "sections": [
    {
      "section_type": "claims",
      "title": "ì²­êµ¬í•­",
      "start_pos": 1234,
      "end_pos": 5678,
      "content": "ì²­êµ¬í•­ 1. ...",
      "content_length": 4444,
      "priority": 0,
      "subsections": [
        {
          "section_type": "claim_1",
          "title": "ì²­êµ¬í•­ 1",
          "content": "ì²­êµ¬í•­ 1. ì„œë²„ì™€ í†µì‹ í•˜ëŠ”...",
          "priority": 0
        },
        {
          "section_type": "claim_2",
          "title": "ì²­êµ¬í•­ 2",
          "content": "ì²­êµ¬í•­ 2. ì œ1í•­ì— ìˆì–´ì„œ...",
          "priority": 0
        }
      ]
    },
    {
      "section_type": "detailed_description",
      "title": "ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©",
      "start_pos": 5678,
      "end_pos": 12345,
      "content": "ì´í•˜ ì‹¤ì‹œì˜ˆë¥¼ í†µí•´...",
      "priority": 9
    }
  ],
  "summary": {
    "total_sections": 8,
    "sections_found": ["ì²­êµ¬í•­", "ê¸°ìˆ ë¶„ì•¼", "ë°œëª…ì˜ ë°°ê²½", ...],
    "claims_count": 15,
    "has_detailed_description": true,
    "has_drawings": true
  },
  "detected_at": "2025-12-24T14:30:00"
}
```

**PostgreSQL**: `doc_chunk` í…Œì´ë¸”

```sql
SELECT 
    chunk_id,
    section_heading,  -- "ì²­êµ¬í•­", "ë°œëª…ì˜ ë°°ê²½" ë“±
    LEFT(content_text, 100) AS preview,
    token_count,
    page_range
FROM doc_chunk
WHERE file_bss_info_sno = 12345  -- íŠ¹í—ˆ ë¬¸ì„œ ID
ORDER BY chunk_index;
```

### 9.3. ì„¹ì…˜ë³„ ì²­í‚¹ ì „ëµ

#### 9.3.1. ì²­êµ¬í•­ (Claims)

**ì „ëµ**: ê° í•­ì„ ë…ë¦½ ì²­í¬ë¡œ

**ì´ìœ **:
- ì²­êµ¬í•­ì€ ë²•ì ìœ¼ë¡œ ê°€ì¥ ì¤‘ìš”í•œ ìš”ì†Œ
- ê° í•­ì€ ë…ë¦½ì ì¸ ê¶Œë¦¬ ë²”ìœ„ë¥¼ ì •ì˜
- ì¢…ì†í•­ì€ ìƒìœ„ í•­ì„ ì°¸ì¡° (ì œ1í•­ì— ìˆì–´ì„œ)

**ì˜ˆì‹œ**:
```
ì…ë ¥:
[ì²­êµ¬í•­]
ì²­êµ¬í•­ 1. ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ë‹¨ë§ì¥ì¹˜...
ì²­êµ¬í•­ 2. ì œ1í•­ì— ìˆì–´ì„œ, ìƒê¸° í”„ë¡œì„¸ì„œëŠ”...
ì²­êµ¬í•­ 3. ì œ1í•­ ë˜ëŠ” ì œ2í•­ì— ìˆì–´ì„œ...

ê²°ê³¼:
Chunk 1:
  content_text: "ì²­êµ¬í•­ 1. ì„œë²„ì™€ í†µì‹ í•˜ëŠ”..."
  section_heading: "ì²­êµ¬í•­"
  
Chunk 2:
  content_text: "ì²­êµ¬í•­ 2. ì œ1í•­ì— ìˆì–´ì„œ..."
  section_heading: "ì²­êµ¬í•­"
  
Chunk 3:
  content_text: "ì²­êµ¬í•­ 3. ì œ1í•­ ë˜ëŠ” ì œ2í•­ì—..."
  section_heading: "ì²­êµ¬í•­"
```

#### 9.3.2. ìƒì„¸í•œ ì„¤ëª… (Detailed Description)

**ì „ëµ**: ë‹¨ë½ ë‹¨ìœ„ ì²­í‚¹ (í† í° ì œí•œ ê³ ë ¤)

**ì´ìœ **:
- ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ ê¸´ ì„¹ì…˜
- ì‹¤ì‹œì˜ˆ, ë„ë©´ ì„¤ëª… ë“±ì´ í¬í•¨
- ì˜ë¯¸ì  ë‹¨ë½ ê²½ê³„ ì¡´ì¤‘

**ì˜ˆì‹œ**:
```
Chunk N:
  content_text: "[ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©]\nì´í•˜ ì²¨ë¶€ ë„ë©´..."
  section_heading: "ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©"
  token_count: 380
```

#### 9.3.3. ê¸°íƒ€ ì„¹ì…˜

**ì „ëµ**: ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ì²­í¬ë¡œ

**ì´ìœ **:
- ê¸°ìˆ ë¶„ì•¼, ë°œëª…ì˜ ë°°ê²½, íš¨ê³¼ ë“±ì€ ë¹„êµì  ì§§ìŒ
- ì„¹ì…˜ ì „ì²´ê°€ í•˜ë‚˜ì˜ ì˜ë¯¸ ë‹¨ìœ„

### 9.4. ê²€ìƒ‰ ìµœì í™”

#### 9.4.1. ì„¹ì…˜ í•„í„°ë§

**ì˜ˆì‹œ: ì²­êµ¬í•­ë§Œ ê²€ìƒ‰**
```python
# Vector Search with Filter
results = await search_service.search(
    query="ë¬´ì„  í†µì‹  ë°©ë²•",
    filters={
        "section_heading": "ì²­êµ¬í•­"
    }
)
```

**ì˜ˆì‹œ: ìƒì„¸ ì„¤ëª… ê²€ìƒ‰**
```python
results = await search_service.search(
    query="ì‹¤ì‹œì˜ˆ êµ¬í˜„ ë°©ë²•",
    filters={
        "section_heading": "ë°œëª…ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©"
    }
)
```

#### 9.4.2. ì„¹ì…˜ ê°€ì¤‘ì¹˜

**ê²€ìƒ‰ ì‹œ ìš°ì„ ìˆœìœ„ ì ìš©**:
```python
section_weights = {
    "ì²­êµ¬í•­": 2.0,                      # ìµœê³  ìš°ì„ ìˆœìœ„
    "ë°œëª…ì˜ ë°°ê²½": 1.5,
    "ê¸°ìˆ ë¶„ì•¼": 1.3,
    "ë°œëª…ì˜ íš¨ê³¼": 1.2,
    "default": 1.0
}

# ê°€ì¤‘ì¹˜ ì ìš© ê²€ìƒ‰
for result in results:
    section = result.section_heading
    weight = section_weights.get(section, 1.0)
    result.score *= weight
```

#### 9.4.3. í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰

**ë²¡í„° ê²€ìƒ‰ + FTS ê²°í•©**:
```python
# 1. ë²¡í„° ê²€ìƒ‰ (ì˜ë¯¸ ìœ ì‚¬ë„)
vector_results = await vector_search(query, top_k=50)

# 2. Full-Text Search (í‚¤ì›Œë“œ ë§¤ì¹­)
fts_results = await full_text_search(query, top_k=50)

# 3. ê²°ê³¼ ë³‘í•© (Reciprocal Rank Fusion)
final_results = merge_results(vector_results, fts_results)

# 4. ì„¹ì…˜ í•„í„° ì ìš©
filtered_results = [
    r for r in final_results 
    if r.section_heading in ["ì²­êµ¬í•­", "ê¸°ìˆ ë¶„ì•¼"]
]
```

### 9.5. PipelineRouter í†µí•©

**íŒŒì¼**: `backend/app/services/document/pipeline_router.py`

```python
from app.services.document.pipelines.patent_pipeline import PatentPipeline

PIPELINE_MAP: Dict[str, Type[DocumentPipeline]] = {
    DocumentType.GENERAL: GeneralPipeline,
    DocumentType.ACADEMIC_PAPER: AcademicPaperPipeline,
    DocumentType.PATENT: PatentPipeline,  # âœ… 2025-12-24
    DocumentType.UNSTRUCTURED_TEXT: GeneralPipeline,
}
```

**ìë™ ë¼ìš°íŒ…**:
```python
# ì‚¬ìš©ìê°€ "ğŸ“œ íŠ¹í—ˆ ë¬¸ì„œ" ì„ íƒí•˜ì—¬ ì—…ë¡œë“œ
# â†’ document_type="patent"
# â†’ PipelineRouter.get_pipeline(document_type="patent")
# â†’ PatentPipeline ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜
# â†’ íŠ¹í—ˆ íŠ¹í™” ì²˜ë¦¬ ìˆ˜í–‰
```

### 9.6. ìš´ì˜ ë° ëª¨ë‹ˆí„°ë§

#### 9.6.1. ë¡œê¹…

```python
logger.info("[PATENT-SECTION] ì„¹ì…˜ ê°ì§€ ì‹œì‘ (í…ìŠ¤íŠ¸ ê¸¸ì´: 45,678ì)")
logger.info("[PATENT-SECTION] ì„¹ì…˜ ë°œê²¬: claims (ë¼ì¸ 12, ìš°ì„ ìˆœìœ„ 0)")
logger.info("[PATENT-SECTION] ì²­êµ¬í•­ íŒŒì‹±: 12ê°œ í•­ ë°œê²¬")
logger.info("[PATENT-SECTION] âœ… 8ê°œ ì„¹ì…˜ ê°ì§€ ì™„ë£Œ")
logger.info("[PATENT-SECTION] ì„¹ì…˜ ì •ë³´ ì €ì¥(s3): multimodal/678/patent_sections.json")
```

#### 9.6.2. í’ˆì§ˆ ê²€ì¦

**ì„¹ì…˜ ê°ì§€ ì •í™•ë„**:
- ì¬í˜„ìœ¨: 95%+ (í•œêµ­ íŠ¹í—ˆì²­ í‘œì¤€ ì–‘ì‹)
- ì •ë°€ë„: 98%+ (ê³ ì • íŒ¨í„´ ê¸°ë°˜)

**ì²­í‚¹ í’ˆì§ˆ ë¹„êµ**:
```
[GeneralPipeline]
- ì²­êµ¬í•­ + ëª…ì„¸ì„œ í˜¼ì¬
- ì„¹ì…˜ ê²½ê³„ ë¬´ì‹œ
- í‰ê·  ì²­í¬ í¬ê¸°: 400 í† í°

[PatentPipeline]
- ì²­êµ¬í•­ ê° í•­ ë…ë¦½ ì²­í¬
- ì„¹ì…˜ë³„ ì²­í‚¹
- í‰ê·  ì²­í¬ í¬ê¸°: 280 í† í° (ì²­êµ¬í•­), 400 í† í° (ëª…ì„¸ì„œ)
```

#### 9.6.3. ì—ëŸ¬ ì²˜ë¦¬

**ì„¹ì…˜ ê°ì§€ ì‹¤íŒ¨ ì‹œ**:
```python
try:
    sections = detector.detect_sections(full_text)
except Exception as e:
    logger.warning(f"[PATENT-SECTION] ì„¹ì…˜ ê°ì§€ ì‹¤íŒ¨: {e}")
    # GeneralPipeline ì²­í‚¹ ë°©ì‹ìœ¼ë¡œ í´ë°±
    sections = []
```

**ì²­êµ¬í•­ íŒŒì‹± ì‹¤íŒ¨ ì‹œ**:
```python
if not claims:
    logger.warning("[PATENT-CLAIMS] ì²­êµ¬í•­ ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ")
    # ì²­êµ¬í•­ ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ì„¹ì…˜ìœ¼ë¡œ ì²˜ë¦¬
    return [PatentSection(
        section_type="claims",
        title="ì²­êµ¬í•­",
        content=claims_text
    )]
```

### 9.7. í–¥í›„ ê°œì„  ë°©í–¥

#### 9.7.1. íŠ¹í—ˆ ì„œì§€ì •ë³´ DB ì €ì¥

**ëª©í‘œ**: PDF ë³¸ë¬¸ì—ì„œ ì„œì§€ì •ë³´ ì¶”ì¶œ

```python
async def _save_patent_bibliographic_info(self, full_text: str):
    # ì¶œì›ë²ˆí˜¸ ì¶”ì¶œ: "ì¶œì›ë²ˆí˜¸: 10-2023-0012345"
    application_number = self._extract_application_number(full_text)
    
    # ë°œëª…ì/ì¶œì›ì¸ ì¶”ì¶œ (ì²« í˜ì´ì§€ íŒŒì‹±)
    inventors = self._extract_inventors(full_text)
    
    # IPC ë¶„ë¥˜ ì¶”ì¶œ: "G06F 3/048"
    ipc_codes = self._extract_ipc_codes(full_text)
    
    # TbPatentBibliographicInfo ì—…ë°ì´íŠ¸
    await self._upsert_patent_info(application_number, inventors, ipc_codes)
```

#### 9.7.2. ì²­êµ¬í•­ ë…ë¦½í•­/ì¢…ì†í•­ ê´€ê³„ ê·¸ë˜í”„

**ëª©í‘œ**: ì²­êµ¬í•­ ê°„ ì¸ìš© ê´€ê³„ ì‹œê°í™”

```
ì²­êµ¬í•­ 1 (ë…ë¦½í•­)
  â”œâ”€ ì²­êµ¬í•­ 2 (ì¢…ì†í•­: ì œ1í•­ì— ìˆì–´ì„œ)
  â”œâ”€ ì²­êµ¬í•­ 3 (ì¢…ì†í•­: ì œ1í•­ì— ìˆì–´ì„œ)
  â””â”€ ì²­êµ¬í•­ 4 (ì¢…ì†í•­: ì œ1í•­ ë˜ëŠ” ì œ2í•­ì— ìˆì–´ì„œ)
```

#### 9.7.3. ë„ë©´ OCR ë° ì°¸ì¡° ì—°ê²°

**ëª©í‘œ**: ëª…ì„¸ì„œì˜ "ë„ 1ì„ ì°¸ì¡°í•˜ë©´" â†’ ì‹¤ì œ ë„ë©´ ì´ë¯¸ì§€ ì—°ê²°

```python
# ë„ë©´ ì°¸ì¡° ê°ì§€
references = re.findall(r'ë„\s*(\d+)', text)

# ë„ë©´ ì´ë¯¸ì§€ì™€ ë§¤ì¹­
for ref in references:
    figure_id = f"figure_{ref}"
    # Blob Storageì—ì„œ ë„ë©´ ì´ë¯¸ì§€ ë¡œë“œ
```

---

## 10. ì°¸ê³  ìë£Œ

### 10.1. ê´€ë ¨ ë¬¸ì„œ
- `01.docs/02.document_ingestion_vectorstore.md` - ë©€í‹°ëª¨ë‹¬ ë¬¸ì„œ ì²˜ë¦¬
- `01.docs/archive/PATENT_COLLECTION_COMPLETE_2025-12-22.md` - ìˆ˜ì§‘ ì‹œìŠ¤í…œ ì™„ì„± ë³´ê³ ì„œ
- `01.docs/archive/PATENT_STRUCTURED_PIPELINE_2025-12-22.md` - êµ¬ì¡°í™” íŒŒì´í”„ë¼ì¸ êµ¬í˜„

### 10.2. ì½”ë“œ ìœ„ì¹˜
```
backend/
â”œâ”€ app/
â”‚  â”œâ”€ api/v1/patent_collection.py          # API ì—”ë“œí¬ì¸íŠ¸
â”‚  â”œâ”€ services/
â”‚  â”‚  â””â”€ patent/
â”‚  â”‚     â”œâ”€ kipris_client.py               # KIPRIS API í´ë¼ì´ì–¸íŠ¸
â”‚  â”‚     â””â”€ collection_service.py          # ìˆ˜ì§‘ ì„œë¹„ìŠ¤
â”‚  â”œâ”€ services/document/
â”‚  â”‚  â”œâ”€ pipelines/
â”‚  â”‚  â”‚  â””â”€ patent_pipeline.py            # íŠ¹í—ˆ íŒŒì´í”„ë¼ì¸
â”‚  â”‚  â””â”€ extraction/
â”‚  â”‚     â””â”€ patent_section_detector.py    # ì„¹ì…˜ ê°ì§€
â”‚  â”œâ”€ models/
â”‚  â”‚  â””â”€ patent/
â”‚  â”‚     â”œâ”€ tb_patent_bibliographic_info.py
â”‚  â”‚     â”œâ”€ tb_patent_collection_settings.py
â”‚  â”‚     â””â”€ tb_patent_collection_logs.py
â”‚  â””â”€ tasks/
â”‚     â””â”€ patent_collection_tasks.py        # Celery ì‘ì—…

frontend/
â””â”€ src/pages/user/my-knowledge/components/
   â”œâ”€ PatentCollectionSettings.tsx         # ìˆ˜ì§‘ ì„¤ì • UI
   â””â”€ PatentCollectionMonitor.tsx          # ëª¨ë‹ˆí„°ë§ UI
```