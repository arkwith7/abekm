# KIPRIS PLUS API 설명서 (IPBridge — 선행기술조사/특허 도구 개발 참고)

**작성일:** 2025-12-28  
**목적:** 선행기술조사 에이전트(특히 KIPRIS 기반 Prior Art Search) 설계/구현 시 필요한 KIPRIS PLUS(REST) API 핵심 정보를 별도 정리하여, 정본 설계서에서 참조할 수 있도록 한다.

> Source: KIPRIS PLUS 포털(특허·실용 공개·등록공보)
> - https://plus.kipris.or.kr/portal/popup/service/DBII_000000000000001/view.do#soap_ADI_0000000000015100

---

## 1. 데이터셋/서비스 개요

### 1.1 대상 데이터
- **특허·실용 공개·등록공보**
- 제공 범위(요약): **서지정보**, **대표도**, **전문정보(청구범위/전문 다운로드 경로 등)**

### 1.2 제공 방식
- **REST API**
- 응답 포맷: **XML**

### 1.3 IPBridge에서의 활용 위치(권장)
- `PatentDiscoveryTool`: KIPRIS 검색(getAdvancedSearch) 결과(리스트/서지) 확보
- `PatentDetailTool`: 후보 특허의 추가 필드(가능 범위 내) 보강
- `PriorArtPrepTool` / `QuerySeedSet` 생성: 입력 특허 PDF에서 만든 키워드/IPC/출원인 등을 KIPRIS 파라미터로 매핑
- `PriorArtSearchService`: 반복 검색 루프(3회 이상)에서 query variant를 순차 실행하며 결과를 누적/정제

---

## 2. 오퍼레이션(Operations)

### 2.1 전체검색 — `getAdvancedSearch`

- 용도: 특허·실용 공보의 **일반검색/항목별검색**
- 핵심 특징:
  - 다수의 필드 파라미터를 입력하여 검색(예: 발명의명칭/초록/청구범위/IPC/출원번호 등)
  - 페이지네이션(`pageNo`, `numOfRows`) 지원
  - 정렬(`sortSpec`, `descSort`) 지원

---

## 3. 요청(Request)

### 3.1 기본 요청 주소(Base)
- 포털 베이스: `http://plus.kipris.or.kr/`

> 실제 API 호출은 아래 샘플처럼 서비스 경로를 포함한다.

### 3.2 요청 URL 예시(샘플)

```text
http://plus.kipris.or.kr/kipo-api/kipi/patUtiModInfoSearchSevice/getAdvancedSearch?astrtCont=발명&inventionTitle=센서&ServiceKey=YOUR_SERVICE_KEY
```

### 3.3 필수 파라미터
- `ServiceKey`: 발급받은 서비스 키

### 3.4 주요 파라미터(요약)

> 아래 표는 “선행기술조사”에서 자주 사용하는 파라미터 중심으로 정리한다.

| 파라미터 | 의미 | 비고 |
|---|---|---|
| `word` | 자유검색 | “전체검색/자유검색” 용도 |
| `inventionTitle` | 발명의명칭 | 제목 키워드 |
| `astrtCont` | 초록 | 키워드/문장 |
| `claimScope` | 청구범위 | 독립항 핵심 구성요소 기반 검색에 활용 |
| `ipcNumber` | IPC 코드 | 후보 IPC로 필터/보강 |
| `applicationNumber` | 출원번호 | 특정 문헌/번호 기반 |
| `openNumber` | 공개번호 | 특정 문헌/번호 기반 |
| `publicationNumber` | 공보(고)번호 | 문헌 식별 |
| `registerNumber` | 등록번호 | 문헌 식별 |
| `applicationDate` | 출원일자 | 날짜 범위 전략에 활용 |
| `openDate` | 공개일자 | 날짜 범위 전략에 활용 |
| `publicationDate` | 공고일자 | 날짜 범위 전략에 활용 |
| `registerDate` | 등록일자 | 날짜 범위 전략에 활용 |
| `applicant` | 출원인명/특허고객번호 | 편향 방지 위해 낮은 가중치로 활용 권장 |
| `inventors` | 발명자명/특허고객번호 | 선택 |
| `agent` | 대리인명/대리인코드 | 선택 |
| `rightHoler` | 등록권자(특허권자) | 표기 오탈자 가능성(원문 기준) |
| `patent` | 특허 포함 여부 | `true/false` |
| `utility` | 실용 포함 여부 | `true/false` |
| `lastvalue` | 행정처분/상태 필터 | 공백=전체, A/C/F/G/I/J/R 등 |
| `pageNo` | 페이지 번호 | 1부터 시작 |
| `numOfRows` | 페이지당 건수 | 기본 30, 최대 500 |
| `sortSpec` | 정렬 기준 | `PD/AD/GD/OPD/FD/FOD/RD` |
| `descSort` | 정렬 방식 | `false`=asc, `true`=desc |

### 3.5 정렬 기준(`sortSpec`) 값
- `PD`: 공고일자
- `AD`: 출원일자
- `GD`: 등록일자
- `OPD`: 공개일자
- `FD`: 국제출원일자
- `FOD`: 국제공개일자
- `RD`: 우선권주장일자

---

## 4. 응답(Response)

### 4.1 응답 구조(요약)

```xml
<response>
  <header>
    <successYN>Y</successYN>
    <resultCode>00</resultCode>
    <resultMsg>NORMAL SERVICE.</resultMsg>
    ...
  </header>
  <body>
    <items>
      <item>...</item>
      <item>...</item>
    </items>
  </body>
  <count>
    <numOfRows>...</numOfRows>
    <pageNo>...</pageNo>
    <totalCount>...</totalCount>
  </count>
</response>
```

### 4.2 `items/item` 주요 필드(요약)

| 필드 | 의미 |
|---|---|
| `indexNo` | 일련번호 |
| `registerStatus` | 등록상태(예: 등록/거절/소멸 등) |
| `inventionTitle` | 발명의 명칭 |
| `ipcNumber` | IPC 코드(복수 가능) |
| `applicationNumber`, `applicationDate` | 출원번호/출원일 |
| `openNumber`, `openDate` | 공개번호/공개일 |
| `publicationNumber`, `publicationDate` | 공고번호/공고일 |
| `registerNumber`, `registerDate` | 등록번호/등록일 |
| `astrtCont` | 초록(긴 텍스트 가능) |
| `drawing`, `bigDrawing` | 대표도/큰 대표도 다운로드 경로 |
| `applicantName` | 출원인 |

### 4.3 파일 다운로드 링크(`drawing`/`bigDrawing`) 처리 메모
- 응답 예시에서는 `fileToss.jsp?arg=...` 형태의 URL이 내려온다.
- IPBridge에서 저장/프록시 정책은 선택사항이다.
  - 정책 A(기본): 외부 링크 보관(저장하지 않음)
  - 정책 B(옵션): 이미지/PDF 다운로드 후 S3/Azure에 저장

---

## 5. 선행기술조사 에이전트 관점의 사용 가이드(권장)

본 API 문서는 “선행기술조사 에이전트의 시작점은 검색이 아니라 Prep”이라는 전제 하에 작성한다.

Prep이 만들어야 하는 3가지 산출물은 아래와 같다.

1) **독립항(1항) 중심 핵심 구성요소/한정요소**
  - 파싱이 불안정해도 “원문 보존 + 후보 리스트”로 손실을 방지한다.
2) **KIPRIS에 넣을 query variant 세트(broad/balanced/strict)**
  - 필수어/제외어 포함(단, 제외어는 API 미지원 시 사후 필터링으로 구현)
3) **보고서 템플릿을 채울 InventionModel**
  - 문제/해결/효과/구성요소/차별점 후보

### 5.1 Prep → KIPRIS 파라미터 매핑

- 입력: 특허 PDF에서 생성한 `InventionModel`/`QuerySeedSet`
- 매핑 예:
  - `keywords_primary` → `inventionTitle` 또는 `astrtCont`
  - `required_terms`(핵심 구성요소) → `claimScope` 또는 `astrtCont`
  - `ipc_candidates` → `ipcNumber`
  - `excluded_terms` → (API가 직접 지원하지 않으면) 사후 필터링로 구현

#### 5.1.1 query variant(권장)와 파라미터 매핑

| variant | 목적 | 권장 파라미터 |
|---|---|---|
| broad | 폭넓은 후보 확보 | `inventionTitle`(키워드), `astrtCont`(키워드), `patent/utility`, `pageNo/numOfRows`, `sortSpec/descSort` |
| balanced | 노이즈 감소/정밀도 증가 | broad + `ipcNumber`(가능 시) + `claimScope`(핵심 구성요소 일부) |
| strict | 핵심 구성요소 중심 수렴 | `claimScope`(독립항 핵심 구성요소 중심) + `ipcNumber`(가능 시) + (필요 시) 날짜 필터 |

### 5.2 반복 검색(Iteration) 최소형 권장
- Iteration 1: `inventionTitle`/`astrtCont` 중심 broad
- Iteration 2: `ipcNumber` + 핵심 구성요소 보강
- Iteration 3: 독립항 기반 strict(`claimScope` 활용) + 결과 다양성 확보(중복 제거/클러스터링)

### 5.3 재현성(로그) 필수 항목
- 요청 URL(또는 파라미터 딕셔너리)
- `pageNo/numOfRows` 사용값
- 결과 `totalCount` 및 실제 수집 건수
- 후처리(중복 제거/필터링/랭킹) 규칙 및 변경 사유

---

## 6. 구현 참고(IPBridge 코드 연결)

- `backend/app/clients/kipris.py`
  - `search_patents()`가 `getAdvancedSearch`에 해당하는 검색을 수행
  - URL 인코딩/파라미터 구성은 “이중 인코딩” 같은 오류가 발생하기 쉬우므로, 구현 시 단일 인코딩 원칙을 유지한다.

- `backend/app/tools/retrieval/patent_functional_tools.py`
  - Discovery/Detail/Legal 도구가 `KIPRISClient`를 호출하는 구조로 유지하는 것이 안전하다.

---

## 7. 한계/주의사항(현재 문서 기준)

- 본 문서는 사용자가 제공한 요약/샘플 기반으로 “선행기술조사에 필요한 핵심”을 정리한 것이다.
- API의 정확한 결합 논리(다중 필드 입력 시 AND/OR 규칙 등), 레이트리밋, 오류 코드 상세는
  운영 중 실제 호출 결과와 함께 보강해야 한다.
