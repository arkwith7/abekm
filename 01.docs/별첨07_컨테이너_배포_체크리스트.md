# ë³„ì²¨07 - ABEKM ì»¨í…Œì´ë„ˆ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë° ê°€ì´ë“œ

> **ë¬¸ì„œ ì •ë³´**  
>
> - **ë²„ì „**: 2.0  
>
> - **ëª©ì **: Docker Compose ë° Kubernetes (EKS/AKS) ë°°í¬ë¥¼ ìœ„í•œ ì¢…í•© ì²´í¬ë¦¬ìŠ¤íŠ¸
>
> **ì£¼ìš” ì—…ë°ì´íŠ¸ (v2.0)**:
>
> - ğŸ†• frontend/.env íŒŒì¼ í•„ìˆ˜ ì„¤ì • ê°€ì´ë“œ ì¶”ê°€
>
> - ğŸ†• SSL/HTTPS ì ìš© ìƒì„¸ ê°€ì´ë“œ (Let's Encrypt)
>
> - ğŸ†• í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ì‹¤íŒ¨ ì§„ë‹¨ ë° í•´ê²° (6ê°€ì§€ ì›ì¸)
>

---

## ğŸ“‹ ëª©ì°¨

1. [ë°°í¬ í™˜ê²½ ê°œìš”](#1-ë°°í¬-í™˜ê²½-ê°œìš”)
2. [Docker Compose ë°°í¬](#2-docker-compose-ë°°í¬)
3. [Kubernetes ë°°í¬ (ê³µí†µ)](#3-kubernetes-ë°°í¬-ê³µí†µ)
4. [AWS EKS ë°°í¬](#4-aws-eks-ë°°í¬)
5. [Azure AKS ë°°í¬](#5-azure-aks-ë°°í¬)
6. [ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸](#6-ë°°í¬-ì „-ì²´í¬ë¦¬ìŠ¤íŠ¸)
7. [ë¬¸ì œ í•´ê²°](#7-ë¬¸ì œ-í•´ê²°)

---

## 1. ë°°í¬ í™˜ê²½ ê°œìš”

### 1.1 í˜„ì¬ ë°°í¬ ì¤€ë¹„ ìƒíƒœ

| í•­ëª©             | Docker Compose | Kubernetes  | EKS                | AKS              | ìƒíƒœ    |
| -------------- | -------------- | ----------- | ------------------ | ---------------- | ----- |
| **Dockerfile** | âœ… ì™„ë£Œ           | âœ… ì™„ë£Œ        | âœ… ì™„ë£Œ               | âœ… ì™„ë£Œ             | ì¤€ë¹„ë¨   |
| **Compose íŒŒì¼** | âœ… ì™„ë£Œ           | N/A         | N/A                | N/A              | ì¤€ë¹„ë¨   |
| **K8s ë§¤ë‹ˆí˜ìŠ¤íŠ¸**  | N/A            | âœ… ì™„ë£Œ        | âœ… ì™„ë£Œ               | âœ… ì™„ë£Œ             | ì¤€ë¹„ë¨   |
| **í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬**   | âœ… .env         | âœ… ConfigMap | âœ… ConfigMap        | âœ… ConfigMap      | ì¤€ë¹„ë¨   |
| **ì‹œí¬ë¦¿ ê´€ë¦¬**     | âš ï¸ .env        | âœ… Secret    | âœ… Secret           | âœ… Secret         | ê°œì„  í•„ìš” |
| **ì˜êµ¬ ìŠ¤í† ë¦¬ì§€**    | âœ… Volume       | âœ… PVC       | âœ… EBS/gp3          | âœ… Managed Disk   | ì¤€ë¹„ë¨   |
| **ë¡œë“œ ë°¸ëŸ°ì„œ**     | âœ… Nginx        | âœ… Ingress   | âœ… ALB              | âœ… App Gateway    | ì¤€ë¹„ë¨   |
| **í—¬ìŠ¤ ì²´í¬**      | âœ… ì™„ë£Œ           | âœ… ì™„ë£Œ        | âœ… ì™„ë£Œ               | âœ… ì™„ë£Œ             | ì¤€ë¹„ë¨   |
| **ëª¨ë‹ˆí„°ë§**       | âŒ ì—†ìŒ           | âš ï¸ ë¶€ë¶„       | âš ï¸ CloudWatch      | âš ï¸ Azure Monitor | ê°œì„  í•„ìš” |
| **ë¡œê·¸ ìˆ˜ì§‘**      | âŒ ì—†ìŒ           | âš ï¸ ë¶€ë¶„       | âš ï¸ CloudWatch Logs | âš ï¸ Log Analytics | ê°œì„  í•„ìš” |
| **ìë™ í™•ì¥**      | âŒ ì—†ìŒ           | âœ… HPA       | âœ… HPA              | âœ… HPA            | ì¤€ë¹„ë¨   |

### 1.2 ì§€ì› ë°°í¬ ë°©ì‹

#### **Docker Compose** (ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½)

- **ìš©ë„**: ë¡œì»¬ ê°œë°œ, í†µí•© í…ŒìŠ¤íŠ¸, ì†Œê·œëª¨ ë°°í¬
- **ì¥ì **: ê°„ë‹¨í•œ ì„¤ì •, ë¹ ë¥¸ ì‹œì‘, ë‚®ì€ ëŸ¬ë‹ ì»¤ë¸Œ
- **ë‹¨ì **: ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ ì œí•œ, ì œí•œì ì¸ í™•ì¥ì„±, ìˆ˜ë™ ì¥ì•  ë³µêµ¬

#### **Kubernetes** (í”„ë¡œë•ì…˜ í™˜ê²½)

- **ìš©ë„**: ëŒ€ê·œëª¨ ìš´ì˜, ê³ ê°€ìš©ì„±, ìë™ í™•ì¥
- **ì¥ì **: ë©€í‹° í˜¸ìŠ¤íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, ìë™ ë³µêµ¬, ë¡¤ë§ ì—…ë°ì´íŠ¸
- **ë‹¨ì **: ë³µì¡í•œ ì„¤ì •, ë†’ì€ ëŸ¬ë‹ ì»¤ë¸Œ, ìš´ì˜ ì˜¤ë²„í—¤ë“œ

#### **AWS EKS** (í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ - AWS)

- **ìš©ë„**: AWS ìƒíƒœê³„ í†µí•©, ê´€ë¦¬í˜• Kubernetes
- **ì¥ì **: AWS ì„œë¹„ìŠ¤ ë„¤ì´í‹°ë¸Œ ì—°ë™, ê´€ë¦¬ ë¶€ë‹´ ê°ì†Œ
- **íŠ¹í™”**: ALB Ingress, EBS CSI, IAM ì—­í•  ê¸°ë°˜ ì¸ì¦

#### **Azure AKS** (í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ - Azure)

- **ìš©ë„**: Azure ìƒíƒœê³„ í†µí•©, ê´€ë¦¬í˜• Kubernetes
- **ì¥ì **: Azure ì„œë¹„ìŠ¤ ë„¤ì´í‹°ë¸Œ ì—°ë™, Active Directory í†µí•©
- **íŠ¹í™”**: Application Gateway Ingress, Azure Disk CSI, Managed Identity

---

## 2. Docker Compose ë°°í¬

### 2.1 í˜„ì¬ êµ¬ì„± ìƒíƒœ

**íŒŒì¼ ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/docker-compose.yml`

**ì„œë¹„ìŠ¤ êµ¬ì„±**:
```yaml
services:
  âœ… postgres       # PostgreSQL 15 + pgvector
  âœ… redis          # Redis 7-alpine (ìºì‹œ/ì„¸ì…˜)
  âœ… backend        # FastAPI (Python 3.11)
  âœ… frontend       # React (Node 18)
  âœ… nginx          # ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ
  âœ… pgadmin        # DB ê´€ë¦¬ ë„êµ¬ (ì„ íƒ)
```

### 2.2 ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ğŸ” **ë°°í¬ ì „ ìë™ ê²€ì¦ (í•„ìˆ˜)**

**âš ï¸ ì£¼ì˜**: `.env` íŒŒì¼ì´ ì—†ê±°ë‚˜ í•„ìˆ˜ ë³€ìˆ˜ê°€ ëˆ„ë½ë˜ì–´ë„ Docker ComposeëŠ” ê²½ê³  ì—†ì´ ì‹¤í–‰ë˜ë©°, ëŸ°íƒ€ì„ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤!

#### ğŸ“ **ìë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ (`shell-script/validate-env.sh`)**

**ğŸ“ ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜**: `shell-script/validate-env.sh`

**ğŸ¯ ì£¼ìš” ê¸°ëŠ¥**:
- **Docker Compose í™˜ê²½ íŒŒì¼** ê²€ì¦ (`.env.development`, `.env.production`)
- í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ 8ê°œ ê²€ì¦ (POSTGRES_DB, POSTGRES_USER, DATABASE_URL, SECRET_KEY ë“±)
- ë³´ì•ˆ ì„¤ì • í™•ì¸ (í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸, localhost CORS ì—„ê²© ê²€ì¦)
- `frontend/.env` íŒŒì¼ ë° API URL í™•ì¸
- ê²€ì¦ ê²°ê³¼ì— ë”°ë¼ ìƒ‰ìƒë³„ ì¶œë ¥ (ì˜¤ë¥˜: ë¹¨ê°•, ê²½ê³ : ë…¸ë‘, ì„±ê³µ: ì´ˆë¡)

**ğŸ’¡ ì¤‘ìš”**: 
- ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” **Docker Compose ë°°í¬ ì „ìš©**ì…ë‹ˆë‹¤
- í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ê°œë°œ í™˜ê²½(`backend/.env`)ì€ ë³„ë„ ê²€ì¦ ë¶ˆí•„ìš”

**ì‚¬ìš© ë°©ë²•**:

```bash
# 1. ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬ (ìµœì´ˆ 1íšŒ)
chmod +x shell-script/validate-env.sh

# 2. ê°œë°œ í™˜ê²½ ê²€ì¦ (.env.development)
./shell-script/validate-env.sh .env.development

# ë˜ëŠ” ê¸°ë³¸ê°’ (íŒŒë¼ë¯¸í„° ìƒëµ ì‹œ .env.development)
./shell-script/validate-env.sh

# 3. í”„ë¡œë•ì…˜ í™˜ê²½ ê²€ì¦ (.env.production)
./shell-script/validate-env.sh .env.production

# 4. ê²€ì¦ í†µê³¼ í›„ ë°°í¬
# ê°œë°œ í™˜ê²½
docker-compose --env-file .env.development up -d

# í”„ë¡œë•ì…˜ í™˜ê²½
docker-compose -f docker-compose.prod.yml --env-file .env.production up -d
```

#### âœ… **í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ êµ¬ì¡° ì´í•´ (ì¤‘ìš”!)**

**ğŸ¯ í•µì‹¬ ì •ë¦¬**:

ABEKMì€ **Docker Compose ê¸°ë°˜ ë°°í¬**ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, **ë£¨íŠ¸ì˜ `.env.development`ì™€ `.env.production` íŒŒì¼ë§Œ ì‚¬ìš©**í•©ë‹ˆë‹¤.

**í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ì—­í• **:

| íŒŒì¼ ìœ„ì¹˜                  | ìš©ë„             | Docker ë°°í¬ ì‹œ í•„ìš” ì—¬ë¶€ | ì„¤ëª…                                                              |
| ---------------------- | -------------- | ----------------- | --------------------------------------------------------------- |
| **`.env.development`** | Docker ê°œë°œ í™˜ê²½   | âœ… **í•„ìˆ˜**          | Docker Composeê°€ ì½ì–´ì„œ ëª¨ë“  ì»¨í…Œì´ë„ˆ(backend, postgres, redis)ì— í™˜ê²½ ë³€ìˆ˜ ì£¼ì… |
| **`.env.production`**  | Docker í”„ë¡œë•ì…˜ í™˜ê²½ | âœ… **í•„ìˆ˜**          | ìƒˆ ì„œë²„ ë°°í¬ ì‹œ ì‚¬ìš©                                                    |
| **`frontend/.env`**    | í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì„¤ì •    | âœ… **í•„ìˆ˜**          | í”„ë¡ íŠ¸ì—”ë“œ ì´ë¯¸ì§€ ë¹Œë“œ ì‹œ API URL ì„¤ì •                                       |
| **`backend/.env`**     | í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ìš©     | âŒ **ë¶ˆí•„ìš”**         | Docker ì—†ì´ `python -m uvicorn` ì‹¤í–‰ ì‹œë§Œ ì‚¬ìš© (ê°œë°œì IDE ë””ë²„ê¹…ìš©)           |

**ğŸ”´ ì¤‘ìš”: Docker ComposeëŠ” ë£¨íŠ¸ì˜ `.env.*` íŒŒì¼ì„ ì½ê³ , `backend/.env`ëŠ” ë¬´ì‹œí•©ë‹ˆë‹¤!**

#### ğŸ”„ **í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ì ˆì°¨ (í•„ìˆ˜!)**

**ë¬¸ì œ ìƒí™©**: 
- ê°œë°œìê°€ `backend/.env`ì— ìƒˆë¡œìš´ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€
- Docker ë°°í¬ ì‹œ `.env.development`ì™€ `.env.production`ì— ë°˜ì˜ ëˆ„ë½
- ê²°ê³¼: ëŸ°íƒ€ì„ ì—ëŸ¬ ë°œìƒ (`KeyError`, `None type error`)

**í•´ê²° ë°©ë²•**: **í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ì²´í¬ë¦¬ìŠ¤íŠ¸**

```bash
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ì ˆì°¨ (ê°œë°œ â†’ Docker ë°°í¬)
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# 1ë‹¨ê³„: backend/.envì— ìƒˆ í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ (ê°œë°œ ì¤‘)
# ì˜ˆ: ìƒˆë¡œìš´ AI ëª¨ë¸ ì„¤ì • ì¶”ê°€
# backend/.env
NEW_AI_MODEL=gpt-4o-mini
NEW_AI_TEMPERATURE=0.7

# 2ë‹¨ê³„: âš ï¸ ì¦‰ì‹œ .env.developmentì— ë™ì¼í•˜ê²Œ ì¶”ê°€!
vi .env.development
# íŒŒì¼ ëì— ì¶”ê°€:
NEW_AI_MODEL=gpt-4o-mini
NEW_AI_TEMPERATURE=0.7

# 3ë‹¨ê³„: âš ï¸ .env.productionì—ë„ ì¶”ê°€ (í”„ë¡œë•ì…˜ ê°’ìœ¼ë¡œ)
vi .env.production
# íŒŒì¼ ëì— ì¶”ê°€:
NEW_AI_MODEL=gpt-4o  # í”„ë¡œë•ì…˜ì€ ë” ê°•ë ¥í•œ ëª¨ë¸
NEW_AI_TEMPERATURE=0.5

# 4ë‹¨ê³„: ë™ê¸°í™” ê²€ì¦ (ìë™ ìŠ¤í¬ë¦½íŠ¸)
./shell-script/sync-check-env.sh
```

#### ğŸ“ **í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸**

**ğŸ“ ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜**: `shell-script/sync-check-env.sh`

**ğŸ¯ ì£¼ìš” ê¸°ëŠ¥**:
- `backend/.env`, `.env.development`, `.env.production` íŒŒì¼ ê°„ KEY ë™ê¸°í™” ìƒíƒœ ê²€ì¦
- ëˆ„ë½ëœ KEYë¥¼ ìë™ìœ¼ë¡œ íƒì§€í•˜ê³  ìƒ‰ìƒë³„ë¡œ êµ¬ë¶„í•˜ì—¬ ì¶œë ¥
- ë°°í¬ ì „ í™˜ê²½ ë³€ìˆ˜ ì¼ê´€ì„± í™•ì¸

**ğŸ“ ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜**: `shell-script/sync-env-keys.sh`

**ğŸ¯ ì£¼ìš” ê¸°ëŠ¥**:
- `backend/.env`ì˜ KEYë¥¼ `.env.development`ì™€ `.env.production`ì— ìë™ ì¶”ê°€
- âš ï¸ ê°’(VALUE)ì€ ìë™ìœ¼ë¡œ ë³µì‚¬í•˜ì§€ë§Œ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì • í•„ìš”
- í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ì‘ì—… ìë™í™”

**ì‚¬ìš© ë°©ë²•**:

```bash
# 1. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x shell-script/sync-check-env.sh
chmod +x shell-script/sync-env-keys.sh

# 2. ê°œë°œ ì¤‘ backend/.envì— í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ í›„

# 3. ë™ê¸°í™” ê²€ì¦
./shell-script/sync-check-env.sh

# 4. ëˆ„ë½ëœ KEYê°€ ë°œê²¬ë˜ë©´ ìë™ ì¶”ê°€ (ì„ íƒ)
./shell-script/sync-env-keys.sh

# 5. ìˆ˜ë™ìœ¼ë¡œ .env.productionì˜ ê°’ í™•ì¸ ë° ìˆ˜ì •
vi .env.production

# 6. ì¬ê²€ì¦
./shell-script/sync-check-env.sh
```

**Git Hookìœ¼ë¡œ ìë™í™”** (ì„ íƒì‚¬í•­):

```bash
# .git/hooks/pre-commit ìƒì„±
cat > .git/hooks/pre-commit << 'EOF'
#!/bin/bash
# ì»¤ë°‹ ì „ í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ê²€ì¦

if [ -f shell-script/sync-check-env.sh ]; then
  echo "í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ê²€ì¦ ì¤‘..."
  ./shell-script/sync-check-env.sh || {
    echo ""
    echo "âŒ í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ì´ ë™ê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!"
    echo "ğŸ’¡ ./shell-script/sync-env-keys.sh ì‹¤í–‰ í›„ ë‹¤ì‹œ ì»¤ë°‹í•˜ì„¸ìš”."
    exit 1
  }
fi
EOF

chmod +x .git/hooks/pre-commit
```

**ğŸ“‹ í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸**:

- [ ] âœ… **ê°œë°œ ì‹œ**: `backend/.env`ì— ìƒˆ ë³€ìˆ˜ ì¶”ê°€
- [ ] âœ… **ì¦‰ì‹œ**: `.env.development`ì— ë™ì¼ KEY ì¶”ê°€ (ê°œë°œ í™˜ê²½ ê°’)
- [ ] âœ… **ë™ì‹œì—**: `.env.production`ì— ë™ì¼ KEY ì¶”ê°€ (í”„ë¡œë•ì…˜ í™˜ê²½ ê°’)
- [ ] âœ… **ê²€ì¦**: `./shell-script/sync-check-env.sh` ì‹¤í–‰
- [ ] âœ… **ë°°í¬ ì „**: ë‹¤ì‹œ í•œë²ˆ ê²€ì¦ ì‹¤í–‰
- [ ] âœ… **ë¬¸ì„œí™”**: ìƒˆ í™˜ê²½ ë³€ìˆ˜ì˜ ìš©ë„ë¥¼ ì£¼ì„ìœ¼ë¡œ ëª…ì‹œ

**í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ ì˜ˆì‹œ**:

```bash
# backend/.env (í„°ë¯¸ë„ ì‹¤í–‰ìš©)
# ìƒˆë¡œìš´ AI ëª¨ë¸ ì„¤ì •
NEW_AI_MODEL=gpt-4o-mini
NEW_AI_TEMPERATURE=0.7
NEW_AI_MAX_TOKENS=2000

# â†“ ì¦‰ì‹œ ë™ê¸°í™” â†“

# .env.development (Docker ê°œë°œ í™˜ê²½)
# ìƒˆë¡œìš´ AI ëª¨ë¸ ì„¤ì •
NEW_AI_MODEL=gpt-4o-mini
NEW_AI_TEMPERATURE=0.7
NEW_AI_MAX_TOKENS=2000

# .env.production (Docker í”„ë¡œë•ì…˜ í™˜ê²½)
# ìƒˆë¡œìš´ AI ëª¨ë¸ ì„¤ì • (í”„ë¡œë•ì…˜ ê°’)
NEW_AI_MODEL=gpt-4o  # ë” ê°•ë ¥í•œ ëª¨ë¸
NEW_AI_TEMPERATURE=0.5  # ë” ë³´ìˆ˜ì ì¸ ê°’
NEW_AI_MAX_TOKENS=4000  # ë” ë§ì€ í† í°
```

**ğŸ’¡ Docker Compose ë™ì‘ ë°©ì‹**:

```bash
# Docker Compose ë™ì‘ ë°©ì‹:
# 1. .env.development ë˜ëŠ” .env.production íŒŒì¼ ì½ê¸°
# 2. docker-compose.ymlì˜ environment ì„¹ì…˜ì— í™˜ê²½ ë³€ìˆ˜ ì£¼ì…
# 3. ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ í•´ë‹¹ í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©

# âŒ backend/.envëŠ” Docker Composeê°€ ì½ì§€ ì•ŠìŒ!
# âœ… .env.development ë˜ëŠ” .env.productionì„ ì½ìŒ!
```

**ğŸ“ íŒŒì¼ ì¤‘ë³µ ë¬¸ì œ í•´ê²°**:

```bash
# âœ… Docker ë°°í¬ ì‹œ í•„ìš”í•œ íŒŒì¼ (2ê°œë§Œ!)
.env.development        # ê°œë°œ í™˜ê²½ìš©
.env.production         # í”„ë¡œë•ì…˜ í™˜ê²½ìš©
frontend/.env           # í”„ë¡ íŠ¸ì—”ë“œ API URL

# âŒ Docker ë°°í¬ ì‹œ ë¶ˆí•„ìš” (ì‚­ì œ ë˜ëŠ” ë¬´ì‹œí•´ë„ ë¨)
backend/.env            # í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ìš© (Dockerì™€ ë¬´ê´€)
```

**ğŸ”´ í•µì‹¬ ì°¨ì´ì **:

```bash
# âŒ backend/.env (Docker Composeê°€ ì½ì§€ ì•ŠìŒ! í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ìš©)
DATABASE_URL=postgresql+asyncpg://wkms:wkms123@localhost:5432/wkms  # localhost!
REDIS_URL=redis://localhost:6379  # localhost!
# â†’ Docker ë°°í¬ ì‹œ ì´ íŒŒì¼ì€ ë¬´ì‹œë¨!

# âœ… .env.development / .env.production (Docker Composeê°€ ì½ìŒ!)
DATABASE_URL=postgresql+asyncpg://wkms:wkms123@postgres:5432/wkms  # Docker ì„œë¹„ìŠ¤ëª…!
REDIS_URL=redis://redis:6379  # Docker ì„œë¹„ìŠ¤ëª…!
# â†’ Docker Composeê°€ ì´ íŒŒì¼ì„ ì½ì–´ì„œ ì»¨í…Œì´ë„ˆì— í™˜ê²½ ë³€ìˆ˜ ì£¼ì…!
```

#### âœ… **í•„ìˆ˜ í™•ì¸ ì‚¬í•­**

- [ ] **1ï¸âƒ£ `.env.development` íŒŒì¼ (Docker ê°œë°œ í™˜ê²½) - í•„ìˆ˜!**

  **ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/.env.development`

  **ìš©ë„**: Docker Composeê°€ ì½ì–´ì„œ ëª¨ë“  ì»¨í…Œì´ë„ˆ(backend, postgres, redis)ì— í™˜ê²½ ë³€ìˆ˜ ì£¼ì…

  **ì‚¬ìš© ëª…ë ¹**: 
  ```bash
  # Docker Composeê°€ ìë™ìœ¼ë¡œ .env.development íŒŒì¼ ì½ìŒ
  docker-compose up -d

  # ë˜ëŠ” ëª…ì‹œì ìœ¼ë¡œ ì§€ì •

  docker-compose --env-file .env.development up -d
  ```

  **Docker Compose ë™ì‘ ì›ë¦¬**:
  ```yaml
  # docker-compose.yml
  services:
    backend:
      environment:
        - DATABASE_URL=${DATABASE_URL}  # .env.developmentì—ì„œ ì½ìŒ
        - REDIS_URL=${REDIS_URL}        # .env.developmentì—ì„œ ì½ìŒ
  ```

  **í•„ìˆ˜ ì„¤ì •**:
  ```bash
  # ë°ì´í„°ë² ì´ìŠ¤ (Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš©!)
  DATABASE_URL=postgresql+asyncpg://wkms:wkms123@postgres:5432/wkms
  POSTGRES_USER=wkms
  POSTGRES_PASSWORD=wkms123  # ê°œë°œ í™˜ê²½ì´ë¯€ë¡œ ê°„ë‹¨í•œ ë¹„ë°€ë²ˆí˜¸ OK
  POSTGRES_DB=wkms

  # Redis (Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš©!)

  REDIS_URL=redis://redis:6379

  # JWT ë° ë³´ì•ˆ

  JWT_SECRET_KEY=<ê°œë°œìš©_ì‹œí¬ë¦¿>
  SECRET_KEY=<ê°œë°œìš©_ì‹œí¬ë¦¿>

  # CORS (ë¡œì»¬ ê°œë°œ)

  CORS_ORIGINS=["http://localhost:3000","http://127.0.0.1:3000"]
  ENVIRONMENT=development

  # ìŠ¤í† ë¦¬ì§€

  STORAGE_BACKEND=local  # ê°œë°œ í™˜ê²½ì€ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€
  ```
- [ ] **2ï¸âƒ£ `.env.production` íŒŒì¼ (Docker í”„ë¡œë•ì…˜ í™˜ê²½)**

  **ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/.env.production`

  **ìš©ë„**: ìƒˆ ì„œë²„ì— ë°°í¬ ì‹œ ì‚¬ìš© (í”„ë¡œë•ì…˜ í™˜ê²½)

  **ì‚¬ìš© ëª…ë ¹**:
  ```bash
  docker-compose -f docker-compose.yml -f docker-compose.prod.yml --env-file .env.production up -d
  # ë˜ëŠ”
  ./deploy.sh up
  ```

  **í•„ìˆ˜ ì„¤ì • (âš ï¸ ìƒˆ ì„œë²„ ë°°í¬ ì‹œ ë°˜ë“œì‹œ ìˆ˜ì •)**:
  ```bash
  # ë°ì´í„°ë² ì´ìŠ¤ (Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš©!)
  DATABASE_URL=postgresql+asyncpg://wkms:${POSTGRES_PASSWORD}@postgres:5432/wkms
  POSTGRES_USER=wkms
  POSTGRES_PASSWORD=<STRONG_PASSWORD>  # âš ï¸ ë°˜ë“œì‹œ ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½!
  POSTGRES_DB=wkms

  # Redis (Docker ì„œë¹„ìŠ¤ëª… ì‚¬ìš©!)

  REDIS_URL=redis://redis:6379

  # JWT ë° ë³´ì•ˆ (âš ï¸ í”„ë¡œë•ì…˜ìš© ê°•ë ¥í•œ í‚¤ ìƒì„± í•„ìš”!)

  JWT_SECRET_KEY=<RANDOM_SECRET_64_CHARS>  # openssl rand -base64 64
  SECRET_KEY=<RANDOM_SECRET_64_CHARS>

  # CORS (âš ï¸ ì‹¤ì œ ì„œë²„ IP ë˜ëŠ” ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½!)

  CORS_ORIGINS=["http://192.168.1.100","http://your-domain.com"]  # ì‹¤ì œ ì£¼ì†Œ!
  ENVIRONMENT=production

  # ìŠ¤í† ë¦¬ì§€ (í”„ë¡œë•ì…˜ì€ S3 ê¶Œì¥)

  STORAGE_BACKEND=s3  # ë˜ëŠ” azure_blob
  AWS_S3_BUCKET=wkms-documents
  AWS_REGION=ap-northeast-2
  # AWS ìê²©ì¦ëª… (IAM Role ì‚¬ìš© ê¶Œì¥)
  ```
- [ ] **3ï¸âƒ£ `backend/.env` íŒŒì¼ (í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ìš©)**

  **ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/backend/.env`

  **ìš©ë„**: Docker ì—†ì´ í„°ë¯¸ë„ì—ì„œ ì§ì ‘ `python -m uvicorn app.main:app` ì‹¤í–‰ ì‹œë§Œ ì‚¬ìš©

  **âš ï¸ ì¤‘ìš”**: 
  - âŒ **Docker Compose ë°°í¬ ì‹œì—ëŠ” ì´ íŒŒì¼ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!**
  - âŒ **ìƒˆ ì„œë²„ ë°°í¬ ì‹œì—ëŠ” ìˆ˜ì •í•  í•„ìš” ì—†ìŠµë‹ˆë‹¤!**
  - âœ… **ë¡œì»¬ ê°œë°œìê°€ IDEì—ì„œ ì§ì ‘ ë°±ì—”ë“œ ì‹¤í–‰ ì‹œì—ë§Œ ì‚¬ìš©**

  **ì„¤ì • ì˜ˆì‹œ** (ì°¸ê³ ìš© - Docker ë°°í¬ ì‹œ ë¬´ì‹œë¨):
  ```bash
  # localhost ì£¼ì†Œ ì‚¬ìš© (Docker ì„œë¹„ìŠ¤ëª… ì•„ë‹˜!)
  DATABASE_URL=postgresql+asyncpg://wkms:wkms123@localhost:5432/wkms
  REDIS_URL=redis://localhost:6379
  # ... ë‚˜ë¨¸ì§€ ì„¤ì •
  ```
- [ ] **4ï¸âƒ£ `frontend/.env` íŒŒì¼ (í”„ë¡ íŠ¸ì—”ë“œ API ì—°ê²°)**

  **ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/frontend/.env`

  **âš ï¸ í•„ìˆ˜**: ì´ íŒŒì¼ì´ ì—†ìœ¼ë©´ í”„ë¡ íŠ¸ì—”ë“œê°€ ë°±ì—”ë“œ APIë¥¼ ì°¾ì§€ ëª»í•©ë‹ˆë‹¤!

  ```bash
  # ë¡œì»¬ ê°œë°œ í™˜ê²½
  REACT_APP_API_URL=http://localhost:8000
  REACT_APP_ENV=development

  # ìƒˆ ì„œë²„ ë°°í¬ ì‹œ (IP ì£¼ì†Œ ì‚¬ìš©)
  REACT_APP_API_URL=http://192.168.1.100:8000  # âš ï¸ ì‹¤ì œ ì„œë²„ IPë¡œ ë³€ê²½!
  REACT_APP_ENV=production

  # ë„ë©”ì¸ ì‚¬ìš© ì‹œ (HTTP)
  REACT_APP_API_URL=http://api.your-domain.com
  REACT_APP_ENV=production

  # ë„ë©”ì¸ + SSL ì‚¬ìš© ì‹œ (HTTPS - ê¶Œì¥)
  REACT_APP_API_URL=https://api.your-domain.com
  REACT_APP_ENV=production
  ```

  **ğŸ’¡ ì¤‘ìš” ì‚¬í•­**:
  - í”„ë¡ íŠ¸ì—”ë“œ ì´ë¯¸ì§€ ë¹Œë“œ ì‹œ ì´ ê°’ì´ ë²ˆë“¤ì— í¬í•¨ë©ë‹ˆë‹¤
  - ë³€ê²½ í›„ ë°˜ë“œì‹œ í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ í•„ìš”: `docker-compose build frontend`
  - ëŸ°íƒ€ì„ì— í™˜ê²½ ë³€ìˆ˜ ë³€ê²½ì´ ë°˜ì˜ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤!

#### ğŸ“Š **í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ì‚¬ìš© ë§¤íŠ¸ë¦­ìŠ¤**

| ì‹œë‚˜ë¦¬ì˜¤           | ì‚¬ìš© íŒŒì¼                                  | Docker | ëª…ë ¹                                                |
| -------------- | -------------------------------------- | ------ | ------------------------------------------------- |
| ë¡œì»¬ IDE ì§ì ‘ ì‹¤í–‰   | `backend/.env`                         | âŒ      | `uvicorn app.main:app`                            |
| Docker ë¡œì»¬ ê°œë°œ   | `.env.development` + `frontend/.env`   | âœ…      | `docker-compose up -d`                            |
| Docker í”„ë¡œë•ì…˜ ë°°í¬ | `.env.production` + `frontend/.env`    | âœ…      | `docker-compose -f docker-compose.prod.yml up -d` |
| ìƒˆ ì„œë²„ ë°°í¬        | `.env.production` + `frontend/.env` ìˆ˜ì • | âœ…      | ì•„ë˜ ê°€ì´ë“œ ì°¸ì¡°                                         |

#### ğŸŒ **ìƒˆ ì„œë²„ ë°°í¬ ì‹œ ë„¤íŠ¸ì›Œí¬ ì„¤ì •**

- [ ] **IP ë§¤í•‘ ë° ë„ë©”ì¸ ì„¤ì •**

  **ì‹œë‚˜ë¦¬ì˜¤ 1: IP ì£¼ì†Œë¡œ ì ‘ê·¼ (í…ŒìŠ¤íŠ¸ í™˜ê²½)**

  ```bash
  # 1. ì„œë²„ IP í™•ì¸
  ip addr show  # ë˜ëŠ” ifconfig
  # ì˜ˆ: 192.168.1.100

  # 2. .env.production ìˆ˜ì •
  vi .env.production
  # CORS_ORIGINS ìˆ˜ì •:
  CORS_ORIGINS=["http://192.168.1.100:3000","http://192.168.1.100:80","http://192.168.1.100"]

  # 3. frontend/.env ìˆ˜ì •
  vi frontend/.env
  REACT_APP_API_URL=http://192.168.1.100:8000
  REACT_APP_ENV=production

  # 4. í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ ë° ë°°í¬ (í•„ìˆ˜!)
  docker-compose -f docker-compose.prod.yml --env-file .env.production build frontend
  docker-compose -f docker-compose.prod.yml --env-file .env.production up -d
  ```

  **ì‹œë‚˜ë¦¬ì˜¤ 2: ë„ë©”ì¸ ë„¤ì„ ì‚¬ìš© (í”„ë¡œë•ì…˜ í™˜ê²½)**

  ```bash
  # 1. DNS ì„¤ì • (ë„ë©”ì¸ ë“±ë¡ ì—…ì²´ì—ì„œ)
  # A ë ˆì½”ë“œ ì¶”ê°€:
  #   api.your-domain.com  â†’  ì„œë²„ IP (192.168.1.100)
  #   www.your-domain.com  â†’  ì„œë²„ IP (192.168.1.100)

  # 2. .env.production ìˆ˜ì •
  vi .env.production
  # CORS_ORIGINS ìˆ˜ì •:
  CORS_ORIGINS=["https://www.your-domain.com","http://www.your-domain.com"]

  # 3. frontend/.env ìˆ˜ì •
  vi frontend/.env
  REACT_APP_API_URL=http://api.your-domain.com
  REACT_APP_ENV=production

  # 4. í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ ë° ë°°í¬ (í•„ìˆ˜!)
  docker-compose -f docker-compose.prod.yml --env-file .env.production build frontend
  docker-compose -f docker-compose.prod.yml --env-file .env.production up -d
  ```
- [ ] **HTTPS/SSL ì„¤ì • (í”„ë¡œë•ì…˜ í•„ìˆ˜)**

  **Let's Encrypt SSL ì¸ì¦ì„œ ìë™ ë°œê¸‰ ì„¤ì •**

  ```bash
  # 1. Certbot ì„¤ì¹˜ (Ubuntu/Debian)
  sudo apt-get update
  sudo apt-get install certbot python3-certbot-nginx

  # 2. SSL ì¸ì¦ì„œ ë°œê¸‰
  sudo certbot --nginx -d www.your-domain.com -d api.your-domain.com

  # 3. ìë™ ê°±ì‹  ì„¤ì • (Let's Encrypt ì¸ì¦ì„œëŠ” 90ì¼ë§ˆë‹¤ ê°±ì‹ )
  sudo certbot renew --dry-run

  # 4. .env.production ìˆ˜ì • (HTTPSë¡œ ë³€ê²½)
  vi .env.production
  CORS_ORIGINS=["https://www.your-domain.com"]

  # 5. frontend/.env ìˆ˜ì • (HTTPSë¡œ ë³€ê²½)
  vi frontend/.env
  REACT_APP_API_URL=https://api.your-domain.com
  REACT_APP_ENV=production

  # 6. Nginx SSL ì„¤ì • í™•ì¸ (nginx/nginx.conf)
  # Certbotì´ ìë™ìœ¼ë¡œ ì„¤ì •í•˜ì§€ë§Œ, ì•„ë˜ ë‚´ìš© í™•ì¸:
  #   - listen 443 ssl
  #   - ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem
  #   - ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem

  # 7. í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ ë° ì¬ë°°í¬
  docker-compose -f docker-compose.prod.yml --env-file .env.production build frontend
  docker-compose -f docker-compose.prod.yml --env-file .env.production restart backend nginx
  docker-compose -f docker-compose.prod.yml --env-file .env.production up -d
  ```

  **docker-compose.prod.ymlì— SSL ë³¼ë¥¨ ì¶”ê°€**:

  ```yaml
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"  # HTTPS í¬íŠ¸ ì¶”ê°€
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - /etc/letsencrypt:/etc/letsencrypt:ro  # SSL ì¸ì¦ì„œ ë§ˆìš´íŠ¸
      - /var/lib/letsencrypt:/var/lib/letsencrypt:ro
    depends_on:
      - backend
      - frontend
  ```

#### ğŸ”§ **CORS ì„¤ì • ìƒì„¸ ê°€ì´ë“œ**

**ë¬¸ì œ ì¦ìƒ**: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œ API í˜¸ì¶œ ì‹œ CORS ì—ëŸ¬ ë°œìƒ

```
Access to fetch at 'http://api.your-domain.com/api/v1/...' from origin 
'http://www.your-domain.com' has been blocked by CORS policy
```

**í•´ê²° ë°©ë²•**:

```bash
# âš ï¸ ì¤‘ìš”: .env.production íŒŒì¼ì˜ CORS_ORIGINSë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤!
# backend/.envê°€ ì•„ë‹™ë‹ˆë‹¤!
# ë£¨íŠ¸ .env íŒŒì¼ì˜ CORS_ORIGINS ì„¤ì •

# ë¡œì»¬ ê°œë°œ í™˜ê²½
CORS_ORIGINS=["http://localhost:3000","http://localhost:80"]

# âš ï¸ ì¤‘ìš”: .env.production íŒŒì¼ì˜ CORS_ORIGINSë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤!
# backend/.envê°€ ì•„ë‹™ë‹ˆë‹¤!

vi .env.production

# ë¡œì»¬ ê°œë°œ í™˜ê²½ (.env.developmentì—ì„œë§Œ)
CORS_ORIGINS=["http://localhost:3000","http://127.0.0.1:3000"]

# IP ì£¼ì†Œ ì‚¬ìš© ì‹œ (.env.production)
CORS_ORIGINS=["http://192.168.1.100:3000","http://192.168.1.100:80","http://192.168.1.100"]

# ë„ë©”ì¸ ì‚¬ìš© ì‹œ (HTTP) (.env.production)
CORS_ORIGINS=["http://www.your-domain.com","http://api.your-domain.com"]

# ë„ë©”ì¸ ì‚¬ìš© ì‹œ (HTTPS - í”„ë¡œë•ì…˜ ê¶Œì¥) (.env.production)
CORS_ORIGINS=["https://www.your-domain.com"]

# ë³µìˆ˜ ë„ë©”ì¸ í—ˆìš© (ê°œë°œ+í”„ë¡œë•ì…˜)
CORS_ORIGINS=["http://localhost:3000","https://www.your-domain.com","https://staging.your-domain.com"]
```

**âš ï¸ ì£¼ì˜ì‚¬í•­**:
- **Docker ë°°í¬ ì‹œ**: `.env.production` íŒŒì¼ì˜ CORS_ORIGINS ìˆ˜ì •
- **í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ ì‹œ**: `backend/.env` íŒŒì¼ì˜ CORS_ORIGINS ìˆ˜ì •
- CORS_ORIGINS ë³€ê²½ í›„ ë°±ì—”ë“œ ì¬ì‹œì‘ í•„ìˆ˜:
  ```bash
  # Docker ë°°í¬ ì‹œ
  docker-compose -f docker-compose.prod.yml --env-file .env.production restart backend
  
  # í„°ë¯¸ë„ ì§ì ‘ ì‹¤í–‰ ì‹œ
  # ë°±ì—”ë“œ í”„ë¡œì„¸ìŠ¤ ì¬ì‹œì‘
  ```
- ì™€ì¼ë“œì¹´ë“œ(`*`) ì‚¬ìš©ì€ ë³´ì•ˆìƒ ê¶Œì¥í•˜ì§€ ì•ŠìŒ
- HTTPSì™€ HTTPëŠ” ë‹¤ë¥¸ originìœ¼ë¡œ ì²˜ë¦¬ë¨
- [ ] **LLM í”„ë¡œë°”ì´ë” ì„¤ì •**

  ```bash
  # AWS Bedrock ì‚¬ìš© ì‹œ
  DEFAULT_LLM_PROVIDER=bedrock
  BEDROCK_LLM_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0
  BEDROCK_EMBEDDING_MODEL_ID=amazon.titan-embed-text-v2:0
  AWS_REGION=us-west-2
  # AWS ìê²©ì¦ëª…ì€ IAM Role ì‚¬ìš© ê¶Œì¥

  # Azure OpenAI ì‚¬ìš© ì‹œ
  DEFAULT_LLM_PROVIDER=azure_openai
  AZURE_OPENAI_API_KEY=<YOUR_KEY>
  AZURE_OPENAI_ENDPOINT=<YOUR_ENDPOINT>
  AZURE_OPENAI_LLM_DEPLOYMENT=gpt-4o-mini
  AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002
  ```
- [ ] **ìŠ¤í† ë¦¬ì§€ ì„¤ì •**

  ```bash
  # ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ (ê¸°ë³¸)
  STORAGE_BACKEND=local

  # AWS S3 ì‚¬ìš© ì‹œ
  STORAGE_BACKEND=s3
  AWS_S3_BUCKET=wkms-documents
  AWS_REGION=us-west-2

  # Azure Blob Storage ì‚¬ìš© ì‹œ
  STORAGE_BACKEND=azure_blob
  AZURE_STORAGE_ACCOUNT_NAME=<YOUR_ACCOUNT>
  AZURE_STORAGE_ACCOUNT_KEY=<YOUR_KEY>
  AZURE_STORAGE_CONTAINER=wkms-documents
  ```
- [ ] **Dockerfile í™•ì¸**

  - `backend/Dockerfile`: LibreOffice, Tesseract OCR í¬í•¨ âœ…
  - `frontend/Dockerfile`: Node 18 ê¸°ë°˜ âœ…
  - `postgres/Dockerfile`: pgvector í™•ì¥ í¬í•¨ âœ…

### 2.3 ë°°í¬ ë‹¨ê³„

#### **ğŸ¯ ì´ˆê¸° ë°°í¬ ì™„ì „ ê°€ì´ë“œ (ìƒˆ ì„œë²„ ì²« ë°°í¬)**

**ë°°í¬ ìˆœì„œ ê°œìš”**:
```
1. í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
   â†“
2. PostgreSQL ì»¨í…Œì´ë„ˆ ì‹œì‘
   â†“ (healthcheck ëŒ€ê¸°)
3. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¥ ì„¤ì¹˜ (init.sql ìë™ ì‹¤í–‰)
   â†“
4. Redis ì»¨í…Œì´ë„ˆ ì‹œì‘
   â†“
5. Backend ì»¨í…Œì´ë„ˆ ì‹œì‘
   â†“ (depends_on: postgres healthy)
6. Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ (í…Œì´ë¸” ìƒì„±)
   â†“
7. ì´ˆê¸° ë°ì´í„° ì ì¬ (init_simple_database.py)
   â†“
8. Frontend ì»¨í…Œì´ë„ˆ ì‹œì‘
   â†“
9. Nginx ì»¨í…Œì´ë„ˆ ì‹œì‘
```

#### **1ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ë° ë™ê¸°í™”**

```bash
cd /home/wjadmin/Dev/InsightBridge

# 1-1. í™˜ê²½ ë³€ìˆ˜ ë™ê¸°í™” ê²€ì¦
./shell-script/sync-check-env.sh

# 1-2. ëˆ„ë½ëœ KEYê°€ ìˆìœ¼ë©´ ìë™ ë™ê¸°í™”
./shell-script/sync-env-keys.sh

# 1-3. ë°°í¬ í™˜ê²½ ê²€ì¦ (í•„ìˆ˜ ë³€ìˆ˜ í™•ì¸)
./shell-script/validate-env.sh

# 1-4. .env.production ìˆ˜ì • (ìƒˆ ì„œë²„ IP/ë„ë©”ì¸)
vi .env.production
# CORS_ORIGINS ìˆ˜ì •:
# CORS_ORIGINS=["http://192.168.1.100:3000","http://192.168.1.100"]

# 1-5. frontend/.env ìˆ˜ì • (API URL)
vi frontend/.env
# REACT_APP_API_URL=http://192.168.1.100:8000
```

#### **2ë‹¨ê³„: ì´ë¯¸ì§€ ë¹Œë“œ**

```bash
# ê°œë°œ í™˜ê²½ ë¹Œë“œ
docker-compose build

# í”„ë¡œë•ì…˜ í™˜ê²½ ë¹Œë“œ
docker-compose -f docker-compose.yml -f docker-compose.prod.yml build

# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ë¹Œë“œ
docker-compose build backend
docker-compose build frontend
```

#### **3ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ì‹œì‘ ë° ì´ˆê¸°í™”**

**ì»¨í…Œì´ë„ˆ ì‹œì‘ ìˆœì„œ (ìë™)**:

Docker Composeê°€ `depends_on`ê³¼ `healthcheck`ë¥¼ í†µí•´ ìˆœì„œë¥¼ ë³´ì¥í•©ë‹ˆë‹¤:

```yaml
# docker-compose.yml êµ¬ì„±
services:
  postgres:
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U wkms -d wkms"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 30s  # ì´ˆê¸° ì‹œì‘ ëŒ€ê¸° 30ì´ˆ
    volumes:
      - ./postgres/init.sql:/docker-entrypoint-initdb.d/init.sql  # â­ ìë™ ì‹¤í–‰!
  
  backend:
    depends_on:
      postgres:
        condition: service_healthy  # â­ postgresê°€ healthy ìƒíƒœê°€ ë  ë•Œê¹Œì§€ ëŒ€ê¸°!
      redis:
        condition: service_started
```

**PostgreSQL ì´ˆê¸°í™” ì ˆì°¨ (ìë™)**:

```bash
# 1. PostgreSQL ì»¨í…Œì´ë„ˆ ì‹œì‘
# 2. /docker-entrypoint-initdb.d/init.sql ìë™ ì‹¤í–‰ (ìµœì´ˆ 1íšŒë§Œ)
#    - pgvector í™•ì¥ ì„¤ì¹˜
#    - textsearch_ko (Mecab) í™•ì¥ ì„¤ì¹˜
#    - pg_trgm í™•ì¥ ì„¤ì¹˜
#    - kor_search í™•ì¥ ì„¤ì¹˜
#    - ê¸°ë³¸ ë‹¨ì–´ ë°ì´í„° ì‚½ì…
# 3. healthcheck í†µê³¼ (pg_isready ì„±ê³µ)
# 4. ë‹¤ìŒ ë‹¨ê³„(backend) ì§„í–‰
```

**`postgres/init.sql` ì£¼ìš” ë‚´ìš©**:
```sql
-- í™•ì¥ ì„¤ì¹˜
CREATE EXTENSION IF NOT EXISTS vector;           -- pgvector (ë²¡í„° ê²€ìƒ‰)
CREATE EXTENSION IF NOT EXISTS textsearch_ko;    -- Mecab í•œêµ­ì–´ í˜•íƒœì†Œ ë¶„ì„
CREATE EXTENSION IF NOT EXISTS pg_trgm;          -- Trigram ìœ ì‚¬ë„ ê²€ìƒ‰
CREATE EXTENSION IF NOT EXISTS kor_search;       -- í•œêµ­ì–´ ê²€ìƒ‰ ìµœì í™”

-- ê¸°ë³¸ ê²€ìƒ‰ ë‹¨ì–´ ë°ì´í„°
INSERT INTO kor_search_word_transform (keyword) VALUES 
  ('ai'), ('ml'), ('python'), ('react'), ...;

-- ìœ ì‚¬ì–´ ë§¤í•‘
INSERT INTO kor_search_word_synonyms (keyword_id, synonym) VALUES
  ('ai', 'ì¸ê³µì§€ëŠ¥'), ('ml', 'ë¨¸ì‹ ëŸ¬ë‹'), ...;
```

#### **4ë‹¨ê³„: Backend ì´ˆê¸°í™” (ìë™)**

**Backend ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ìë™ ì‹¤í–‰** (`backend/start_with_init.sh`):

```bash
#!/bin/bash
# 1. PostgreSQL ì—°ê²° ëŒ€ê¸° (asyncpg ì—°ê²° í…ŒìŠ¤íŠ¸)
echo "â³ Waiting for PostgreSQL to be ready..."
# â†’ postgres ì»¨í…Œì´ë„ˆì˜ healthcheckê°€ í†µê³¼ë˜ë©´ ìë™ ì§„í–‰

# 2. ìŠ¤í‚¤ë§ˆ í™•ì¸ (tb_user í…Œì´ë¸” ì¡´ì¬ ì—¬ë¶€)
echo "ğŸ” Checking schema (tb_user exists?)"
if [ tb_user ì—†ìŒ ]; then
  # 3. Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ (í…Œì´ë¸” ìƒì„±)
  echo "ğŸ“‹ tb_user not found â†’ running Alembic migrations"
  alembic upgrade head
fi

# 4. ì´ˆê¸° ë°ì´í„° í™•ì¸ (ë¹ˆ í…Œì´ë¸” ê²€ì‚¬)
echo "ğŸ“Š Table counts: users=0, roles=0, ..."
if [ í•„ìˆ˜ í…Œì´ë¸”ì´ ë¹„ì–´ìˆìŒ ]; then
  # 5. ì´ˆê¸° ë°ì´í„° ì ì¬
  echo "ğŸ“Š Running data initialization (init_simple_database.py)..."
  python init_simple_database.py
  # â†’ CSV íŒŒì¼ ë¡œë“œ:
  #    - data/csv/common_codes.csv (ê³µí†µ ì½”ë“œ)
  #    - data/csv/sap_hr_info.csv (HR ë°ì´í„°)
  #    - data/csv/users.csv (ì‚¬ìš©ì)
  #    - data/csv/user_roles.csv (ì—­í• )
  #    - data/csv/knowledge_categories.csv (ì§€ì‹ ì¹´í…Œê³ ë¦¬)
fi

# 6. FastAPI ì„œë²„ ì‹œì‘
echo "ğŸš€ Starting FastAPI (Uvicorn)"
exec python -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**ì´ˆê¸° ë°ì´í„° ì ì¬ ëŒ€ìƒ í…Œì´ë¸”**:
- `tb_cmns_cd_grp_item` (ê³µí†µ ì½”ë“œ)
- `tb_sap_hr_info` (SAP HR ì •ë³´)
- `tb_user` (ì‚¬ìš©ì)
- `tb_user_roles` (ì—­í• )
- `tb_user_permissions` (ê¶Œí•œ)
- `tb_knowledge_categories` (ì§€ì‹ ì¹´í…Œê³ ë¦¬)

**ê°•ì œ ì¬ì´ˆê¸°í™”** (í•„ìš” ì‹œ):
```bash
# FORCE_DB_SEED=true ì„¤ì • ì‹œ í…Œì´ë¸” ë°ì´í„°ê°€ ìˆì–´ë„ ê°•ì œ ì‹œë”©
docker-compose down
export FORCE_DB_SEED=true
docker-compose --env-file .env.production up -d backend
```

#### **5ë‹¨ê³„: ì „ì²´ ì„œë¹„ìŠ¤ ì‹œì‘ ë° ê²€ì¦**

```bash
# ê°œë°œ í™˜ê²½ ì‹œì‘
docker-compose up -d

# í”„ë¡œë•ì…˜ í™˜ê²½ ì‹œì‘
docker-compose -f docker-compose.yml -f docker-compose.prod.yml --env-file .env.production up -d

# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸ (ì „ì²´)
docker-compose logs -f

# ì„œë¹„ìŠ¤ë³„ ë¡œê·¸ í™•ì¸
docker-compose logs -f postgres   # ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™” ë¡œê·¸
docker-compose logs -f backend    # Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ + ë°ì´í„° ì‹œë”© ë¡œê·¸
docker-compose logs -f frontend
docker-compose logs -f nginx
```

**ë¡œê·¸ì—ì„œ í™•ì¸í•´ì•¼ í•  ë‚´ìš©**:

```bash
# postgres ë¡œê·¸
âœ… "database system is ready to accept connections"
âœ… "CREATE EXTENSION IF NOT EXISTS vector"
âœ… "CREATE EXTENSION IF NOT EXISTS textsearch_ko"

# backend ë¡œê·¸
âœ… "â³ Waiting for PostgreSQL to be ready..."
âœ… "âœ… PostgreSQL is ready"
âœ… "ğŸ“‹ tb_user not found â†’ running Alembic migrations"  # ìµœì´ˆ ë°°í¬ ì‹œë§Œ
âœ… "âœ… Alembic migration complete"
âœ… "ğŸ“Š Running data initialization (init_simple_database.py)..."
âœ… "âœ… ê³µí†µ ì½”ë“œ ë°ì´í„° ë¡œë”© ì™„ë£Œ"
âœ… "âœ… SAP HR ë°ì´í„° ë¡œë”© ì™„ë£Œ"
âœ… "âœ… ì‚¬ìš©ì ë°ì´í„° ë¡œë”© ì™„ë£Œ"
âœ… "ğŸš€ Starting FastAPI (Uvicorn)"
âœ… "Application startup complete"

# frontend ë¡œê·¸
âœ… "webpack compiled successfully"
âœ… "Compiled successfully!"

# nginx ë¡œê·¸
âœ… "start worker processes"
```

#### **6ë‹¨ê³„: ë°°í¬ ê²€ì¦**

```bash
# 1. ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps
# ëª¨ë“  ì„œë¹„ìŠ¤ê°€ "Up" ìƒíƒœì—¬ì•¼ í•¨

# 2. í—¬ìŠ¤ ì²´í¬
curl http://localhost:8000/health
# ì˜ˆìƒ ì‘ë‹µ: {"status": "healthy"}

# 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
docker-compose exec backend python -c "
from app.core.database import get_async_engine
import asyncio
async def test():
    engine = get_async_engine()
    async with engine.begin() as conn:
        result = await conn.execute('SELECT 1')
        print('âœ… Database connection OK')
asyncio.run(test())
"

# 4. ì´ˆê¸° ë°ì´í„° í™•ì¸
docker-compose exec postgres psql -U wkms -d wkms -c "
SELECT 
  (SELECT COUNT(*) FROM tb_user) as users,
  (SELECT COUNT(*) FROM tb_user_roles) as roles,
  (SELECT COUNT(*) FROM tb_knowledge_categories) as categories;
"
# ì˜ˆìƒ ê²°ê³¼: users > 0, roles > 0, categories > 0

# 5. í”„ë¡ íŠ¸ì—”ë“œ ì ‘ì†
curl http://localhost:3000
# HTTP 200 ì‘ë‹µ í™•ì¸

# 6. ë°±ì—”ë“œ API ë¬¸ì„œ
curl http://localhost:8000/docs
# Swagger UI ì ‘ì† í™•ì¸
```

#### **7ë‹¨ê³„: ë¬¸ì œ í•´ê²°**

**ë¬¸ì œ 1: postgres ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ**
```bash
# ë¡œê·¸ í™•ì¸
docker-compose logs postgres

# ì¼ë°˜ì ì¸ ì›ì¸:

# - í¬íŠ¸ 5432 ì´ë¯¸ ì‚¬ìš© ì¤‘ â†’ sudo netstat -tulnp | grep 5432

# - ë³¼ë¥¨ ê¶Œí•œ ë¬¸ì œ â†’ sudo chown -R 999:999 /var/lib/docker/volumes/...

# - ë©”ëª¨ë¦¬ ë¶€ì¡± â†’ free -h

```

**ë¬¸ì œ 2: backendê°€ postgresë¥¼ ì°¾ì§€ ëª»í•¨**
```

bash
# depends_onì´ ì œëŒ€ë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
docker-compose config | grep -A 10 "depends_on"

# healthcheck ìƒíƒœ í™•ì¸

docker inspect wkms-postgres | grep -A 5 "Health"

# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸

docker-compose exec backend ping postgres
```

**ë¬¸ì œ 3: ì´ˆê¸° ë°ì´í„°ê°€ ì ì¬ë˜ì§€ ì•ŠìŒ**
```bash
# backend ë¡œê·¸ì—ì„œ ì‹œë”© ë¡œê·¸ í™•ì¸
docker-compose logs backend | grep "ë°ì´í„° ë¡œë”©"

# CSV íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

docker-compose exec backend ls -la /app/data/csv/

# ê°•ì œ ì¬ì‹œë”©

docker-compose down
docker-compose up -d postgres redis
# postgresê°€ ì™„ì „íˆ ì‹œì‘ë  ë•Œê¹Œì§€ ëŒ€ê¸° (30ì´ˆ)
sleep 30
FORCE_DB_SEED=true docker-compose up -d backend
docker-compose logs -f backend
```

**ë¬¸ì œ 4: frontendê°€ backendì— ì—°ê²°ë˜ì§€ ì•ŠìŒ**
```bash
# 1. frontend/.env í™•ì¸
docker-compose exec frontend cat /app/.env | grep API_URL

# 2. CORS ì„¤ì • í™•ì¸

docker-compose exec backend python -c "
import os
print(os.getenv('CORS_ORIGINS'))
"

# 3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í…ŒìŠ¤íŠ¸

docker-compose exec frontend curl http://backend:8000/health
```

---

### 2.4 í”„ë¡œë•ì…˜ ë°°í¬ (`docker-compose.prod.yml`)

**íŒŒì¼ ìœ„ì¹˜**: `/home/wjadmin/Dev/InsightBridge/docker-compose.prod.yml`

**ì£¼ìš” ì°¨ì´ì **:
- **í”„ë¡ íŠ¸ì—”ë“œ**: í”„ë¡œë•ì…˜ ë¹Œë“œ (`npm run build`)
- **Nginx**: SSL/TLS ì„¤ì • í¬í•¨
- **ë¦¬ì†ŒìŠ¤ ì œí•œ**: CPU/ë©”ëª¨ë¦¬ ì œí•œ ì„¤ì •
- **ì¬ì‹œì‘ ì •ì±…**: `restart: always`

**ì‹¤í–‰ ë°©ë²•**:
```bash
# í”„ë¡œë•ì…˜ ëª¨ë“œë¡œ ì‹œì‘
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# ë˜ëŠ” override íŒŒì¼ ì‚¬ìš©

docker-compose -f docker-compose.yml -f docker-compose.override.yml up -d
```

### 2.5 Docker Compose ì£¼ìš” ì´ìŠˆ ë° í•´ê²°ì±…

| ì´ìŠˆ            | ì›ì¸                | í•´ê²°ì±…                            | ìš°ì„ ìˆœìœ„  |
| ------------- | ----------------- | ------------------------------ | ----- |
| **ì‹œí¬ë¦¿ ë…¸ì¶œ**    | .env íŒŒì¼ì— í‰ë¬¸ ì €ì¥    | Docker Secrets ì‚¬ìš© ë˜ëŠ” ì™¸ë¶€ ì‹œí¬ë¦¿ ê´€ë¦¬ | ğŸ”´ ë†’ìŒ |
| **ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ ì œí•œ** | Docker Compose íŠ¹ì„± | Kubernetesë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜             | ğŸŸ¡ ì¤‘ê°„ |
| **ìˆ˜ë™ ë°±ì—…**     | ìë™í™” ë¶€ì¬            | Cron ì‘ì—… + ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±              | ğŸŸ¡ ì¤‘ê°„ |
| **ëª¨ë‹ˆí„°ë§ ë¶€ì¬**   | ì„¤ì • ì—†ìŒ             | Prometheus + Grafana ì¶”ê°€        | ğŸŸ¢ ë‚®ìŒ |
| **ë¡œê·¸ ê´€ë¦¬**     | í‘œì¤€ ì¶œë ¥ë§Œ ì‚¬ìš©         | ELK Stack ë˜ëŠ” Fluentd ì¶”ê°€        | ğŸŸ¢ ë‚®ìŒ |

---

## 3. Kubernetes ë°°í¬ (ê³µí†µ)

### 3.1 í˜„ì¬ êµ¬ì„± ìƒíƒœ

**ë””ë ‰í† ë¦¬**: `/home/wjadmin/Dev/InsightBridge/k8s/`

**ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼**:
```
k8s/
â”œâ”€â”€ 00-namespace-config.yaml      # ë„¤ì„ìŠ¤í˜ì´ìŠ¤, ConfigMap, Secret
â”œâ”€â”€ 01-backend.yaml                # ë°±ì—”ë“œ Deployment + Service
â”œâ”€â”€ 02-frontend.yaml               # í”„ë¡ íŠ¸ì—”ë“œ Deployment + Service
â”œâ”€â”€ 03-ingress.yaml                # Ingress ì„¤ì •
â”œâ”€â”€ 04-database.yaml               # PostgreSQL StatefulSet + Redis
â”œâ”€â”€ 05-eks-specific.yaml           # EKS ì „ìš© (ALB, gp3 StorageClass)
â”œâ”€â”€ 06-aks-specific.yaml           # AKS ì „ìš© (App Gateway, Managed Disk)
â””â”€â”€ deployment-guides/             # í´ë¼ìš°ë“œë³„ ë°°í¬ ê°€ì´ë“œ
```

### 3.2 ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### âœ… **Kubernetes í´ëŸ¬ìŠ¤í„° í™•ì¸**

- [ ] **í´ëŸ¬ìŠ¤í„° ì ‘ê·¼ í™•ì¸**

  ```bash
  kubectl cluster-info
  kubectl get nodes
  kubectl version --short
  ```
- [ ] **í•„ìš”í•œ ê¶Œí•œ í™•ì¸**

  ```bash
  # ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„± ê¶Œí•œ
  kubectl auth can-i create namespace

  # ë¦¬ì†ŒìŠ¤ ìƒì„± ê¶Œí•œ
  kubectl auth can-i create deployment -n wkms
  kubectl auth can-i create service -n wkms
  kubectl auth can-i create ingress -n wkms
  ```

#### âœ… **ConfigMap ë° Secret ì¤€ë¹„**

**`00-namespace-config.yaml` ìˆ˜ì •**:

```yaml
# ConfigMap ì„¤ì • (ë¯¼ê°í•˜ì§€ ì•Šì€ ì •ë³´)
apiVersion: v1
kind: ConfigMap
metadata:
  name: wkms-config
  namespace: wkms
data:
  DATABASE_URL: "postgresql+asyncpg://wkms:CHANGE_ME@wkms-postgres:5432/wkms"
  REDIS_URL: "redis://wkms-redis:6379"
  CORS_ORIGINS: '["https://your-domain.com"]'
  ENVIRONMENT: "production"
  DEFAULT_LLM_PROVIDER: "bedrock"  # bedrock | azure_openai | openai
  STORAGE_BACKEND: "s3"  # local | s3 | azure_blob
  
  # AWS ì„¤ì • (EKS ì‚¬ìš© ì‹œ)
  AWS_REGION: "us-west-2"
  
  # í”„ë¡ íŠ¸ì—”ë“œ ì„¤ì •
  REACT_APP_API_URL: "https://api.your-domain.com"
  REACT_APP_ENV: "production"

---
# Secret ì„¤ì • (ë¯¼ê° ì •ë³´ - Base64 ì¸ì½”ë”© í•„ìš”)
apiVersion: v1
kind: Secret
metadata:
  name: wkms-secrets
  namespace: wkms
type: Opaque
data:
  postgres-password: <BASE64_ENCODED>  # echo -n "your_password" | base64
  jwt-secret-key: <BASE64_ENCODED>
  secret-key: <BASE64_ENCODED>
  
  # LLM í”„ë¡œë°”ì´ë”ë³„ ì‹œí¬ë¦¿
  azure-openai-api-key: <BASE64_ENCODED>
  openai-api-key: <BASE64_ENCODED>
  
  # ìŠ¤í† ë¦¬ì§€ ì‹œí¬ë¦¿
  aws-access-key-id: <BASE64_ENCODED>
  aws-secret-access-key: <BASE64_ENCODED>
  azure-storage-account-key: <BASE64_ENCODED>
```

**Secret ìƒì„± ë„ìš°ë¯¸**:
```bash
# Base64 ì¸ì½”ë”©
echo -n "your_secret_value" | base64

# ë˜ëŠ” kubectlë¡œ ì§ì ‘ ìƒì„±

kubectl create secret generic wkms-secrets \
  --from-literal=postgres-password=YOUR_PASSWORD \
  --from-literal=jwt-secret-key=YOUR_JWT_SECRET \
  --from-literal=secret-key=YOUR_SECRET_KEY \
  -n wkms
```

#### âœ… **ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ í™•ì¸**

```bash
# ì‚¬ìš© ê°€ëŠ¥í•œ ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ í™•ì¸
kubectl get storageclass

# EKS: gp3 (ê¶Œì¥) ë˜ëŠ” gp2
# AKS: managed-csi (ê¸°ë³¸)
# GKE: standard ë˜ëŠ” pd-ssd
```

**`04-database.yaml`ì—ì„œ ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ ì„¤ì •**:
```yaml
volumeClaimTemplates:
- metadata:
    name: postgres-storage
  spec:
    accessModes: ["ReadWriteOnce"]
    storageClassName: "gp3"  # EKSìš©
    # storageClassName: "managed-csi"  # AKSìš©
    resources:
      requests:
        storage: 20Gi
```

### 3.3 ë°°í¬ ë‹¨ê³„

#### **1ë‹¨ê³„: ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° ê¸°ë³¸ ì„¤ì •**

```bash
cd /home/wjadmin/Dev/InsightBridge/k8s

# ë„¤ì„ìŠ¤í˜ì´ìŠ¤, ConfigMap, Secret ìƒì„±
kubectl apply -f 00-namespace-config.yaml

# í™•ì¸
kubectl get namespace wkms
kubectl get configmap -n wkms
kubectl get secret -n wkms
```

#### **2ë‹¨ê³„: ë°ì´í„°ë² ì´ìŠ¤ ë°°í¬**

```bash
# PostgreSQL + Redis ë°°í¬
kubectl apply -f 04-database.yaml

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl get statefulset -n wkms
kubectl get pods -n wkms -l app=wkms-postgres

# ë¡œê·¸ í™•ì¸
kubectl logs -n wkms wkms-postgres-0

# PostgreSQL í—¬ìŠ¤ ì²´í¬
kubectl exec -n wkms wkms-postgres-0 -- pg_isready -U wkms
```

#### **3ë‹¨ê³„: ë°±ì—”ë“œ ë°°í¬**

```bash
# ë°±ì—”ë“œ Deployment ë°°í¬
kubectl apply -f 01-backend.yaml

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl get deployment -n wkms
kubectl get pods -n wkms -l app=wkms-backend

# ë¡œê·¸ í™•ì¸
kubectl logs -n wkms -l app=wkms-backend -f

# ì„œë¹„ìŠ¤ í™•ì¸
kubectl get svc -n wkms wkms-backend
```

#### **4ë‹¨ê³„: í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬**

```bash
# í”„ë¡ íŠ¸ì—”ë“œ Deployment ë°°í¬
kubectl apply -f 02-frontend.yaml

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl get deployment -n wkms
kubectl get pods -n wkms -l app=wkms-frontend

# ì„œë¹„ìŠ¤ í™•ì¸
kubectl get svc -n wkms wkms-frontend
```

#### **5ë‹¨ê³„: Ingress ì„¤ì •**

```bash
# Ingress ë°°í¬
kubectl apply -f 03-ingress.yaml

# Ingress í™•ì¸
kubectl get ingress -n wkms
kubectl describe ingress -n wkms wkms-ingress

# ì™¸ë¶€ IP í™•ì¸ (ë¡œë“œ ë°¸ëŸ°ì„œ í”„ë¡œë¹„ì €ë‹ ëŒ€ê¸°)
kubectl get ingress -n wkms -w
```

### 3.4 í—¬ìŠ¤ ì²´í¬ ë° ê²€ì¦

```bash
# ëª¨ë“  ë¦¬ì†ŒìŠ¤ í™•ì¸
kubectl get all -n wkms

# Pod ìƒíƒœ í™•ì¸
kubectl get pods -n wkms

# ë°±ì—”ë“œ í—¬ìŠ¤ ì²´í¬
kubectl port-forward -n wkms svc/wkms-backend 8000:8000
curl http://localhost:8000/health

# í”„ë¡ íŠ¸ì—”ë“œ ì ‘ê·¼ í…ŒìŠ¤íŠ¸
kubectl port-forward -n wkms svc/wkms-frontend 3000:80
curl http://localhost:3000

# ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
kubectl logs -n wkms -l app=wkms-backend -f --tail=100
```

### 3.5 Kubernetes ì£¼ìš” ì´ìŠˆ ë° í•´ê²°ì±…

| ì´ìŠˆ                      | ì›ì¸                | í•´ê²°ì±…                 | ìš°ì„ ìˆœìœ„  |
| ----------------------- | ----------------- | ------------------- | ----- |
| **ImagePullBackOff**    | ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì ‘ê·¼ ë¶ˆê°€   | ImagePullSecrets ì„¤ì • | ğŸ”´ ë†’ìŒ |
| **CrashLoopBackOff**    | ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹¤íŒ¨        | ë¡œê·¸ í™•ì¸, í™˜ê²½ë³€ìˆ˜ ê²€ì¦      | ğŸ”´ ë†’ìŒ |
| **Pending Pod**         | ë¦¬ì†ŒìŠ¤ ë¶€ì¡± ë˜ëŠ” ìŠ¤í† ë¦¬ì§€ ë¬¸ì œ | ë…¸ë“œ í™•ì¥, PVC í™•ì¸       | ğŸ”´ ë†’ìŒ |
| **Service Unreachable** | ë„¤íŠ¸ì›Œí¬ ì •ì±… ë˜ëŠ” DNS ë¬¸ì œ | ë„¤íŠ¸ì›Œí¬ ì •ì±… í™•ì¸, DNS í…ŒìŠ¤íŠ¸ | ğŸŸ¡ ì¤‘ê°„ |
| **Ingress 404**         | Ingress ê·œì¹™ ì˜¤ë¥˜     | Ingress ì„¤ì • ê²€ì¦       | ğŸŸ¡ ì¤‘ê°„ |

---

## 4. AWS EKS ë°°í¬

### 4.1 EKS ì „ìš© ì„¤ì •

**íŒŒì¼**: `/home/wjadmin/Dev/InsightBridge/k8s/05-eks-specific.yaml`

**ì£¼ìš” íŠ¹ì§•**:
- **ALB Ingress Controller**: AWS Application Load Balancer í†µí•©
- **gp3 ìŠ¤í† ë¦¬ì§€**: ê³ ì„±ëŠ¥ EBS ë³¼ë¥¨ (IOPS 3000, Throughput 125MB/s)
- **IAM ì—­í•  ê¸°ë°˜ ì¸ì¦**: AWS ì„œë¹„ìŠ¤ ì ‘ê·¼ (S3, Bedrock, RDS ë“±)
- **CloudWatch í†µí•©**: ë¡œê·¸ ë° ë©”íŠ¸ë¦­ ìˆ˜ì§‘

### 4.2 EKS ë°°í¬ ì „ ì¤€ë¹„

#### âœ… **1. EKS í´ëŸ¬ìŠ¤í„° ìƒì„±**

```bash
# eksctl ì‚¬ìš© (ê¶Œì¥)
eksctl create cluster \
  --name wkms-cluster \
  --region us-west-2 \
  --node-type t3.medium \
  --nodes 3 \
  --nodes-min 2 \
  --nodes-max 5 \
  --managed \
  --version 1.28

# í´ëŸ¬ìŠ¤í„° í™•ì¸
kubectl cluster-info
kubectl get nodes
```

#### âœ… **2. IAM ì—­í•  ë° ì •ì±… ì„¤ì •**

**Bedrock ì ‘ê·¼ ì •ì±…**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "bedrock:InvokeModel",
        "bedrock:InvokeModelWithResponseStream"
      ],
      "Resource": [
        "arn:aws:bedrock:*::foundation-model/*"
      ]
    }
  ]
}
```

**S3 ì ‘ê·¼ ì •ì±…**:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject",
        "s3:DeleteObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::wkms-documents/*",
        "arn:aws:s3:::wkms-documents"
      ]
    }
  ]
}
```

**IRSA (IAM Roles for Service Accounts) ì„¤ì •**:
```bash
# OIDC í”„ë¡œë°”ì´ë” ìƒì„±
eksctl utils associate-iam-oidc-provider \
  --cluster=wkms-cluster \
  --region=us-west-2 \
  --approve

# ì„œë¹„ìŠ¤ ê³„ì • ë° IAM ì—­í•  ìƒì„±

eksctl create iamserviceaccount \
  --name wkms-backend-sa \
  --namespace wkms \
  --cluster wkms-cluster \
  --region us-west-2 \
  --attach-policy-arn arn:aws:iam::YOUR_ACCOUNT:policy/WKMSBedrockAccess \
  --attach-policy-arn arn:aws:iam::YOUR_ACCOUNT:policy/WKMSS3Access \
  --approve \
  --override-existing-serviceaccounts
```

**ë°±ì—”ë“œ Deploymentì— ì„œë¹„ìŠ¤ ê³„ì • ì¶”ê°€**:
```yaml
# 01-backend.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: wkms-backend
spec:
  template:
    spec:
      serviceAccountName: wkms-backend-sa  # â† ì¶”ê°€
      containers:
      - name: backend
        ...
```

#### âœ… **3. ALB Ingress Controller ì„¤ì¹˜**

```bash
# Helm ì°¨íŠ¸ë¡œ ì„¤ì¹˜
helm repo add eks https://aws.github.io/eks-charts
helm repo update

helm install aws-load-balancer-controller eks/aws-load-balancer-controller \
  -n kube-system \
  --set clusterName=wkms-cluster \
  --set serviceAccount.create=false \
  --set serviceAccount.name=aws-load-balancer-controller

# í™•ì¸
kubectl get deployment -n kube-system aws-load-balancer-controller
```

#### âœ… **4. gp3 ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ ì„¤ì •**

```bash
# 05-eks-specific.yamlì— í¬í•¨ë¨
kubectl apply -f 05-eks-specific.yaml

# StorageClass í™•ì¸
kubectl get storageclass wkms-gp3
```

#### âœ… **5. ACM ì¸ì¦ì„œ ì¤€ë¹„**

```bash
# AWS Certificate Managerì—ì„œ ì¸ì¦ì„œ ë°œê¸‰
aws acm request-certificate \
  --domain-name your-domain.com \
  --subject-alternative-names "*.your-domain.com" \
  --validation-method DNS \
  --region us-west-2

# ARN í™•ì¸
aws acm list-certificates --region us-west-2
```

**Ingressì— ì¸ì¦ì„œ ARN ì„¤ì •**:
```yaml
# 05-eks-specific.yaml
metadata:
  annotations:
    alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-west-2:ACCOUNT:certificate/xxx
```

### 4.3 EKS ë°°í¬ ì‹¤í–‰

```bash
# 1. ì¼ë°˜ Kubernetes ë¦¬ì†ŒìŠ¤ ë°°í¬
kubectl apply -f 00-namespace-config.yaml
kubectl apply -f 04-database.yaml
kubectl apply -f 01-backend.yaml
kubectl apply -f 02-frontend.yaml

# 2. EKS ì „ìš© ë¦¬ì†ŒìŠ¤ ë°°í¬
kubectl apply -f 05-eks-specific.yaml

# 3. ALB ìƒì„± í™•ì¸ (ëª‡ ë¶„ ì†Œìš”)
kubectl get ingress -n wkms wkms-ingress-alb -w

# 4. ALB DNS ì´ë¦„ í™•ì¸
kubectl get ingress -n wkms wkms-ingress-alb \
  -o jsonpath='{.status.loadBalancer.ingress[0].hostname}'
```

### 4.4 EKS ëª¨ë‹ˆí„°ë§ ì„¤ì •

#### **CloudWatch Container Insights í™œì„±í™”**

```bash
# Fluent Bit ì„¤ì¹˜
ClusterName=wkms-cluster
RegionName=us-west-2
FluentBitHttpPort='2020'
FluentBitReadFromHead='Off'

curl https://raw.githubusercontent.com/aws-samples/amazon-cloudwatch-container-insights/latest/k8s-deployment-manifest-templates/deployment-mode/daemonset/container-insights-monitoring/quickstart/cwagent-fluent-bit-quickstart.yaml | \
  sed "s/{{cluster_name}}/${ClusterName}/;s/{{region_name}}/${RegionName}/;s/{{http_server_toggle}}/\"On\"/;s/{{http_server_port}}/\"${FluentBitHttpPort}\"/;s/{{read_from_head}}/\"${FluentBitReadFromHead}\"/;s/{{read_from_tail}}/\"On\"/" | \
  kubectl apply -f -
```

### 4.5 EKS ë¹„ìš© ìµœì í™”

| í•­ëª©               | ê¸°ë³¸ ì„¤ì •     | ìµœì í™” ì„¤ì •                         | ë¹„ìš© ì ˆê°  |
| ---------------- | --------- | ------------------------------ | ------ |
| **ë…¸ë“œ íƒ€ì…**        | t3.medium | t3.small (ê°œë°œ) / t3.medium (ìš´ì˜) | 30-50% |
| **ìŠ¤í† ë¦¬ì§€**         | gp2       | gp3                            | 20%    |
| **ë¡œë“œ ë°¸ëŸ°ì„œ**       | ALB       | ALB + NLB (ë‚´ë¶€ íŠ¸ë˜í”½)             | 10-20% |
| **Auto Scaling** | ê³ ì • ë…¸ë“œ     | Cluster Autoscaler + HPA       | 20-40% |
| **Spot ì¸ìŠ¤í„´ìŠ¤**    | ë¯¸ì‚¬ìš©       | í˜¼í•© ì‚¬ìš© (80% Spot)               | 50-70% |

---

## 5. Azure AKS ë°°í¬

### 5.1 AKS ì „ìš© ì„¤ì •

**íŒŒì¼**: `/home/wjadmin/Dev/InsightBridge/k8s/06-aks-specific.yaml`

**ì£¼ìš” íŠ¹ì§•**:
- **Application Gateway Ingress**: Azure Application Gateway í†µí•©
- **Managed Disk CSI**: ê³ ì„±ëŠ¥ í”„ë¦¬ë¯¸ì—„ SSD
- **Managed Identity**: Azure ë¦¬ì†ŒìŠ¤ ì¸ì¦
- **Azure Monitor í†µí•©**: Container Insights

### 5.2 AKS ë°°í¬ ì „ ì¤€ë¹„

#### âœ… **1. AKS í´ëŸ¬ìŠ¤í„° ìƒì„±**

```bash
# ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ ìƒì„±
az group create --name wkms-rg --location koreacentral

# AKS í´ëŸ¬ìŠ¤í„° ìƒì„±
az aks create \
  --resource-group wkms-rg \
  --name wkms-cluster \
  --node-count 3 \
  --node-vm-size Standard_D2s_v3 \
  --enable-managed-identity \
  --enable-addons monitoring \
  --generate-ssh-keys

# ìê²©ì¦ëª… ê°€ì ¸ì˜¤ê¸°
az aks get-credentials --resource-group wkms-rg --name wkms-cluster

# í™•ì¸
kubectl cluster-info
kubectl get nodes
```

#### âœ… **2. Managed Identity ì„¤ì •**

**Azure OpenAI ì ‘ê·¼ ê¶Œí•œ**:
```bash
# í´ëŸ¬ìŠ¤í„° Managed Identity í™•ì¸
CLUSTER_IDENTITY=$(az aks show -g wkms-rg -n wkms-cluster --query identityProfile.kubeletidentity.objectId -o tsv)

# Azure OpenAI ë¦¬ì†ŒìŠ¤ì— Cognitive Services User ì—­í•  ë¶€ì—¬

az role assignment create \
  --assignee $CLUSTER_IDENTITY \
  --role "Cognitive Services User" \
  --scope /subscriptions/YOUR_SUBSCRIPTION/resourceGroups/YOUR_RG/providers/Microsoft.CognitiveServices/accounts/YOUR_OPENAI
```

**Azure Blob Storage ì ‘ê·¼ ê¶Œí•œ**:
```bash
# Storage Blob Data Contributor ì—­í•  ë¶€ì—¬
az role assignment create \
  --assignee $CLUSTER_IDENTITY \
  --role "Storage Blob Data Contributor" \
  --scope /subscriptions/YOUR_SUBSCRIPTION/resourceGroups/YOUR_RG/providers/Microsoft.Storage/storageAccounts/YOUR_STORAGE
```

#### âœ… **3. Application Gateway Ingress Controller ì„¤ì¹˜**

**ë°©ë²• 1: Addonìœ¼ë¡œ ì„¤ì¹˜ (ê¶Œì¥)**:
```bash
# Application Gateway ìƒì„±
az network public-ip create \
  -g wkms-rg \
  -n wkms-appgw-pip \
  --allocation-method Static \
  --sku Standard

az network application-gateway create \
  -g wkms-rg \
  -n wkms-appgw \
  --sku Standard_v2 \
  --capacity 2 \
  --public-ip-address wkms-appgw-pip \
  --vnet-name wkms-vnet \
  --subnet appgw-subnet

# AGIC Addon í™œì„±í™”

az aks enable-addons \
  -g wkms-rg \
  -n wkms-cluster \
  -a ingress-appgw \
  --appgw-id /subscriptions/YOUR_SUBSCRIPTION/resourceGroups/wkms-rg/providers/Microsoft.Network/applicationGateways/wkms-appgw
```

#### âœ… **4. Azure Monitor Container Insights í™œì„±í™”**

```bash
# ì´ë¯¸ --enable-addons monitoringìœ¼ë¡œ í™œì„±í™”ë¨
# Log Analytics Workspace ID í™•ì¸
az aks show -g wkms-rg -n wkms-cluster --query addonProfiles.omsagent.config.logAnalyticsWorkspaceResourceID
```

### 5.3 AKS ë°°í¬ ì‹¤í–‰

```bash
# 1. ì¼ë°˜ Kubernetes ë¦¬ì†ŒìŠ¤ ë°°í¬
kubectl apply -f 00-namespace-config.yaml
kubectl apply -f 04-database.yaml
kubectl apply -f 01-backend.yaml
kubectl apply -f 02-frontend.yaml

# 2. AKS ì „ìš© ë¦¬ì†ŒìŠ¤ ë°°í¬
kubectl apply -f 06-aks-specific.yaml

# 3. Application Gateway ìƒì„± í™•ì¸
kubectl get ingress -n wkms wkms-ingress-appgw -w

# 4. Public IP í™•ì¸
kubectl get ingress -n wkms wkms-ingress-appgw \
  -o jsonpath='{.status.loadBalancer.ingress[0].ip}'
```

### 5.4 AKS ë¹„ìš© ìµœì í™”

| í•­ëª©                      | ê¸°ë³¸ ì„¤ì •           | ìµœì í™” ì„¤ì •                   | ë¹„ìš© ì ˆê°  |
| ----------------------- | --------------- | ------------------------ | ------ |
| **ë…¸ë“œ VM**               | Standard_D2s_v3 | Standard_B2s (ê°œë°œ)        | 40-60% |
| **ìŠ¤í† ë¦¬ì§€**                | Premium SSD     | Standard SSD (ë¹„ì¤‘ìš” ì›Œí¬ë¡œë“œ)  | 30-50% |
| **Application Gateway** | Standard_v2     | Basic (ê°œë°œ/í…ŒìŠ¤íŠ¸)           | 50%    |
| **Auto Scaling**        | ê³ ì • ë…¸ë“œ           | Cluster Autoscaler + HPA | 20-40% |
| **Spot VM**             | ë¯¸ì‚¬ìš©             | Spot ë…¸ë“œ í’€ ì¶”ê°€             | 60-80% |

---

## 6. ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 6.1 ê³µí†µ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### âœ… **ë³´ì•ˆ**

- [ ] **ì‹œí¬ë¦¿ ê´€ë¦¬**

  - [ ] í™˜ê²½ ë³€ìˆ˜ì— í‰ë¬¸ ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ
  - [ ] Kubernetes Secret ë˜ëŠ” ì™¸ë¶€ ì‹œí¬ë¦¿ ê´€ë¦¬ ì‚¬ìš© (Vault, AWS Secrets Manager)
  - [ ] Secret íŒŒì¼ `.gitignore`ì— ì¶”ê°€ë¨
  - [ ] Base64 ì¸ì½”ë”© ì ìš©ë¨
- [ ] **ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ**

  - [ ] CORS ì„¤ì • í™•ì¸ (í—ˆìš© ë„ë©”ì¸ë§Œ í¬í•¨)
  - [ ] Ingressì— TLS/SSL ì¸ì¦ì„œ ì„¤ì •
  - [ ] ë°ì´í„°ë² ì´ìŠ¤ ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨ (ClusterIP)
  - [ ] Network Policy ì ìš© (í•„ìš” ì‹œ)
- [ ] **ì»¨í…Œì´ë„ˆ ë³´ì•ˆ**

  - [ ] ë¹„ ë£¨íŠ¸ ì‚¬ìš©ìë¡œ ì‹¤í–‰ (`runAsNonRoot: true`)
  - [ ] ì½ê¸° ì „ìš© íŒŒì¼ ì‹œìŠ¤í…œ (ê°€ëŠ¥í•œ ê²½ìš°)
  - [ ] ê¶Œí•œ ì—ìŠ¤ì»¬ë ˆì´ì…˜ ë¹„í™œì„±í™” (`allowPrivilegeEscalation: false`)
  - [ ] ë³´ì•ˆ ì»¨í…ìŠ¤íŠ¸ ì„¤ì •ë¨

#### âœ… **ë¦¬ì†ŒìŠ¤ ê´€ë¦¬**

- [ ] **ë¦¬ì†ŒìŠ¤ ì œí•œ**

  - [ ] CPU/ë©”ëª¨ë¦¬ requests ì„¤ì •
  - [ ] CPU/ë©”ëª¨ë¦¬ limits ì„¤ì •
  - [ ] ì ì ˆí•œ ë¦¬ì†ŒìŠ¤ í• ë‹¹ (ê³¼ë„/ë¶€ì¡± ì—†ìŒ)
- [ ] **ìŠ¤í† ë¦¬ì§€**

  - [ ] PVC í¬ê¸° ì ì ˆíˆ ì„¤ì • (20Gi ì´ìƒ ê¶Œì¥)
  - [ ] ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ ì„ íƒ (gp3, managed-csi ë“±)
  - [ ] ë°±ì—… ì •ì±… ìˆ˜ë¦½
  - [ ] `reclaimPolicy: Retain` ì„¤ì • (ë°ì´í„° ë³´í˜¸)

#### âœ… **ê³ ê°€ìš©ì„±**

- [ ] **ë ˆí”Œë¦¬ì¹´**

  - [ ] ë°±ì—”ë“œ ë ˆí”Œë¦¬ì¹´ 2ê°œ ì´ìƒ
  - [ ] í”„ë¡ íŠ¸ì—”ë“œ ë ˆí”Œë¦¬ì¹´ 2ê°œ ì´ìƒ
  - [ ] PostgreSQL StatefulSet (í”„ë¡œë•ì…˜: ê³ ê°€ìš©ì„± ì†”ë£¨ì…˜ ê³ ë ¤)
- [ ] **í—¬ìŠ¤ ì²´í¬**

  - [ ] Liveness Probe ì„¤ì •
  - [ ] Readiness Probe ì„¤ì •
  - [ ] ì ì ˆí•œ `initialDelaySeconds` ì„¤ì •
- [ ] **ìë™ ë³µêµ¬**

  - [ ] Pod Disruption Budget ì„¤ì •
  - [ ] Node Affinity/Anti-Affinity ì„¤ì •
  - [ ] HPA (Horizontal Pod Autoscaler) ì„¤ì •

#### âœ… **ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…**

- [ ] **ë¡œê·¸ ìˆ˜ì§‘**

  - [ ] êµ¬ì¡°í™”ëœ ë¡œê¹… (JSON í˜•ì‹)
  - [ ] ì¤‘ì•™ ì§‘ì¤‘ì‹ ë¡œê·¸ ìˆ˜ì§‘ (ELK, Fluent Bit)
  - [ ] ë¡œê·¸ ë³´ì¡´ ê¸°ê°„ ì„¤ì •
- [ ] **ë©”íŠ¸ë¦­**

  - [ ] Prometheus ë©”íŠ¸ë¦­ ë…¸ì¶œ
  - [ ] Grafana ëŒ€ì‹œë³´ë“œ ì¤€ë¹„
  - [ ] ì•Œë¦¼ ê·œì¹™ ì„¤ì • (Alertmanager)
- [ ] **ì¶”ì **

  - [ ] ë¶„ì‚° ì¶”ì  (Jaeger, Zipkin - ì„ íƒ)
  - [ ] ìš”ì²­ ID ì „íŒŒ

### 6.2 í™˜ê²½ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### **ê°œë°œ í™˜ê²½**

- [ ] ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì‚¬ìš©
- [ ] ë‚®ì€ ë¦¬ì†ŒìŠ¤ í• ë‹¹ (CPU 0.5, Memory 1Gi)
- [ ] ë””ë²„ê·¸ ëª¨ë“œ í™œì„±í™”
- [ ] Hot reload ì„¤ì •

#### **ìŠ¤í…Œì´ì§• í™˜ê²½**

- [ ] í”„ë¡œë•ì…˜ê³¼ ë™ì¼í•œ êµ¬ì„±
- [ ] ì‹¤ì œ ë°ì´í„° ë³µì‚¬ë³¸ ì‚¬ìš©
- [ ] ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰
- [ ] ë³´ì•ˆ ìŠ¤ìº” ì‹¤í–‰

#### **í”„ë¡œë•ì…˜ í™˜ê²½**

- [ ] ê³ ê°€ìš©ì„± ì„¤ì • (Multi-AZ, ë ˆí”Œë¦¬ì¹´ 3ê°œ ì´ìƒ)
- [ ] ìë™ ë°±ì—… í™œì„±í™”
- [ ] ì¬í•´ ë³µêµ¬ ê³„íš ìˆ˜ë¦½
- [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ 24/7
- [ ] On-call ëŒ€ì‘ ì²´ê³„ êµ¬ì¶•

---

## 7. ë¬¸ì œ í•´ê²°

### 7.1 Docker Compose ë¬¸ì œ

#### **ë¬¸ì œ 1: í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ì‹¤íŒ¨** ğŸ”´ **ê°€ì¥ í”í•œ ë¬¸ì œ**

**ì¦ìƒ**:
- í”„ë¡ íŠ¸ì—”ë“œ í™”ë©´ì€ ëœ¨ì§€ë§Œ API í˜¸ì¶œ ì‹¤íŒ¨
- ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬: `Failed to fetch`, `Network Error`, `CORS error`
- ë¡œê·¸ì¸ ì‹œë„ ì‹œ ë¬´ë°˜ì‘ ë˜ëŠ” ì—ëŸ¬

**ì›ì¸ ë° í•´ê²° ë°©ë²•**:

**[ì›ì¸ 1] frontend/.env íŒŒì¼ ëˆ„ë½**

```bash
# í™•ì¸
ls -la frontend/.env

# íŒŒì¼ì´ ì—†ë‹¤ë©´ ìƒì„±
cat > frontend/.env << 'EOF'
REACT_APP_API_URL=http://localhost:8000
REACT_APP_ENV=development
EOF

# í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ (í•„ìˆ˜!)
docker-compose build frontend
docker-compose up -d frontend
```

**[ì›ì¸ 2] ìƒˆ ì„œë²„ IPë¡œ ë°°í¬ ì‹œ localhost URL ì‚¬ìš©**

```bash
# ë¬¸ì œ: frontend/.envì— localhostë¡œ ì„¤ì •ë¨
REACT_APP_API_URL=http://localhost:8000  # âŒ ì™¸ë¶€ ì ‘ê·¼ ë¶ˆê°€

# í•´ê²°: ì‹¤ì œ ì„œë²„ IP ë˜ëŠ” ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½
REACT_APP_API_URL=http://192.168.1.100:8000  # âœ… ì„œë²„ IP
# ë˜ëŠ”
REACT_APP_API_URL=http://api.your-domain.com  # âœ… ë„ë©”ì¸

# ì¬ë¹Œë“œ í•„ìˆ˜!
docker-compose build frontend
docker-compose restart frontend
```

**[ì›ì¸ 3] CORS ì„¤ì • ë¶ˆì¼ì¹˜**

```bash
# ë¬¸ì œ: í”„ë¡ íŠ¸ì—”ë“œëŠ” https://domain.comì¸ë° CORSëŠ” http://localhostë§Œ í—ˆìš©
# ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬:
# Access to fetch at 'http://api.domain.com' from origin 'https://www.domain.com' 
# has been blocked by CORS policy

# í•´ê²°: ë£¨íŠ¸ .envì˜ CORS_ORIGINS ìˆ˜ì •
CORS_ORIGINS=["https://www.your-domain.com","http://www.your-domain.com"]

# ë°±ì—”ë“œ ì¬ì‹œì‘
docker-compose restart backend
```

**[ì›ì¸ 4] HTTP/HTTPS í˜¼ìš© (Mixed Content)**

```bash
# ë¬¸ì œ: í”„ë¡ íŠ¸ì—”ë“œëŠ” HTTPSì¸ë° ë°±ì—”ë“œ APIë¥¼ HTTPë¡œ í˜¸ì¶œ
# ë¸Œë¼ìš°ì €ê°€ HTTPS í˜ì´ì§€ì—ì„œ HTTP ë¦¬ì†ŒìŠ¤ ë¡œë“œë¥¼ ì°¨ë‹¨

# í•´ê²° 1: ë°±ì—”ë“œë„ HTTPS ì‚¬ìš©
REACT_APP_API_URL=https://api.your-domain.com  # âœ… HTTPS ì‚¬ìš©

# í•´ê²° 2: Nginxì—ì„œ SSL ì¢…ë£Œ (Termination) ì„¤ì •
# nginx/nginx.confì—ì„œ ë°±ì—”ë“œ upstreamì„ HTTPSë¡œ í”„ë¡ì‹œ
```

**ë‹¨ê³„ë³„ ì§„ë‹¨ ëª…ë ¹**:

```bash
# 1. í”„ë¡ íŠ¸ì—”ë“œ .env íŒŒì¼ í™•ì¸
cat frontend/.env
# REACT_APP_API_URLì´ ì˜¬ë°”ë¥¸ ì£¼ì†Œì¸ì§€ í™•ì¸

# 2. í”„ë¡ íŠ¸ì—”ë“œ ì»¨í…Œì´ë„ˆ í™˜ê²½ ë³€ìˆ˜ í™•ì¸ (ë¹Œë“œ ì‹œì )
docker-compose exec frontend printenv | grep REACT_APP

# 3. ë°±ì—”ë“œ í—¬ìŠ¤ ì²´í¬
curl http://localhost:8000/health
# ë˜ëŠ”
curl http://ì„œë²„IP:8000/health

# 4. ë°±ì—”ë“œ CORS ì„¤ì • í™•ì¸
docker-compose logs backend | grep CORS

# 5. ë„¤íŠ¸ì›Œí¬ ì—°ê²° í…ŒìŠ¤íŠ¸
docker-compose exec frontend ping backend
docker-compose exec frontend curl http://backend:8000/health

# 6. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ í™•ì¸
# F12 â†’ Network íƒ­ â†’ API ìš”ì²­ í™•ì¸
# F12 â†’ Console íƒ­ â†’ CORS ì—ëŸ¬ í™•ì¸
```

#### **ë¬¸ì œ 2: í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ ê²½ê³  ì—†ìŒ**

**ì¦ìƒ**:
- `docker-compose up -d`ëŠ” ì„±ê³µí•˜ì§€ë§Œ ëŸ°íƒ€ì„ì— ì—ëŸ¬ ë°œìƒ
- ë¡œê·¸ì— `KeyError`, `None type` ì—ëŸ¬ ë°œìƒ

**í•´ê²° ë°©ë²•**:

```bash
# ë°°í¬ ì „ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ìœ„ì—ì„œ ì‘ì„±í•œ ìŠ¤í¬ë¦½íŠ¸)
./shell-script/validate-env.sh

# ì˜ˆìƒ ì¶œë ¥:
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
#   ABEKM ë°°í¬ ì „ í™˜ê²½ ê²€ì¦
# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
# 
# [1/5] ë£¨íŠ¸ .env íŒŒì¼ í™•ì¸...
#   âœ… .env íŒŒì¼ ì¡´ì¬
# [2/5] í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ í™•ì¸...
#   âœ… í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜ ì™„ë£Œ (9ê°œ)
# ...
```

#### **ë¬¸ì œ 3: ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹¤íŒ¨**

**ì¦ìƒ**:
```bash
ERROR: for backend  Cannot start service backend: ...
```

**í•´ê²° ë°©ë²•**:
```bash
# ë¡œê·¸ í™•ì¸
docker-compose logs backend

# ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘

docker-compose restart backend

# ì™„ì „ ì¬ë¹Œë“œ

docker-compose down
docker-compose build --no-cache backend
docker-compose up -d
```

#### **ë¬¸ì œ 4: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨**

**ì¦ìƒ**:
```
sqlalchemy.exc.OperationalError: could not connect to server
```

**í•´ê²° ë°©ë²•**:
```bash
# PostgreSQL ìƒíƒœ í™•ì¸
docker-compose ps postgres
docker-compose logs postgres

# í—¬ìŠ¤ ì²´í¬

docker exec wkms-postgres pg_isready -U wkms

# ë„¤íŠ¸ì›Œí¬ í™•ì¸

docker network ls
docker network inspect wkms_wkms-network
```

#### **ë¬¸ì œ 5: SSL ì¸ì¦ì„œ ë¬¸ì œ**

**ì¦ìƒ**:
- `ERR_CERT_COMMON_NAME_INVALID`
- `NET::ERR_CERT_AUTHORITY_INVALID`

**í•´ê²° ë°©ë²•**:

```bash
# 1. ì¸ì¦ì„œ í™•ì¸
sudo certbot certificates

# 2. ì¸ì¦ì„œ ì¬ë°œê¸‰
sudo certbot --nginx -d your-domain.com --force-renewal

# 3. Nginx ì„¤ì • í™•ì¸
sudo nginx -t

# 4. Nginx ì¬ì‹œì‘
docker-compose restart nginx

# 5. ì¸ì¦ì„œ íŒŒì¼ ê¶Œí•œ í™•ì¸
sudo ls -la /etc/letsencrypt/live/your-domain.com/
```

#### **ë¬¸ì œ 6: í¬íŠ¸ ì¶©ëŒ**

**ì¦ìƒ**:
```
Error: Bind for 0.0.0.0:80 failed: port is already allocated
```

**í•´ê²° ë°©ë²•**:

```bash
# 1. í¬íŠ¸ ì‚¬ìš© í™•ì¸
sudo netstat -tulpn | grep :80
sudo lsof -i :80

# 2. ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ ì¤‘ì§€
sudo systemctl stop apache2  # Apache ì‚¬ìš© ì‹œ
sudo systemctl stop nginx     # ì‹œìŠ¤í…œ Nginx ì‚¬ìš© ì‹œ

# 3. ë˜ëŠ” docker-compose.ymlì—ì„œ í¬íŠ¸ ë³€ê²½
ports:
  - "8080:80"  # í˜¸ìŠ¤íŠ¸ 8080 í¬íŠ¸ë¡œ ë³€ê²½
```

### 7.2 Kubernetes ë¬¸ì œ

#### **ë¬¸ì œ: ImagePullBackOff**

**ì¦ìƒ**:
```bash
kubectl get pods -n wkms
NAME                            READY   STATUS             RESTARTS   AGE
wkms-backend-xxx                0/1     ImagePullBackOff   0          5m
```

**í•´ê²° ë°©ë²•**:
```bash
# ì´ë²¤íŠ¸ í™•ì¸
kubectl describe pod -n wkms wkms-backend-xxx

# ImagePullSecrets ì„¤ì •

kubectl create secret docker-registry regcred \
  --docker-server=<your-registry> \
  --docker-username=<your-username> \
  --docker-password=<your-password> \
  -n wkms

# Deploymentì— ì¶”ê°€

kubectl patch deployment wkms-backend -n wkms \
  -p '{"spec":{"template":{"spec":{"imagePullSecrets":[{"name":"regcred"}]}}}}'
```

#### **ë¬¸ì œ: CrashLoopBackOff**

**ì¦ìƒ**:
```bash
wkms-backend-xxx   0/1     CrashLoopBackOff   5          10m
```

**í•´ê²° ë°©ë²•**:
```bash
# ë¡œê·¸ í™•ì¸
kubectl logs -n wkms wkms-backend-xxx --previous

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸

kubectl exec -n wkms wkms-backend-xxx -- env

# ConfigMap/Secret í™•ì¸

kubectl get configmap -n wkms wkms-config -o yaml
kubectl get secret -n wkms wkms-secrets -o yaml
```

#### **ë¬¸ì œ: Pending Pod**

**ì¦ìƒ**:
```bash
wkms-postgres-0    0/1     Pending   0          5m
```

**í•´ê²° ë°©ë²•**:
```bash
# ì´ë²¤íŠ¸ í™•ì¸
kubectl describe pod -n wkms wkms-postgres-0

# PVC ìƒíƒœ í™•ì¸

kubectl get pvc -n wkms

# ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ í™•ì¸

kubectl get storageclass

# ë…¸ë“œ ë¦¬ì†ŒìŠ¤ í™•ì¸

kubectl describe nodes
```

### 7.3 EKS/AKS ë¬¸ì œ

#### **ë¬¸ì œ: ALB/Application Gateway ìƒì„± ì‹¤íŒ¨**

**EKS ALB í•´ê²° ë°©ë²•**:
```bash
# ALB Controller ë¡œê·¸ í™•ì¸
kubectl logs -n kube-system deployment/aws-load-balancer-controller

# Ingress ì´ë²¤íŠ¸ í™•ì¸

kubectl describe ingress -n wkms wkms-ingress-alb

# IAM ê¶Œí•œ í™•ì¸

aws iam get-role --role-name AmazonEKSLoadBalancerControllerRole
```

**AKS Application Gateway í•´ê²° ë°©ë²•**:
```bash
# AGIC ë¡œê·¸ í™•ì¸
kubectl logs -n kube-system deployment/ingress-appgw-deployment

# Ingress ì´ë²¤íŠ¸ í™•ì¸

kubectl describe ingress -n wkms wkms-ingress-appgw

# Managed Identity ê¶Œí•œ í™•ì¸

az role assignment list --assignee <MANAGED_IDENTITY_CLIENT_ID>
```

#### **ë¬¸ì œ: IAM/Managed Identity ê¶Œí•œ ë¶€ì¡±**

**EKS í•´ê²° ë°©ë²•**:
```bash
# IRSA ì„¤ì • í™•ì¸
kubectl get sa -n wkms wkms-backend-sa -o yaml

# Podê°€ ì‚¬ìš©í•˜ëŠ” ì„œë¹„ìŠ¤ ê³„ì • í™•ì¸

kubectl get pod -n wkms wkms-backend-xxx -o yaml | grep serviceAccountName

# IAM ì—­í•  ARN í™•ì¸

kubectl describe sa -n wkms wkms-backend-sa
```

**AKS í•´ê²° ë°©ë²•**:
```bash
# Pod Identity í™•ì¸
kubectl get azureidentity -n wkms

# Azure ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ í…ŒìŠ¤íŠ¸

kubectl exec -n wkms wkms-backend-xxx -- \
  az storage blob list --account-name <STORAGE_ACCOUNT>
```

---

## ğŸ“Š ë°°í¬ ìƒíƒœ ìš”ì•½

### Docker Compose ë°°í¬ ì¤€ë¹„ë„: **90%** âœ…

| í•­ëª©                   | ìƒíƒœ      | ë¹„ê³                          |
| -------------------- | ------- | -------------------------- |
| Dockerfile           | âœ… ì™„ë£Œ    | ëª¨ë“  ì„œë¹„ìŠ¤ ì¤€ë¹„ë¨                 |
| docker-compose.yml   | âœ… ì™„ë£Œ    | ê°œë°œ/í”„ë¡œë•ì…˜ ë¶„ë¦¬                 |
| í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬             | âœ… ì™„ë£Œ    | ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì œê³µ                 |
| **í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸**    | âœ… ì‹ ê·œ ì¶”ê°€ | validate-env.sh ì œê³µ         |
| **í”„ë¡ íŠ¸ì—”ë“œ .env ê°€ì´ë“œ**   | âœ… ì‹ ê·œ ì¶”ê°€ | IP/ë„ë©”ì¸/SSL ì‹œë‚˜ë¦¬ì˜¤ë³„ ì œê³µ        |
| **CORS ì„¤ì • ê°€ì´ë“œ**      | âœ… ì‹ ê·œ ì¶”ê°€ | ë‹¨ê³„ë³„ í•´ê²° ë°©ë²• ì œê³µ               |
| **SSL/HTTPS ê°€ì´ë“œ**    | âœ… ì‹ ê·œ ì¶”ê°€ | Let's Encrypt ìë™ ì„¤ì • ê°€ì´ë“œ    |
| **í”„ë¡ íŠ¸-ë°±ì—”ë“œ ì—°ê²° ë¬¸ì œ í•´ê²°** | âœ… ì‹ ê·œ ì¶”ê°€ | 6ê°€ì§€ ì£¼ìš” ì›ì¸ ë° í•´ê²°ì±… ì œê³µ         |
| í—¬ìŠ¤ ì²´í¬                | âœ… ì™„ë£Œ    | PostgreSQL, ë°±ì—”ë“œ            |
| ëª¨ë‹ˆí„°ë§                 | âŒ ë¯¸êµ¬í˜„   | Prometheus + Grafana ì¶”ê°€ í•„ìš” |

**ì‹ ê·œ ì¶”ê°€ëœ í•­ëª©** (ğŸ†•):
- âœ… ë°°í¬ ì „ ìë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ (`validate-env.sh`)
- âœ… frontend/.env í•„ìˆ˜ ì„¤ì • ê°€ì´ë“œ
- âœ… ìƒˆ ì„œë²„ IP ë§¤í•‘ ì‹œë‚˜ë¦¬ì˜¤
- âœ… ë„ë©”ì¸ ë„¤ì„ ì„¤ì • ê°€ì´ë“œ
- âœ… SSL/HTTPS ì ìš© ê°€ì´ë“œ (Let's Encrypt)
- âœ… CORS ì„¤ì • ìƒì„¸ ê°€ì´ë“œ
- âœ… í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ë¬¸ì œ ì§„ë‹¨ ë° í•´ê²°

### Kubernetes ë°°í¬ ì¤€ë¹„ë„: **90%** âœ…

| í•­ëª©               | ìƒíƒœ    | ë¹„ê³                        |
| ---------------- | ----- | ------------------------ |
| ë§¤ë‹ˆí˜ìŠ¤íŠ¸ íŒŒì¼         | âœ… ì™„ë£Œ  | 00-06 ëª¨ë‘ ì¤€ë¹„ë¨             |
| ConfigMap/Secret | âœ… ì™„ë£Œ  | í…œí”Œë¦¿ ì œê³µ                   |
| ìŠ¤í† ë¦¬ì§€             | âœ… ì™„ë£Œ  | PVC, StorageClass ì„¤ì •ë¨    |
| Ingress          | âœ… ì™„ë£Œ  | ê¸°ë³¸ + EKS + AKS           |
| í—¬ìŠ¤ ì²´í¬            | âœ… ì™„ë£Œ  | Liveness/Readiness Probe |
| ìë™ í™•ì¥            | âš ï¸ ë¶€ë¶„ | HPA ì¶”ê°€ í•„ìš”                |
| ëª¨ë‹ˆí„°ë§             | âš ï¸ ë¶€ë¶„ | Prometheus í†µí•© í•„ìš”         |

### EKS ë°°í¬ ì¤€ë¹„ë„: **80%** âœ…

| í•­ëª©          | ìƒíƒœ    | ë¹„ê³                         |
| ----------- | ----- | ------------------------- |
| ALB Ingress | âœ… ì™„ë£Œ  | 05-eks-specific.yaml      |
| gp3 ìŠ¤í† ë¦¬ì§€    | âœ… ì™„ë£Œ  | StorageClass ì •ì˜ë¨          |
| IAM ì—­í•       | âš ï¸ ìˆ˜ë™ | IRSA ì„¤ì • ê°€ì´ë“œ ì œê³µ            |
| CloudWatch  | âš ï¸ ë¶€ë¶„ | Container Insights í™œì„±í™” í•„ìš” |
| ë¹„ìš© ìµœì í™”      | âš ï¸ ê¶Œì¥ | Spot ì¸ìŠ¤í„´ìŠ¤, Autoscaler     |

### AKS ë°°í¬ ì¤€ë¹„ë„: **80%** âœ…

| í•­ëª©               | ìƒíƒœ    | ë¹„ê³                         |
| ---------------- | ----- | ------------------------- |
| App Gateway      | âœ… ì™„ë£Œ  | 06-aks-specific.yaml      |
| Managed Disk     | âœ… ì™„ë£Œ  | StorageClass ì •ì˜ë¨          |
| Managed Identity | âš ï¸ ìˆ˜ë™ | ì—­í•  í• ë‹¹ ê°€ì´ë“œ ì œê³µ              |
| Azure Monitor    | âš ï¸ ë¶€ë¶„ | Container Insights í™œì„±í™” í•„ìš” |
| ë¹„ìš© ìµœì í™”           | âš ï¸ ê¶Œì¥ | Spot VM, Autoscaler       |

---

## ğŸ¯ ê¶Œì¥ ê°œì„  ì‚¬í•­

### ìš°ì„ ìˆœìœ„ ë†’ìŒ (ğŸ”´)

1. **ë°°í¬ ì „ ê²€ì¦ ìë™í™”** ğŸ†•
   - `shell-script/validate-env.sh` ìŠ¤í¬ë¦½íŠ¸ë¥¼ CI/CDì— í†µí•©
   - pre-commit hookìœ¼ë¡œ .env íŒŒì¼ ê²€ì¦ ìë™í™”
   - GitHub Actions / GitLab CIì—ì„œ ë°°í¬ ì „ ê²€ì¦ ë‹¨ê³„ ì¶”ê°€
2. **í™˜ê²½ë³„ .env í…œí”Œë¦¿ ê´€ë¦¬** ğŸ†•
   - `.env.local.example` (ë¡œì»¬ ê°œë°œ)
   - `.env.staging.example` (ìŠ¤í…Œì´ì§• ì„œë²„)
   - `.env.production.example` (í”„ë¡œë•ì…˜ ì„œë²„)
   - ê° í™˜ê²½ë³„ REACT_APP_API_URL, CORS_ORIGINS ìƒ˜í”Œ ì œê³µ
3. **Secret ê´€ë¦¬ ê°•í™”**
   - Docker Compose: Docker Secrets ë˜ëŠ” ì™¸ë¶€ Vault ì‚¬ìš©
   - Kubernetes: External Secrets Operator ë„ì…
   - ë¹„ë°€ë²ˆí˜¸ ìë™ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì œê³µ
4. **ëª¨ë‹ˆí„°ë§ êµ¬ì¶•**
   - Prometheus + Grafana ìŠ¤íƒ ë°°í¬
   - ì£¼ìš” ë©”íŠ¸ë¦­ ëŒ€ì‹œë³´ë“œ ìƒì„±
   - ì•Œë¦¼ ê·œì¹™ ì„¤ì • (Slack, PagerDuty)
   - í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§
5. **ë°±ì—… ìë™í™”**
   - PostgreSQL ìë™ ë°±ì—… (ë§¤ì¼ ì‹¤í–‰)
   - S3/Azure Blobì— ë°±ì—… ì €ì¥
   - ë³µêµ¬ ì ˆì°¨ ë¬¸ì„œí™” ë° í…ŒìŠ¤íŠ¸

### ìš°ì„ ìˆœìœ„ ì¤‘ê°„ (ğŸŸ¡)

6. **SSL ì¸ì¦ì„œ ìë™ ê°±ì‹ ** ğŸ†•
   - Certbot ìë™ ê°±ì‹  cron ì‘ì—… ì„¤ì •
   - ì¸ì¦ì„œ ë§Œë£Œ ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•
   - ê°±ì‹  ì‹¤íŒ¨ ì‹œ ì•Œë¦¼ ë°œì†¡
7. **CORS ì„¤ì • ì¤‘ì•™ ê´€ë¦¬** ğŸ†•
   - í™˜ê²½ ë³€ìˆ˜ë¡œ ë™ì  CORS ì„¤ì •
   - ë„ë©”ì¸ ë³€ê²½ ì‹œ ìë™ ë°˜ì˜
   - ê°œë°œ/ìŠ¤í…Œì´ì§•/í”„ë¡œë•ì…˜ í™˜ê²½ë³„ ë¶„ë¦¬
8. **ë¡œê·¸ ìˆ˜ì§‘ í†µí•©**
   - ELK Stack ë˜ëŠ” Loki ë°°í¬
   - êµ¬ì¡°í™”ëœ ë¡œê¹… í‘œì¤€í™”
   - ë¡œê·¸ ë³´ì¡´ ì •ì±… ìˆ˜ë¦½
   - í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬ ë¡œê¹… (Sentry í†µí•©)
9. **ìë™ í™•ì¥ ì„¤ì •**
   - HPA (CPU 70%, Memory 80% ê¸°ì¤€)
   - Cluster Autoscaler (ë…¸ë“œ ìë™ í™•ì¥)
   - VPA (Vertical Pod Autoscaler - ì„ íƒ)
10. **CI/CD íŒŒì´í”„ë¼ì¸**
    - GitHub Actions / GitLab CI
    - ìë™ ì´ë¯¸ì§€ ë¹Œë“œ ë° í‘¸ì‹œ
    - í™˜ê²½ë³„ ìë™ ë°°í¬ (dev â†’ staging â†’ production)
    - ì¹´ë‚˜ë¦¬ ë°°í¬ / ë¸”ë£¨-ê·¸ë¦° ë°°í¬

### ìš°ì„ ìˆœìœ„ ë‚®ìŒ (ğŸŸ¢)

11. **í—¬ìŠ¤ ì²´í¬ ëŒ€ì‹œë³´ë“œ** ğŸ†•
    - ì›¹ ê¸°ë°˜ ë°°í¬ ìƒíƒœ í™•ì¸ í˜ì´ì§€
    - í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ ì—°ê²° ìƒíƒœ ì‹¤ì‹œê°„ í‘œì‹œ
    - í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ ì—¬ë¶€ ìë™ ì²´í¬
12. **ì„±ëŠ¥ ìµœì í™”**
    - Redis Cluster êµ¬ì„± (ê³ ê°€ìš©ì„±)
    - PostgreSQL Read Replica (ì½ê¸° ë¶€í•˜ ë¶„ì‚°)
    - CDN í†µí•© (ì •ì  ìì‚°)
    - Nginx ìºì‹± ìµœì í™”
13. **ë³´ì•ˆ ê°•í™”**
    - Network Policy ì ìš©
    - Pod Security Policy / Pod Security Standards
    - ì·¨ì•½ì  ìŠ¤ìº” ìë™í™” (Trivy, Clair)
    - ì •ê¸° ë³´ì•ˆ ê°ì‚¬

---

## ğŸ“‹ ë¹ ë¥¸ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ğŸš€ ìƒˆ ì„œë²„ì— Docker Composeë¡œ ë°°í¬í•˜ê¸° (10ë‹¨ê³„)

```bash
# 1ï¸âƒ£ ì €ì¥ì†Œ í´ë¡ 
git clone <repository-url>
cd InsightBridge

# 2ï¸âƒ£ í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x shell-script/validate-env.sh

# 3ï¸âƒ£ ë£¨íŠ¸ .env íŒŒì¼ ìƒì„±
cp .env.example .env
# í¸ì§‘ê¸°ë¡œ ì—´ì–´ í•„ìˆ˜ ê°’ ë³€ê²½:
# - POSTGRES_PASSWORD
# - JWT_SECRET_KEY
# - SECRET_KEY
# - CORS_ORIGINS (ì„œë²„ IP ë˜ëŠ” ë„ë©”ì¸)

# 4ï¸âƒ£ frontend/.env íŒŒì¼ ìƒì„±
cat > frontend/.env << EOF
REACT_APP_API_URL=http://$(hostname -I | awk '{print $1}'):8000
REACT_APP_ENV=production
EOF

# 5ï¸âƒ£ í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
./shell-script/validate-env.sh

# 6ï¸âƒ£ Docker ì´ë¯¸ì§€ ë¹Œë“œ
docker-compose build

# 7ï¸âƒ£ ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# 8ï¸âƒ£ í—¬ìŠ¤ ì²´í¬
sleep 10  # ì»¨í…Œì´ë„ˆ ì‹œì‘ ëŒ€ê¸°
docker-compose ps
curl http://localhost:8000/health

# 9ï¸âƒ£ ë¡œê·¸ í™•ì¸
docker-compose logs -f --tail=100

# ğŸ”Ÿ ë¸Œë¼ìš°ì € ì ‘ì† í…ŒìŠ¤íŠ¸
# http://ì„œë²„IP:80
```

### ğŸ”’ HTTPS ì ìš©í•˜ê¸° (ë„ë©”ì¸ ìˆëŠ” ê²½ìš°)

```bash
# 1ï¸âƒ£ DNS ì„¤ì • í™•ì¸
# A ë ˆì½”ë“œ: your-domain.com â†’ ì„œë²„ IP
# A ë ˆì½”ë“œ: api.your-domain.com â†’ ì„œë²„ IP

# 2ï¸âƒ£ Certbot ì„¤ì¹˜
sudo apt-get update
sudo apt-get install certbot python3-certbot-nginx

# 3ï¸âƒ£ SSL ì¸ì¦ì„œ ë°œê¸‰
sudo certbot --nginx -d your-domain.com -d api.your-domain.com

# 4ï¸âƒ£ frontend/.env ìˆ˜ì •
cat > frontend/.env << EOF
REACT_APP_API_URL=https://api.your-domain.com
REACT_APP_ENV=production
EOF

# 5ï¸âƒ£ ë£¨íŠ¸ .envì˜ CORS ìˆ˜ì •
# CORS_ORIGINS=["https://your-domain.com"]

# 6ï¸âƒ£ í”„ë¡ íŠ¸ì—”ë“œ ì¬ë¹Œë“œ ë° ì¬ë°°í¬
docker-compose build frontend
docker-compose restart backend nginx

# 7ï¸âƒ£ HTTPS ì ‘ì† í…ŒìŠ¤íŠ¸
curl https://api.your-domain.com/health
```

---

## ğŸ“ ë¬¸ì˜ ë° ì§€ì›

### ê¸°ìˆ  ì§€ì›

- **ë‹´ë‹¹íŒ€**: ITìš´ì˜íŒ€
- **ì—°ë½ì²˜**: 02-1234-5678
- **ì´ë©”ì¼**: devops@woongjin.co.kr

### ì°¸ê³  ë¬¸ì„œ

- **Kubernetes ë°°í¬ ê°€ì´ë“œ**: `/k8s/README.md`
- **EKS ë°°í¬ ê°€ì´ë“œ**: `/k8s/deployment-guides/eks-deployment.md`
- **AKS ë°°í¬ ê°€ì´ë“œ**: `/k8s/deployment-guides/aks-deployment.md`
- **ë¬¸ì œ í•´ê²° ê°€ì´ë“œ**: `/k8s/troubleshooting/common-issues.md`

---

## ğŸ“‹ ë³€ê²½ ì´ë ¥

| ë²„ì „  | ë‚ ì§œ         | ë³€ê²½ ë‚´ìš©                                                                                                                                                                                                                              | ì‘ì„±ì    |
| --- | ---------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| 2.0 | 2025-10-27 | ğŸ†• **ì£¼ìš” ì—…ë°ì´íŠ¸**<br/>- ë°°í¬ ì „ ìë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ (validate-env.sh)<br/>- frontend/.env í•„ìˆ˜ ì„¤ì • ê°€ì´ë“œ<br/>- ìƒˆ ì„œë²„ IP/ë„ë©”ì¸ ë§¤í•‘ ì‹œë‚˜ë¦¬ì˜¤<br/>- SSL/HTTPS ì ìš© ê°€ì´ë“œ (Let's Encrypt)<br/>- CORS ì„¤ì • ìƒì„¸ ê°€ì´ë“œ<br/>- í”„ë¡ íŠ¸-ë°±ì—”ë“œ ì—°ê²° ë¬¸ì œ í•´ê²° (6ê°€ì§€ ì›ì¸)<br/>- ë¹ ë¥¸ ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¶”ê°€ | ì‹œìŠ¤í…œê´€ë¦¬íŒ€ |
| 1.0 | 2025-10-27 | ì´ˆê¸° ë¬¸ì„œ ì‘ì„± - Docker Compose, K8s, EKS, AKS ë°°í¬ ê°€ì´ë“œ                                                                                                                                                                                    | ì‹œìŠ¤í…œê´€ë¦¬íŒ€ |

---

*ì´ ë¬¸ì„œëŠ” ABEKM ì‹œìŠ¤í…œì˜ ì»¨í…Œì´ë„ˆ ë°°í¬ë¥¼ ìœ„í•œ ê³µì‹ ê°€ì´ë“œì…ë‹ˆë‹¤. ë°°í¬ í™˜ê²½ ë³€ê²½ ì‹œ ë³¸ ë¬¸ì„œë„ í•¨ê»˜ ì—…ë°ì´íŠ¸í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.*
