# =============================================================================
# ğŸŒŸ CORE SETTINGS (ê³µí†µ ê¸°ë³¸ ì„¤ì •)
# =============================================================================

# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
DATABASE_URL=postgresql+asyncpg://wkms:wkms123@localhost:5432/wkms
POSTGRES_DB=wkms
POSTGRES_USER=wkms
POSTGRES_PASSWORD=wkms123

# Redis ì„¤ì •
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_URL=redis://localhost:6379/0

# ë³´ì•ˆ ì„¤ì •
SECRET_KEY=your-secret-key-change-in-production
ACCESS_TOKEN_EXPIRE_MINUTES=480
REFRESH_TOKEN_EXPIRE_MINUTES=10080

# CORS ì„¤ì •
CORS_ORIGINS=["http://localhost:3000","http://15.165.163.233:3000"]

# íŒŒì¼ ì—…ë¡œë“œ ì„¤ì •
UPLOAD_DIR=uploads
MAX_FILE_SIZE=104857600
ALLOWED_FILE_TYPES=[".pdf", ".docx", ".pptx", ".txt", ".md"]

# ë¡œê¹… ì„¤ì •
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# â˜ï¸ CLOUD PROVIDER SELECTION
# =============================================================================

# ìŠ¤í† ë¦¬ì§€ ë°±ì—”ë“œ ì„ íƒ: local | s3 | azure_blob
STORAGE_BACKEND=s3
USE_STANDARD_RAW_PREFIX=true

# LLM/ì„ë² ë”© ì œê³µì ì„ íƒ
DEFAULT_LLM_PROVIDER=bedrock
DEFAULT_EMBEDDING_PROVIDER=bedrock
LLM_PROVIDERS=["bedrock", "azure_openai", "openai"]

# =============================================================================
# ğŸ“„ DOCUMENT PROCESSING (ë¬¸ì„œ ì²˜ë¦¬)
# =============================================================================

# ë¬¸ì„œ ì²˜ë¦¬ ì œê³µì ì„ íƒ: azure_di | upstage | aws_textract | etc_other
# âš ï¸ ì£¼ì˜: Azure DIëŠ” í•œêµ­ì–´ ì™„ë²½ ì§€ì›, UpstageëŠ” í•œêµ­ì–´ ìš°ìˆ˜, AWS TextractëŠ” ì˜ë¬¸ ì¤‘ì‹¬
DOCUMENT_PROCESSING_PROVIDER=upstage
DOCUMENT_PROCESSING_FALLBACK=azure_di
USE_AZURE_DOCUMENT_INTELLIGENCE_PDF=false

# ---------------------
# Azure Document Intelligence (âœ… í•œêµ­ì–´ ì§€ì›)
# ---------------------
AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT=https://your-endpoint.cognitiveservices.azure.com/
AZURE_DOCUMENT_INTELLIGENCE_API_KEY=your-azure-document-intelligence-api-key
AZURE_DOCUMENT_INTELLIGENCE_API_VERSION=2024-11-30
AZURE_DOCUMENT_INTELLIGENCE_DEFAULT_MODEL=prebuilt-layout
AZURE_DOCUMENT_INTELLIGENCE_LAYOUT_MODEL=prebuilt-layout
AZURE_DOCUMENT_INTELLIGENCE_DOCUMENT_MODEL=prebuilt-layout
AZURE_DOCUMENT_INTELLIGENCE_MAX_PAGES=150
AZURE_DOCUMENT_INTELLIGENCE_TIMEOUT_SECONDS=300
AZURE_DOCUMENT_INTELLIGENCE_RETRY_MAX_ATTEMPTS=3
AZURE_DOCUMENT_INTELLIGENCE_CONFIDENCE_THRESHOLD=0.8
AZURE_DOCUMENT_INTELLIGENCE_USE_KOREAN_OPTIMIZATION=true

# DI ì„±ëŠ¥ ìµœì í™” ì„¤ì •
DI_PARALLEL_ENABLED=false
DI_PAGE_GROUP_SIZE=3
DI_MAX_CONCURRENCY=3
DI_CACHE_ENABLED=false
DI_TWO_COLUMN_REORDER_ENABLED=true

# ---------------------
# AWS Textract (âš ï¸ ì˜ë¬¸ ì¤‘ì‹¬ - í•œêµ­ì–´ ë¯¸ì§€ì›)
# ---------------------
# ê¸°ë³¸ ì„¤ì •
TEXTRACT_MODE=layout
TEXTRACT_FEATURE_TYPES=TABLES,FORMS,LAYOUT
TEXTRACT_MAX_CONCURRENCY=3
TEXTRACT_ENABLE_ASYNC=true

# ê³µí†µ íŒŒë¼ë¯¸í„°
TEXTRACT_MAX_PAGES=50
TEXTRACT_CONFIDENCE_THRESHOLD=80.0
TEXTRACT_USE_ASYNC_THRESHOLD_SIZE=5242880
TEXTRACT_USE_ASYNC_PAGE_COUNT=10
TEXTRACT_JOB_POLL_INTERVAL=4
TEXTRACT_JOB_TIMEOUT=600

# S3 ê²°ê³¼ ì €ì¥
TEXTRACT_S3_BUCKET=your-s3-bucket
TEXTRACT_RESULT_PREFIX=textract/results

# ì•ˆì •ì„± ì„¤ì •
TEXTRACT_RATE_LIMIT_PER_MIN=60
TEXTRACT_MAX_RETRIES=3
TEXTRACT_FALLBACK_ON_FAILURE=true

# ë³´ì•ˆ/ë¡œê¹…
TEXTRACT_LOG_RAW_RESPONSE=false
TEXTRACT_ENABLE_PII_MASKING=true

# ê³ ê¸‰ ê¸°ëŠ¥
TEXTRACT_ENABLE_QUERIES=false
TEXTRACT_QUERIES=ì´ê¸ˆì•¡,ì„œëª…ì,ë¬¸ì„œì œëª©

# ---------------------
# Upstage Document Parse (âœ… í•œêµ­ì–´ ìš°ìˆ˜ - Azure DI ëŒ€ì•ˆ)
# ---------------------
UPSTAGE_API_KEY=your-upstage-api-key
UPSTAGE_API_ENDPOINT=https://api.upstage.ai/v1/document-digitization
UPSTAGE_MAX_PAGES=150
UPSTAGE_TIMEOUT_SECONDS=300
UPSTAGE_RETRY_MAX_ATTEMPTS=3
UPSTAGE_MODEL=document-parse
# force | auto ë“± ì„ íƒ ê°€ëŠ¥ (ê³µë°± ì‹œ ê¸°ë³¸ê°’ auto)
UPSTAGE_OCR_MODE=auto
# JSON ë°°ì—´ ë¬¸ìì—´ë¡œ ì§€ì • (ì˜ˆ: ["figure","table"])
UPSTAGE_BASE64_CATEGORIES=["figure"]
UPSTAGE_MERGE_MULTIPAGE_TABLES=true
UPSTAGE_USE_ASYNC_API=false
UPSTAGE_ASYNC_POLL_INTERVAL_SECONDS=5
UPSTAGE_ASYNC_TIMEOUT_SECONDS=900
# í•„ìš” ì‹œ ê°œë³„ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì¬ì •ì˜í•  ìˆ˜ ìˆìŒ
# UPSTAGE_ASYNC_API_ENDPOINT=
# UPSTAGE_ASYNC_STATUS_ENDPOINT=

# =============================================================================
# ğŸ”· AZURE SERVICES
# =============================================================================

# ---------------------
# Azure Blob Storage
# ---------------------
AZURE_BLOB_ACCOUNT_NAME=your-storage-account
AZURE_BLOB_ACCOUNT_KEY=your-storage-account-key
AZURE_BLOB_CONTAINER_RAW=wkms-raw
AZURE_BLOB_CONTAINER_INTERMEDIATE=wkms-intermediate
AZURE_BLOB_CONTAINER_DERIVED=wkms-derived
AZURE_BLOB_SAS_EXPIRY_SECONDS=3600
AZURE_BLOB_ENABLE_AUTO_CONTAINER=true
AZURE_BLOB_DOWNLOAD_MODE=proxy

# ---------------------
# Azure OpenAI - Main LLM
# ---------------------
AZURE_OPENAI_ENDPOINT=https://your-endpoint.openai.azure.com/
AZURE_OPENAI_API_KEY=your-azure-openai-api-key
AZURE_OPENAI_API_VERSION=2024-12-01-preview

# ë°°í¬ ëª¨ë¸ ì´ë¦„ (âš ï¸ Azure Portalì—ì„œ ì‹¤ì œ ë°°í¬ ì´ë¦„ í™•ì¸ í•„ìš”)
AZURE_OPENAI_LLM_DEPLOYMENT=gpt-4o
AZURE_OPENAI_EMBEDDING_DEPLOYMENT=text-embedding-3-small
AZURE_OPENAI_MULTIMODAL_DEPLOYMENT=gpt-4o

# ---------------------
# Azure OpenAI - CLIP Embedding (ë³„ë„ ì—”ë“œí¬ì¸íŠ¸)
# ---------------------
AZURE_OPENAI_MULTIMODAL_EMBEDDING_ENDPOINT=https://your-ml-endpoint.inference.ml.azure.com/score
AZURE_OPENAI_MULTIMODAL_EMBEDDING_API_KEY=your-multimodal-embedding-api-key
AZURE_OPENAI_MULTIMODAL_EMBEDDING_DEPLOYMENT=openai-clip-image-text-embed

# ---------------------
# Azure OpenAI - Query Rewrite
# ---------------------
QUERY_REWRITE_PROVIDER=azure_openai
QUERY_REWRITE_AZURE_DEPLOYMENT=gpt-4o
QUERY_REWRITE_AZURE_ENDPOINT=https://your-endpoint.openai.azure.com/
QUERY_REWRITE_AZURE_API_KEY=your-azure-openai-api-key
QUERY_REWRITE_AZURE_API_VERSION=2024-12-01-preview
QUERY_REWRITE_MAX_TOKENS=500
QUERY_REWRITE_TEMPERATURE=0.3

# ---------------------
# Azure OpenAI - RAG Reranking
# ---------------------
RAG_RERANKING_PROVIDER=bedrock
RAG_RERANKING_ENDPOINT=https://your-endpoint.openai.azure.com/
RAG_RERANKING_API_KEY=your-azure-openai-api-key
RAG_RERANKING_DEPLOYMENT=gpt-4o
RAG_RERANKING_API_VERSION=2025-01-01-preview

# =============================================================================
# ğŸŸ§ AWS SERVICES
# =============================================================================

# ---------------------
# AWS Credentials
# ---------------------
AWS_REGION=ap-northeast-2
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key

# ---------------------
# AWS S3 Storage
# ---------------------
AWS_S3_BUCKET=your-s3-bucket
S3_PRESIGN_EXPIRY_SECONDS=3600

# ---------------------
# AWS Bedrock (LLM & Embedding)
# ---------------------
# Main LLM: Claude 3 Haiku (ì„œìš¸ ë¦¬ì „ ì§ì ‘ ì§€ì›)
# - Input: $0.25/MTok, Output: $1.25/MTok (ë¹„ìš© íš¨ìœ¨ì )
# - 200K ì»¨í…ìŠ¤íŠ¸, ë¹ ë¥¸ ì‘ë‹µ ì†ë„
# - í•œêµ­ì–´ ì§€ì› ìš°ìˆ˜, ap-northeast-2(ì„œìš¸) On-Demand ì§€ì› âœ…

# âœ… Latest Models in ap-northeast-2 (Confirmed 2025-12-05)
# 1. Claude Sonnet 4.5 (Direct Seoul)
# BEDROCK_LLM_MODEL_ID=anthropic.claude-sonnet-4-5-20250929-v1:0
# 2. Claude Opus 4.5 (Direct Seoul)
# BEDROCK_LLM_MODEL_ID=anthropic.claude-opus-4-5-20251101-v1:0
# 3. Claude 3.7 Sonnet (Direct Seoul)
# BEDROCK_LLM_MODEL_ID=anthropic.claude-3-7-sonnet-20250219-v1:0

# âœ… Cross-Region Inference Profiles
# 1. Global Claude Opus 4.5
# BEDROCK_LLM_MODEL_ID=global.anthropic.claude-opus-4-5-20251101-v1:0
# 2. APAC Claude Sonnet 4
# BEDROCK_LLM_MODEL_ID=apac.anthropic.claude-sonnet-4-20250514-v1:0

# âœ… Active Selection: Claude 3.5 Sonnet v2 (APAC Cross-region) - Verified Working 2025-12-05
BEDROCK_LLM_MODEL_ID=apac.anthropic.claude-3-5-sonnet-20241022-v2:0

# Previous Working: Claude 3 Haiku
# BEDROCK_LLM_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0

# Embedding: Amazon Titan Text Embeddings v2 (text-embedding-3-small ëŒ€ì‘) âœ… ì„ íƒë¨
# - $0.0001/1K tokens (Azure ëŒ€ë¹„ 90% ì €ë ´)
# - 1024ì°¨ì› (256/512/1024 ì„ íƒ ê°€ëŠ¥), 25ê°œ ì–¸ì–´ ì§€ì› (í•œêµ­ì–´ í¬í•¨)
# - 8192 í† í° ì…ë ¥ ì§€ì› (ê¸´ ë¬¸ì„œ ì²˜ë¦¬ ìœ ë¦¬)
# - ê²€ìƒ‰/ë¶„ë¥˜/í´ëŸ¬ìŠ¤í„°ë§ ìµœì í™”, RAG ì „ìš© ì„¤ê³„
# - ëŒ€ì•ˆ: cohere.embed-v4:0 (512 í† í° ì œí•œ, 100ê°œ ì–¸ì–´)
BEDROCK_EMBEDDING_MODEL_ID=amazon.titan-embed-text-v2:0
# BEDROCK_EMBEDDING_MODEL_ID=cohere.embed-v4:0
BEDROCK_EMBEDDING_DIMENSION=1024

# Multimodal Embedding: TwelveLabs Marengo Embed 3.0 (ì´ë¯¸ì§€+í…ìŠ¤íŠ¸ ì„ë² ë”©, Azure CLIP ëŒ€ì‘) âœ… ë³µì›
# - 512ì°¨ì› (ê³ íš¨ìœ¨ ì„ë² ë”©), ë¹„ë””ì˜¤/ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ ë©€í‹°ëª¨ë‹¬ ì§€ì›
# - Twelve Labs ë¹„ë””ì˜¤ AI ì „ë¬¸ ê¸°ìˆ  ê¸°ë°˜ ì„ë² ë”©
# - ì‹œë§¨í‹± ê²€ìƒ‰, ê°ì²´ ì¸ì‹, ì¥ë©´ ì´í•´ ìµœì í™”
# - í•œêµ­ì–´ í…ìŠ¤íŠ¸ ì§€ì›, ì‹œê°ì  ì½˜í…ì¸  ë¶„ì„ íŠ¹í™”
# - ap-northeast-2(ì„œìš¸) ë¦¬ì „ ì§€ì› âœ… (2025ë…„ 10ì›” 28ì¼ ì¶œì‹œ)
# - ì´ë¯¸ì§€ ìƒ‰ì¸ ë° ê²€ìƒ‰ì— ìµœì í™”ëœ ëª¨ë¸
BEDROCK_MULTIMODAL_EMBEDDING_MODEL_ID=twelvelabs.marengo-embed-3-0-v1:0
BEDROCK_MULTIMODAL_EMBEDDING_DIMENSION=512

# Multimodal LLM: Claude 3 Haiku (ì´ë¯¸ì§€ ë¶„ì„/ìº¡ì…˜ ìƒì„±) âœ… ë³€ê²½ë¨
# - Input: $0.25/MTok, Output: $1.25/MTok (ë¹„ìš© íš¨ìœ¨ì )
# - 200K ì»¨í…ìŠ¤íŠ¸, Vision ê¸°ëŠ¥ (PDF ì´ë¯¸ì§€, ì°¨íŠ¸, ë‹¤ì´ì–´ê·¸ë¨)
# - í•œêµ­ì–´ ì§€ì› ìš°ìˆ˜, ë¹ ë¥¸ ì‘ë‹µ ì†ë„
# - ap-northeast-2(ì„œìš¸) ë¦¬ì „ On-Demand ì§€ì› âœ…
# - ì´ì „: Claude 3 Sonnet (On-Demand ë¯¸ì§€ì›ìœ¼ë¡œ ì‹¤íŒ¨)
BEDROCK_MULTIMODAL_LLM_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0

# Query Rewrite: Claude 3 Haiku (ì¿¼ë¦¬ ì¬ì‘ì„±) âœ… ë³€ê²½ë¨
# - Input: $0.25/MTok, Output: $1.25/MTok (ë¹„ìš© íš¨ìœ¨ì )
# - 200K ì»¨í…ìŠ¤íŠ¸, ë¹ ë¥¸ ì¿¼ë¦¬ ì²˜ë¦¬
# - í•œêµ­ì–´ ìì—°ì–´ ì´í•´ ìš°ìˆ˜
# - ap-northeast-2(ì„œìš¸) ë¦¬ì „ On-Demand ì§€ì› âœ…
# - ì´ì „: Claude 3.5 Sonnet (ì±„ë„ í”„ë¡œê·¸ë¨ ê³„ì • ë¯¸ì§€ì›ìœ¼ë¡œ ì‹¤íŒ¨)
QUERY_REWRITE_BEDROCK_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0
QUERY_REWRITE_BEDROCK_REGION=ap-northeast-2
QUERY_REWRITE_BEDROCK_MAX_TOKENS=500
QUERY_REWRITE_BEDROCK_TEMPERATURE=0.3

# RAG Reranking: Claude 3 Haiku (ê²½ëŸ‰ ë¦¬ë­í‚¹)
# - Input: $0.25/MTok, Output: $1.25/MTok (ì €ë ´í•˜ê³  ë¹ ë¦„)
# - 200K ì»¨í…ìŠ¤íŠ¸, ë¬¸ë§¥ ê¸°ë°˜ ê´€ë ¨ì„± í‰ê°€
# - í•œêµ­ì–´ ë¬¸ì„œ ê²€ìƒ‰ ìµœì í™”
# - ap-northeast-2(ì„œìš¸) ë¦¬ì „ ì§€ì›
# - ëŒ€ì•ˆ: cohere.rerank-v3-5:0 (ë¦¬ë­í‚¹ ì „ë¬¸, $2/1K searches)
RAG_RERANKING_BEDROCK_MODEL_ID=anthropic.claude-3-haiku-20240307-v1:0
RAG_RERANKING_BEDROCK_REGION=ap-northeast-2
RAG_RERANKING_BEDROCK_MAX_TOKENS=500
RAG_RERANKING_BEDROCK_TEMPERATURE=0.2

# ëŒ€ì•ˆ ëª¨ë¸ (ì„±ëŠ¥ ìš°ì„  ì‹œ)
# BEDROCK_LLM_MODEL_ID=us.amazon.nova-pro-v1:0  # AWS Nova Pro (ìµœì‹ , GPT-4 Turboê¸‰)
# BEDROCK_EMBEDDING_MODEL_ID=cohere.embed-multilingual-v3  # Cohere v3 (ë‹¤êµ­ì–´ ê°•ì )

# ---------------------
# AWS OpenSearch
# ---------------------
OPENSEARCH_ENDPOINT=https://your-opensearch-domain.ap-northeast-2.es.amazonaws.com
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=your-opensearch-password
OPENSEARCH_INDEX=wkms-documents

# =============================================================================
# ğŸŒ OTHER PROVIDERS (ëŒ€ì•ˆ/ë°±ì—…)
# =============================================================================

# ---------------------
# OpenAI
# ---------------------
OPENAI_API_KEY=your-openai-api-key
OPENAI_LLM_MODEL=gpt-4o
OPENAI_EMBEDDING_MODEL=text-embedding-ada-002

# ---------------------
# Pinecone
# ---------------------
PINECONE_API_KEY=your-pinecone-api-key
PINECONE_ENVIRONMENT=your-pinecone-environment
PINECONE_INDEX_NAME=wkms-index

# ---------------------
# ì›¹ ê²€ìƒ‰ íˆ´
# ---------------------
# Tavily (ê¶Œì¥ - AI ì—ì´ì „íŠ¸ ìµœì í™”, ë¬´ë£Œ 1,000ê±´/ì›”)
TAVILY_API_KEY=your-tavily-api-key

# Bing Search (Azure - ì—”í„°í”„ë¼ì´ì¦ˆ ì•ˆì •ì„±)
BING_SEARCH_API_KEY=your-bing-search-api-key

# ì›¹ ê²€ìƒ‰ ì œê³µì ì„ íƒ (tavily | bing | duckduckgo)
WEB_SEARCH_PROVIDER=tavily

# ---------------------
# íŠ¹í—ˆ Agents ì„¤ì •
# ---------------------
# Patent Search
PATENT_SEARCH_ENABLED=true
KIPRIS_API_KEY=your-kipris-api-key
# SerpAPI (ì›¹ ê²€ìƒ‰ + íŠ¹í—ˆ ê²€ìƒ‰ ê³µìœ )
SERPAPI_API_KEY=your-serpapi-api-key
SERPAPI_GOOGLE_PATENTS_ENABLED=true

# =============================================================================
# âš™ï¸ APPLICATION SETTINGS
# =============================================================================

# ---------------------
# LLM ê³µí†µ íŒŒë¼ë¯¸í„°
# ---------------------
MAX_TOKENS=4096
TEMPERATURE=0.7
TOP_P=0.9

# ---------------------
# ë²¡í„° ê²€ìƒ‰ ì„¤ì •
# ---------------------
VECTOR_DIMENSION=1024
SIMILARITY_THRESHOLD=0.4

# ---------------------
# RAG ê²€ìƒ‰ ì„¤ì •
# ---------------------
RAG_SIMILARITY_THRESHOLD=0.3
RAG_MAX_CHUNKS=30
RAG_KEYWORD_BOOST=0.5
RAG_SEMANTIC_BOOST=0.5
RAG_USE_RERANKING=true

# ---------------------
# AI Agent ì•„í‚¤í…ì²˜
# ---------------------
USE_AGENT_ARCHITECTURE=true
AGENT_ENABLE_OBSERVABILITY=true
AGENT_ENABLE_EVALUATION=true

# ---------------------
# í•œêµ­ì–´ NLP ì„¤ì •
# ---------------------
KOREAN_NLP_PROVIDER=hybrid
KOREAN_TOKENIZER_MODEL=cl100k_base
KIWI_MODEL_TYPE=sbg
KIWI_TYPOS_CORRECTION=basic_with_continual_and_lengthening
USER_DICTIONARY_PATH=dictionaries/company_dict.txt
KOREAN_STOPWORDS_PATH=dictionaries/korean_stopwords.txt

# ---------------------
# ë¬¸ì„œ ì²˜ë¦¬ ì„¤ì •
# ---------------------
SUPPORTED_DOCUMENT_FORMATS=[".pdf", ".docx", ".pptx", ".xlsx", ".txt", ".md", ".hwp", ".doc", ".xls", ".ppt"]
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# ---------------------
# í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ì„¤ì •
# ---------------------
HYBRID_SEARCH_WEIGHTS={"semantic": 0.7, "keyword": 0.3}
KOREAN_EMBEDDING_MODEL=jhgan/ko-sroberta-multitask
